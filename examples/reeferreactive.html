<!DOCTYPE html>
<html>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../src/coral.css">
  <script src='../dist/reefer-min.js'></script>
  <body style='margin:8px 24px'>
    <div style='display:flex; flex-direction:column; align-items: center;'>
      Test - Hello World, Wizard, Typer, and Todos (nested also)
      <div id='hello' reef='hello' reef-p-greeting='Yo :) Yo'>
        <span style='color:red'> YEP </span>
        <div reef='todos' reef-slot='under'></div>
      </div>
      <div reef='wizard' reef-p-selected='neville'></div>
      <div reef='typer'></div>
      <div><h2>To Dos</h2>To Dos
        <div reef='todos'></div>  
      </div>
    </div>
   <script>
    // ================ hello world
    reefer.register('hello',  {
      data: {
        greeting: 'Hello',
        name: 'world'
      },
      template: function (slots) {
        var props = this.data
        slots = slots || {}
        return '<h2>' + props.greeting + (slots.default.text||'') + props.name + '!</h2>' + (slots.under.text||'');
      }
    })
    // ================  wizard
    reefer.register('wizard',  {
      data: {
        selected: 'harry'
      },
      template: function () {
        var props = this.data
        var sel = function (v) { return (props.selected==v) ? '"' + v + '" selected' : '"' + v + '"' } 
        return "\
          <label for=wizards>Who is the best wizard?</label>\
          <select>\
            <option value=" + sel('harry') + ">Harry</option>\
            <option value=" + sel('hermione') + ">Hermione</option>\
            <option value=" + sel('neville') + ">Neville</option>\
          </select> " + (props.selected=='hermione'?'agree!':'')
      },
      listeners: {
        'change':function  (e)  {
          var props = this.data
          var t = e.target
          props.selected = t.options[t.selectedIndex].value
        }
      }
    })

    // ================  typer
    reefer.register('typer', {
      data: {
        text: ''
      },
      template: function () {
        var props = this.data
        return '\
          <label for="mirror">Whatever you type shows up below the field</label>\
          <input type="text" id="mirror" value="' + props.text +'"> \
          <div><em aria-live="polite">' + (props.text.length ? props.text : 'Type something above to change this text') + "</em></div>";
        return html;
      },
      listeners: {
        input: function(e) {var props = this.data; props.text = e.target.value}
      }
    })

    // ================  todos
    reefer.register('todos', {
      data: {
        todos: ['Swim', 'Climb', 'Jump', 'Play']
      },
      template: function () {
        var props = this.data 
        return '<ul>' +
            props.todos.map(function (todo) {
              return '<li>' + todo + '</li>';
            }).join('') +
          '</ul>';
      },
    });

    function changeGreeting (t) {
      document.getElementById('hello').reef.data.greeting = t

    }
     
     

   </script>
  </body>
</html>