!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([,,,,function(t,e,n){n(5),n(6),t.exports=n(7)},function(t,e,n){!function(t){var e=t.coral.ui.DOM=t.coral.ui.DOM||{};function n(t){return t.getAttribute&&t.getAttribute("coral-blox")}function r(t){return t&&n(t)||(!t||E[t.nodeName]?"inline":t.nodeName)}function o(t,e){e.parentNode.insertBefore(t,e.nextSibling)}function i(t,e){if("inline"!==r(t)||t.nodeName!==e.nodeName)return!1;if(t.children&&(t.children.length>1||t.firstChild&&3!==t.firstChild.nodeType))return!1;if(e.children&&(e.children.length>1||e.firstChild&&3!==e.firstChild.nodeType))return!1;var n=t.attributes,o=e.attributes;if(n){if(n.length!==o.length)return!1;for(var i=0;i<n.length;i++)if(n[i].value!==e.getAttribute(n[i].name))return!1}return!0}function a(t,e){var n=t.childNodes;if(n){for(var r=!1,o=n.length-1;o>=0;o--){var i=n[o];i.firstChild&&(r=a(i,e)||r),r=!!f(i,e)||r}return r}}function s(t,e){if(!t)return null;if("string"==typeof t){var o=document.createElement("div");o.innerHTML=t,t=o}var i=i||{};3!==t.nodeType&&(i.type=[(t.getAttribute&&t.getAttribute("coral-blox")||t.nodeName).toLowerCase()]),t.coralBloxID&&(i.id=t.coralBloxID),i.type;var a=m[n(t)];if(a)return a.toBlock.call(_,t,{type:i.type});if(e=e||0,i.type&&"br"===i.type[0]&&0===e)return i.type=["p","br"],i;var c=t.childNodes;if(function(t,e){var n,r=t.attributes;if(!r)return e;for(var o=0;o<r.length;o++){var i=r[o].name;(b[i]||"style"===i)&&((n=n||{})[i]=r[o].value)}n&&(e[e.type]=n)}(t,i),!c||!c.length)return i.data=t.nodeValue||"",i;if(3===c[0].nodeType&&1===c.length)return i.data=c[0].nodeValue||"",i;for(var u=r(t),l=0;l<c.length;l++){var h=s(c[l],e+1);if(1===c.length&&h.data&&"inline"===r(c[l])&&"inline"===u){for(var d in h)if("type"===d)for(var p in h[d]){var f=h[d][p];i[d].indexOf(f)<0&&i[d].push(f)}else i[d]=h[d];return i}(i.items=i.items||[])[l]=h}return(i.items&&i.data||!i.data)&&delete i.data,i}function c(t,e){if("string"==typeof t){var n=document.createElement("div");n.innerHTML=t,t=n}var r=r||[],o=e?t.childNodes:t.children;if(!o)return r;for(var i=0;i<o.length;i++){var a=s(o[i]);r[i]=a}return r}var u={"&":"&amp;","<":"&lt;",">":"&gt;"};function l(t,e){var n="";if(e)for(var r in e){return t[o=e[r]]&&(n+=o+'="'+t[o].replace(/"/g,'\\"')+'"'),n}for(var o in t)n+=o+'="'+t[o].replace(/"/g,'\\"')+'"';return n}function h(t){return t.replace(/&|<|>/g,(function(t){return u[t]||""}))}function d(t,e,n){if("object"!=typeof t||null===t)return t||"";if(Array.isArray(t)){o="";for(var r=0;r<t.length;r++)o+=d(t[r],e,n);return o}n=n||0;var o="",i="#text"!==t.type&&t.type||0===n&&"p",a="";if(i){for(r=0;r<i.length-1;r++)o+="<"+i[r],t[i[r]]&&(o+=" "+l(t[i[r]])),o+=">",a="</"+i[r]+">"+a;i=i[r];var s=m[i];if(s)return o+s.toHTML.call(_,t,e)+a;if(o+="<"+i,t[i]&&(o+=" "+l(t[i])),0===n&&(o+=2===e?" coral-editor":" contenteditable=true coral-on-keydown=methods.keydown"),o+=">",T[i])return o}if(t.data)o+=h(t.data);else if(t.items)for(r=0;r<t.items.length;r++)o+=d(t.items[r],e,n+1);return i&&(o+="</"+i+">"+a),o}function p(t,e,n){if(t.nodeName===e.toUpperCase())return t;var r=document.createElement(e);return r.innerHTML=n||t.innerHTML||t.nodeValue,t.parentNode.replaceChild(r,t),r}function f(t,e){var r=t.nodeName,o=t.hasAttribute&&t.hasAttribute("style")?t.style:null,i=o&&("none"===o.display||"hidden"===o.visibility||parseFloat(o.opacity)<=.01),a=t.textContent,s=!E[r]&&!O[r]&&!a,c=t.firstChild&&(t.firstChild.innerHTML&&t.firstChild.innerHTML.trim()||O[t.firstChild.nodeName]);s=s||!E[r]&&"P"!==r&&!t.textContent.trim()||3===t.nodeType&&!t.textContent.trim()&&!t.parentNode.nextSibling&&!t.parentNode.previouSibling;var u=g[r]||(!c||"&nbsp;"===c)&&s&&!O[r]&&!T[r.toLowerCase()]&&!t.nodeValue&&(!e||"P"!==r);if(u=u||t.classList&&t.classList.contains("Apple-interchange-newline"),!i&&!u){var l,h=P[t.parentNode.nodeName]||{},d=(m[n(t.parentNode)]||{}).contains||{};return"B"===r||"A"!==r&&E[r]&&o&&parseInt(o.fontWeight)>500?l=p(t,"strong"):"I"===r||"A"!==r&&E[r]&&o&&"italic"==o.fontStyle?l=p(t,"em"):3===t.nodeType||w[r]||m[n(t)]||h[r]||d[r]||(l=p(t,"p")),e||function(t){if(t.hasAttribute){var e=coral.dot.keysFromArray(t.style,["width","height","textAlign","color"]);e.width.value&&t.setAttribute("width",toPX(e.width.value)),e.height.value&&t.setAttribute("height",toPX(e.height.value));for(var n=t.attributes,r=n.length-1;r>=0;r--){var o=n[r].name;b[o]||(o.indexOf("coral-editor-")>=0||t.removeAttribute(o))}"A"!==t.nodeName&&e.color.value&&"#"===e.color.value[0]&&"#000000"!==e.color.value&&(t.style.color=e.color.value),e.textAlign.value&&"start"!==e.textAlign.value&&(t.style.textAlign=e.textAlign.value)}}(l||t),l}t.parentNode.removeChild(t)}function v(t,e,n){if(e)for(var r=0;r<n.length;r++){var o=n[r],i=e.getAttribute(o);i&&"null"!==i&&(t[o]=i)}}var _={readAttr:v,attrString:l,toBlocks:c,toBlock:s,toHTML:d,esc:function(t){return t.replace(/"/g,'\\"')}},m={"cui-ed-oembed":{contains:{IFRAME:!0,inline:!0,INPUT:!0,P:!0,DIV:!0},toHTML:function(t,e){return'<div coral-editor coral-blox=cui-ed-oembed><iframe width="480" height="270" src="https://www.youtube.com/embed/M3r2XDceM6A?feature=oembed" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>'}},"cui-ed-image":{contains:{IMG:!0,CAPTION:!0,inline:!0,INPUT:!0,P:!0,DIV:!0},attr:{src:!0,width:!0,height:!0,caption:!0},toHTML:function(t,e){return"<div coral-blox=cui-ed-image><img "+this.attrString(t,["src","width","height"])+'><p coral-editor-src class="cui-editor-focus" contenteditable=true>'+this.esc(t.src||"")+"</p><p coral-editor-controls contenteditable=true>"+this.toHTML(t.caption,2)+"</p></div>"},toBlock:function(t,e){var n=t.querySelector("img"),r=t.querySelector("[coral-editor-controls]"),o=t.querySelector("[coral-editor-src]");if(v(e,n,["src","width","height"]),o&&o.textContent&&(n.src=o.textContent),r){var i=r;coral.ui.DOM.clean(i,!0),e.caption=this.toBlocks(i,!0)}return e}}},y={pre:!0,code:!0},g={"#comment":!0,META:!0,LINK:!0,STYLE:!0},E={STRONG:!0,B:!0,I:!0,EM:!0,S:!0,BR:!0,A:!0,SPAN:!0,IMG:!1,CODE:!0,"#text":!0},b={href:!0,"coral-editor":!0,src:!0,href:!0,url:!0,width:!0,height:!0,"coral-blox":!0,align:!0,colspan:!0},w={BLOCK:!0,HEADER:!0,FOOTER:!0,BR:!0,P:!0,PRE:!0,ARTICLE:!0,VIDEO:!0,IMG:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,"#text":!0};coral.assign(w,{SPAN:!0,A:!0,STRONG:!0,I:!0,S:!0,LI:!0,UL:!0,OL:!0,TABLE:!0,TH:!0,TBODY:!0}),coral.assign(w,{THEAD:!0,TR:!0,TD:!0,CODE:!0,MARK:!0,STRONG:!0,EM:!0,BLOCKQUOTE:!0,HR:!0,CAPTION:!0}),coral.assign(w,{FIGURE:!0,SECTION:!0,FIGCAPTION:!0,OEMBED:!0,DETAILS:!0});var T={img:!0,input:!0,br:!0,hr:!0,embed:!0,link:!0,source:!0},O={BR:!0,IMG:!0,VIDEO:!0,OEMBED:!0,IFRAME:!0},N={TD:!0},P={OL_:{LI:!0},UL_:{LI:!0},THEAD:{TR:!0,TD:!0,TH:!0},TABLE:{THEAD:!0,TR:!0,TBODY:!0},TBODY:{TR:!0,TD:!0,TH:!0},TD:{LI:!0,P:!0,OL:!0,UL:!0},TH:{TD:!0},TR:{TH:!0,TD:!0},FIGURE:{FIGCAPTION:!0},BLOCKQUOTE:{P:!0}};e.clean=function(t,e,s){var c=(!s||"clean"==s)&&a(t,e);return s&&"flatten"!=s||function t(e,a,s){if(s&&e.hasAttribute&&e.hasAttribute("coral-editor"))for(var c=e.childNodes,u=0;u<c.length;u++)t(c[u],e,s);else{var l=l||a&&r(a),h=(c=e.childNodes,m[n(e)]||{}),d=P[e.nodeName]||h.contains||{},p=r(e);if(c)for(u=0;u<c.length;u++){var f=v,v=c[u],_=r(v);if(!y[_])if(l||(l=_),v.firstChild&&t(v,N[v.nodeName]?e:a||e,s),f&&i(f,v))f.textContent+=v.textContent,u--,e.removeChild(v),v=f;else{var g=("inline"!==_||"inline"===l)&&_!==l&&!d[_];if((g=g||"inline"===_&&a&&e!==a&&u&&"inline"===p&&!d[_])&&v.parentNode!==a&&a){var E,b=e;do{"inline"===_&&(v.nodeValue||v.firstChild)?(E||(o(E=e.cloneNode(!1),b),b=E),E.appendChild(v)):(o(v,b),E=null,b=v),_=r(v=c[u])}while(v);return}}}}}(t,null,e),(!s||"clean"==s)&&a(t,e)||c},e.toBlock=s,e.toBlocks=c,e.toHTML=d,e.combineBlocks=function(t,e){var n=m[t.type];return n?n.combineBlocks&&n.combineBlocks(t,e):(t.data?(t.items=[t.data],delete t.data):t.items||(t.items=[]),e.data?t.items.push(e.data):t.items=t.items.concat(e.items),!0)},e.escapeHTML=h}(this),function(t){var e=t.coral.ui.select={};function n(t){var e=t&&t.getClientRects();if(e&&e.length>0)return rect=e[0],rect.height=20,rect.width=0,rect}function r(t){var e,r=window.getSelection();if(!(t=t||r.anchorNode&&r.getRangeAt(0)))return n(document.activeElement);if(r.anchorNode&&3!==r.anchorNode.nodeType)return r.anchorNode.getBoundingClientRect();if(t.getClientRects){var o=(t=t.cloneRange()).getClientRects();o.length>0&&(e=o[0])}if(0===t.startOffset&&t.collapsed&&t.startContainer&&t.startContainer.getClientRects&&(e=n()),!e){var i=document.createElement("span");if(i.getClientRects){i.appendChild(document.createTextNode("â€‹")),t.insertNode(i),e=i.getClientRects()[0];var a=i.parentNode;a.removeChild(i),a.normalize()}}return e||n(document.activeElement)}function o(t,e){return t===e||t.nodeName===e}function i(t,e){var n=t;if(o(n,e))return n;if(!n.firstChild)do{if(n.nextSibling){n=n.nextSibling;break}n=n.parentNode}while(n&&!o(n,e));if(n)for(;n.firstChild&&!o(n,e);)n=n.firstChild;return n&&e&&!o(n,e)?i(n,e):n}function a(t,e){console.log("select ---------- SETCURPOS",t,e),null===t&&(t={});var n=window.getSelection(),r={start:t||0,end:t||0,count:0};if("object"==typeof t&&(r.startNode=t.startNode,r.start=t.start||0,r.end=t.end||0,r.count=t.count||0),r.start<0&&(r.start=1073741824),r.end<0&&(r.end=1073741824),"start"in r){var o=function t(e,n,r,o){if(!r)var a=(r=document.createRange()).startContainer;var s;if(0===n.start&&(r.selectNode(e),r.setStart(e,n.start),n.start=-1),0===n.end&&(r.setEnd(e,n.end),n.end=-1),e&&(n.start>0||n.end>0))if(e.nodeType===Node.TEXT_NODE)n.setcount=(n.setcount||0)+e.textContent.length,n.lastNode=e,e.textContent.length<n.start?n.start-=e.textContent.length:n.start>=0&&(n.startNode&&n.startNode!==e?s=i(e,n.startNode):n.setcount<n.count&&(s=i(e)),s&&(n.start-=e.textContent.length,n.end-=e.textContent.length,n.start<0&&(n.start=0),n.end<0&&(n.end=0)),r.selectNode(s||e),r.setStart(s||e,n.start),n.start=-1),e.textContent.length<n.end?n.end-=e.textContent.length:n.end>=0&&(n.end=Math.min(n.end,(s||e).textContent.length),r.setEnd(s||e,n.end),n.end=-1);else for(var c=0;c<e.childNodes.length&&(r=t(e.childNodes[c],n,r),!(n.start<=0&&n.end<=0));c++);return a!==r.startContainer||o?r:t(e,{start:0,end:0},null,!0)}(e=e||t.el,r);if(o&&(r.lastNode&&(r.start>0&&(o.selectNode(r.lastNode),o.setStart(r.lastNode,r.lastNode.textContent.length)),r.end>0&&o.setEnd(r.lastNode,r.lastNode.textContent.length)),n.removeAllRanges(),n.addRange(o)),t&&t.els&&t.els.length&&e===t.el&&setTimeout((function(){for(var n=t.els,r={},o=0;o<n.length;o++)r[n[o]]=!0;n=t.el.children;for(o=0;o<n.length;o++)n[o].classList.toggle("selected",r[o]||!1);e.coral&&(e.coral.preserveSelection=!0)}),0),e&&e!==document.activeElement&&e.focus)console.log("-------- FOCUS ----------",e),e.focus();return r}}function s(t,e){var n={count:0};return function t(e,n,r){if(r&&e&&(e===r&&(n.match=!0),!n.match))if(e.nodeType===Node.TEXT_NODE)n.count+=e.textContent.length;else for(var o=0;o<e.childNodes.length&&(t(e.childNodes[o],n,r),!n.match);o++);}(t,n,e),n}function c(t){return[].indexOf.call(t.parentNode.childNodes,t)}function u(t,e){for(;e&&e.parentNode!==t;)e=e.parentNode;return{el:e,idx:e?c(e):-1}}e.get=function(t){var e=window.getSelection(),n={count:0},r=document.activeElement;if(r&&e&&e&&e.anchorNode){if(!r.contains(e.anchorNode)){var o=s(t,r);if(o.match)return o.start=o.end=o.count,o.el=o.el,o.startNode=r,o}range=function t(e,n,r){if(!r)return null;if(e===r.anchorNode&&(n.start=n.count+r.anchorOffset,n.startNode=e),e===r.extentNode&&(n.end=n.count+r.extentOffset,n.endNode=e),e&&(!n.startNode||!n.endNode))if(e.nodeType===Node.TEXT_NODE)n.count+=e.textContent.length;else for(var o=0;o<e.childNodes.length&&(r=t(e.childNodes[o],n,r),!n.startNode||!n.endNode);o++);return r}(t||e.anchorNode,n,e),!("end"in n)&&"start"in n&&(n.end=n.start),n.el=t||e.anchorNode}var i=n.el||t;if(i&&i.querySelectorAll){var a=i.querySelectorAll(".selected");if(a.length){for(var c=n.els=[],l=0;l<a.length;l++)c[l]=u(i,a[l]).idx;n.el=i}}return n},e.set=a,e.test=function(t,e,n){var o=t.getBoundingClientRect(t),i=r();switch(e){case"ArrowUp":return i.top<=o.top+n?-1:0;case"ArrowDown":return i.top+i.height>=o.top+o.height-n?1:0}},e.coords=r,e.match=s,e.breaks=function(t,e){for(var n,o=t.innerText,i=[],s=saveSelection(),c=0;c<o.length;c++){a(c,t);var u=r();(e||n!==u.top)&&(n=u.top,i.push(c))}return restoreSelection(s),i}}(this)},function(t,e,n){var r,o;var i;i={ch:8,ex:7.15625,em:16,rem:16,in:96,cm:96/2.54,mm:96/25.4,pt:96/72,pc:16,px:1};(function(){var i=function(){};function a(t,e){var n,r;for(n in e)void 0!==(r=e[n])&&(t[n]=r);return t}var s={version:"0.1.15",Stack:function(){this.commands=[],this.stackPosition=-1,this.savePosition=-1}};a(s.Stack.prototype,{execute:function(t){this._clearRedo(),t.execute(),this.commands.push(t),this.stackPosition++,this.changed()},undo:function(){this.canUndo()?(this.commands[this.stackPosition].undo(),this.stackPosition--,this.changed()):console.error("Can't undo")},canUndo:function(){return this.stackPosition>=0},redo:function(){this.canRedo()?(this.stackPosition++,this.commands[this.stackPosition].redo(),this.changed()):console.error("Can't redo")},canRedo:function(){return this.stackPosition<this.commands.length-1},save:function(){this.savePosition=this.stackPosition,this.changed()},dirty:function(){return this.stackPosition!=this.savePosition},_clearRedo:function(){this.commands=this.commands.slice(0,this.stackPosition+1)},changed:function(){}}),s.Command=function(t){this.name=t};var c=new Error("override me!");a(s.Command.prototype,{execute:function(){throw c},undo:function(){throw c},redo:function(){this.execute()}}),s.Command.extend=function(t){var e=function(t,e){var n;return n=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return t.apply(this,arguments)},i.prototype=t.prototype,n.prototype=new i,e&&a(n.prototype,e),n.prototype.constructor=n,n.__super__=t.prototype,n}(this,t);return e.extend=s.Command.extend,e},void 0===(o="function"==typeof(r=s)?r.call(e,n,e,t):r)||(t.exports=o)}).call(this);var a=Undo.Command.extend({constructor:function(t,e,n){this.textarea=t,this.oldValue=e,this.newValue=n},execute:function(){},undo:function(){this.apply(this.oldValue)},redo:function(){this.apply(this.newValue)}});a.prototype.apply=function(t){a.blocked||(a.blocked=!0);var e=this.textarea;console.log("Undo ------ APPLYING");var n=e.coral.state.blocks;jsonpatch.applyPatch(n,jsonpatch.deepClone(t)),t.state(jsonpatch.deepClone(n)),n.splice(0,0),e.coral.render_(),coral.ui.select.set(t.selection,e)};var s,c=function(t){t=t||{},this._container=t.container||document.body,this._strokeStyle=t.strokeStyle||"cyan",this._stickEl=t.stickElement||this._buildJoystickStick(),this._baseEl=t.baseElement||this._buildJoystickBase(),this._mouseSupport=void 0!==t.mouseSupport&&t.mouseSupport,this._stationaryBase=t.stationaryBase||!1,this._baseX=this._stickX=t.baseX||0,this._baseY=this._stickY=t.baseY||0,this._limitStickTravel=t.limitStickTravel||!1,this._stickRadius=void 0!==t.stickRadius?t.stickRadius:100,this._useCssTransform=void 0!==t.useCssTransform&&t.useCssTransform,this._container.style.position="relative",this._container.appendChild(this._baseEl),this._baseEl.style.position="absolute",this._baseEl.style.display="none",this._container.appendChild(this._stickEl),this._stickEl.style.position="absolute",this._stickEl.style.display="none",this._pressed=!1,this._touchIdx=null,!0===this._stationaryBase&&(this._baseEl.style.display="",this._baseEl.style.left=this._baseX-this._baseEl.width/2+"px",this._baseEl.style.top=this._baseY-this._baseEl.height/2+"px"),this._transform=!!this._useCssTransform&&this._getTransformProperty(),this._has3d=this._check3D();var e=function(t,e){return function(){return t.apply(e,arguments)}};this._$onTouchStart=e(this._onTouchStart,this),this._$onTouchEnd=e(this._onTouchEnd,this),this._$onTouchMove=e(this._onTouchMove,this),this._container.addEventListener("touchstart",this._$onTouchStart,!1),this._container.addEventListener("touchend",this._$onTouchEnd,!1),this._container.addEventListener("touchmove",this._$onTouchMove,!1),this._mouseSupport&&(this._$onMouseDown=e(this._onMouseDown,this),this._$onMouseUp=e(this._onMouseUp,this),this._$onMouseMove=e(this._onMouseMove,this),this._container.addEventListener("mousedown",this._$onMouseDown,!1),this._container.addEventListener("mouseup",this._$onMouseUp,!1),this._container.addEventListener("mousemove",this._$onMouseMove,!1))};c.prototype.destroy=function(){this._container.removeChild(this._baseEl),this._container.removeChild(this._stickEl),this._container.removeEventListener("touchstart",this._$onTouchStart,!1),this._container.removeEventListener("touchend",this._$onTouchEnd,!1),this._container.removeEventListener("touchmove",this._$onTouchMove,!1),this._mouseSupport&&(this._container.removeEventListener("mouseup",this._$onMouseUp,!1),this._container.removeEventListener("mousedown",this._$onMouseDown,!1),this._container.removeEventListener("mousemove",this._$onMouseMove,!1))},c.touchScreenAvailable=function(){return"createTouch"in document},(s=c.prototype).addEventListener=function(t,e){return void 0===this._events&&(this._events={}),this._events[t]=this._events[t]||[],this._events[t].push(e),e},s.removeEventListener=function(t,e){void 0===this._events&&(this._events={}),t in this._events!=0&&this._events[t].splice(this._events[t].indexOf(e),1)},s.dispatchEvent=function(t){if(void 0===this._events&&(this._events={}),void 0!==this._events[t])for(var e=this._events[t].slice(),n=0;n<e.length;n++){var r=e[n].apply(this,Array.prototype.slice.call(arguments,1));if(void 0!==r)return r}},c.prototype.deltaX=function(){return this._stickX-this._baseX},c.prototype.deltaY=function(){return this._stickY-this._baseY},c.prototype.up=function(){if(!1===this._pressed)return!1;var t=this.deltaX(),e=this.deltaY();return!(e>=0)&&!(Math.abs(t)>2*Math.abs(e))},c.prototype.down=function(){if(!1===this._pressed)return!1;var t=this.deltaX(),e=this.deltaY();return!(e<=0)&&!(Math.abs(t)>2*Math.abs(e))},c.prototype.right=function(){if(!1===this._pressed)return!1;var t=this.deltaX(),e=this.deltaY();return!(t<=0)&&!(Math.abs(e)>2*Math.abs(t))},c.prototype.left=function(){if(!1===this._pressed)return!1;var t=this.deltaX(),e=this.deltaY();return!(t>=0)&&!(Math.abs(e)>2*Math.abs(t))},c.prototype._onUp=function(){this._pressed=!1,this._stickEl.style.display="none",0==this._stationaryBase&&(this._baseEl.style.display="none",this._baseX=this._baseY=0,this._stickX=this._stickY=0)},c.prototype._onDown=function(t,e){if(this._pressed=!0,0==this._stationaryBase&&(this._baseX=t,this._baseY=e,this._baseEl.style.display="",this._move(this._baseEl.style,this._baseX-this._baseEl.width/2,this._baseY-this._baseEl.height/2)),this._stickX=t,this._stickY=e,!0===this._limitStickTravel){var n=this.deltaX(),r=this.deltaY(),o=Math.sqrt(n*n+r*r);if(o>this._stickRadius){var i=n/o,a=r/o;this._stickX=i*this._stickRadius+this._baseX,this._stickY=a*this._stickRadius+this._baseY}}this._stickEl.style.display="",this._move(this._stickEl.style,this._stickX-this._stickEl.width/2,this._stickY-this._stickEl.height/2)},c.prototype._onMove=function(t,e){if(!0===this._pressed){if(this._stickX=t,this._stickY=e,!0===this._limitStickTravel){var n=this.deltaX(),r=this.deltaY(),o=Math.sqrt(n*n+r*r);if(o>this._stickRadius){var i=n/o,a=r/o;this._stickX=i*this._stickRadius+this._baseX,this._stickY=a*this._stickRadius+this._baseY}}this._move(this._stickEl.style,this._stickX-this._stickEl.width/2,this._stickY-this._stickEl.height/2)}},c.prototype._onMouseUp=function(t){return this._onUp()},c.prototype._onMouseDown=function(t){t.preventDefault();var e=t.clientX,n=t.clientY;return this._onDown(e,n)},c.prototype._onMouseMove=function(t){var e=t.clientX,n=t.clientY;return this._onMove(e,n)},c.prototype._onTouchStart=function(t){if(null===this._touchIdx&&!1!==this.dispatchEvent("touchStartValidation",t)){this.dispatchEvent("touchStart",t),t.preventDefault();var e=t.changedTouches[0];this._touchIdx=e.identifier;var n=e.pageX,r=e.pageY;return this._onDown(n,r)}},c.prototype._onTouchEnd=function(t){if(null!==this._touchIdx){this.dispatchEvent("touchEnd",t);for(var e=t.changedTouches,n=0;n<e.length&&e[n].identifier!==this._touchIdx;n++);if(n!==e.length)return this._touchIdx=null,t.preventDefault(),this._onUp()}},c.prototype._onTouchMove=function(t){if(null!==this._touchIdx){for(var e=t.changedTouches,n=0;n<e.length&&e[n].identifier!==this._touchIdx;n++);if(n!==e.length){var r=e[n];t.preventDefault();var o=r.pageX,i=r.pageY;return this._onMove(o,i)}}},c.prototype._buildJoystickBase=function(){var t=document.createElement("canvas");t.width=126,t.height=126;var e=t.getContext("2d");return e.beginPath(),e.strokeStyle=this._strokeStyle,e.lineWidth=6,e.arc(t.width/2,t.width/2,40,0,2*Math.PI,!0),e.stroke(),e.beginPath(),e.strokeStyle=this._strokeStyle,e.lineWidth=2,e.arc(t.width/2,t.width/2,60,0,2*Math.PI,!0),e.stroke(),t},c.prototype._buildJoystickStick=function(){var t=document.createElement("canvas");t.width=86,t.height=86;var e=t.getContext("2d");return e.beginPath(),e.strokeStyle=this._strokeStyle,e.lineWidth=6,e.arc(t.width/2,t.width/2,40,0,2*Math.PI,!0),e.stroke(),t},c.prototype._move=function(t,e,n){this._transform?this._has3d?t[this._transform]="translate3d("+e+"px,"+n+"px, 0)":t[this._transform]="translate("+e+"px,"+n+"px)":(t.left=e+"px",t.top=n+"px")},c.prototype._getTransformProperty=function(){for(var t,e=["webkitTransform","MozTransform","msTransform","OTransform","transform"],n=document.createElement("p"),r=0;r<e.length;r++)if(t=e[r],null!=n.style[t])return t},c.prototype._check3D=function(){var e=this._getTransformProperty();if(!e||!window.getComputedStyle)return t.exports=!1;var n=document.createElement("div");n.style[e]="translate3d(1px,1px,1px)",document.body.insertBefore(n,null);var r=getComputedStyle(n).getPropertyValue({webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"}[e]);return document.body.removeChild(n),null!=r&&r.length&&"none"!=r}},function(t,e){
/*! fast-json-patch, version: 3.0.0-1 */
!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */
var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var o=Object.prototype.hasOwnProperty;function i(t,e){return o.call(t,e)}function a(t){if(Array.isArray(t)){for(var e=new Array(t.length),n=0;n<e.length;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);e=[];for(var r in t)i(t,r)&&e.push(r);return e}function s(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function c(t,e){var n;for(var r in t)if(i(t,r)){if(t[r]===e)return s(r)+"/";if("object"==typeof t[r]&&""!=(n=c(t[r],e)))return s(r)+"/"+n}return""}function u(t,e){var n=[t];for(var r in e){var o="object"==typeof e[r]?JSON.stringify(e[r],null,2):e[r];void 0!==o&&n.push(r+": "+o)}return n.join("\n")}e.hasOwnProperty=i,e._objectKeys=a,e._deepClone=function(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}},e.isInteger=function(t){for(var e,n=0,r=t.length;n<r;){if(!((e=t.charCodeAt(n))>=48&&e<=57))return!1;n++}return!0},e.escapePathComponent=s,e.unescapePathComponent=function(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")},e._getPathRecursive=c,e.getPath=function(t,e){if(t===e)return"/";var n=c(t,e);if(""===n)throw new Error("Object not found in root");return"/"+n},e.hasUndefined=function t(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var n=0,r=e.length;n<r;n++)if(t(e[n]))return!0}else if("object"==typeof e){var o=a(e),i=o.length;for(n=0;n<i;n++)if(t(e[o[n]]))return!0}return!1};var l=function(t){function e(e,n,r,o,i){var a=this.constructor,s=t.call(this,u(e,{name:n,index:r,operation:o,tree:i}))||this;return s.name=n,s.index=r,s.operation=o,s.tree=i,Object.setPrototypeOf(s,a.prototype),s.message=u(e,{name:n,index:r,operation:o,tree:i}),s}return r(e,t),e}(Error);e.PatchError=l},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.JsonPatchError=r.PatchError,e.deepClone=r._deepClone;var o={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){var o=a(n,this.path);o&&(o=r._deepClone(o));var i=s(n,{op:"remove",path:this.from}).removed;return s(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:o}},copy:function(t,e,n){var o=a(n,this.from);return s(n,{op:"add",path:this.path,value:r._deepClone(o)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:h(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},i={add:function(t,e,n){return r.isInteger(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){return{newDocument:n,removed:t.splice(e,1)[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:o.move,copy:o.copy,test:o.test,_get:o._get};function a(t,e){if(""==e)return t;var n={op:"_get",path:e};return s(t,n),n.value}function s(t,n,s,c,l,d){if(void 0===s&&(s=!1),void 0===c&&(c=!0),void 0===l&&(l=!0),void 0===d&&(d=0),s&&("function"==typeof s?s(n,0,t,n.path):u(n,0)),""===n.path){var p={newDocument:t};if("add"===n.op)return p.newDocument=n.value,p;if("replace"===n.op)return p.newDocument=n.value,p.removed=t,p;if("move"===n.op||"copy"===n.op)return p.newDocument=a(t,n.from),"move"===n.op&&(p.removed=t),p;if("test"===n.op){if(p.test=h(t,n.value),!1===p.test)throw new e.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",d,n,t);return p.newDocument=t,p}if("remove"===n.op)return p.removed=t,p.newDocument=null,p;if("_get"===n.op)return n.value=t,p;if(s)throw new e.JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",d,n,t);return p}c||(t=r._deepClone(t));var f=(n.path||"").split("/"),v=t,_=1,m=f.length,y=void 0,g=void 0,E=void 0;for(E="function"==typeof s?s:u;;){if(g=f[_],l&&"__proto__"==g)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(s&&void 0===y&&(void 0===v[g]?y=f.slice(0,_).join("/"):_==m-1&&(y=n.path),void 0!==y&&E(n,0,t,y)),_++,Array.isArray(v)){if("-"===g)g=v.length;else{if(s&&!r.isInteger(g))throw new e.JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",d,n,t);r.isInteger(g)&&(g=~~g)}if(_>=m){if(s&&"add"===n.op&&g>v.length)throw new e.JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",d,n,t);if(!1===(p=i[n.op].call(n,v,g,t)).test)throw new e.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",d,n,t);return p}}else if(g&&-1!=g.indexOf("~")&&(g=r.unescapePathComponent(g)),_>=m){if(!1===(p=o[n.op].call(n,v,g,t)).test)throw new e.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",d,n,t);return p}if(v=v[g],_<m&&(!v||"object"!=typeof v))throw new e.JsonPatchError("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",d,n,t)}}function c(t,n,o,i,a){if(void 0===i&&(i=!0),void 0===a&&(a=!0),o&&!Array.isArray(n))throw new e.JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(t=r._deepClone(t));for(var c=new Array(n.length),u=0,l=n.length;u<l;u++)c[u]=s(t,n[u],o,!0,a,u),t=c[u].newDocument;return c.newDocument=t,c}function u(t,n,i,a){if("object"!=typeof t||null===t||Array.isArray(t))throw new e.JsonPatchError("Operation is not an object","OPERATION_NOT_AN_OBJECT",n,t,i);if(!o[t.op])throw new e.JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",n,t,i);if("string"!=typeof t.path)throw new e.JsonPatchError("Operation `path` property is not a string","OPERATION_PATH_INVALID",n,t,i);if(0!==t.path.indexOf("/")&&t.path.length>0)throw new e.JsonPatchError('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",n,t,i);if(("move"===t.op||"copy"===t.op)&&"string"!=typeof t.from)throw new e.JsonPatchError("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",n,t,i);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&void 0===t.value)throw new e.JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",n,t,i);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&r.hasUndefined(t.value))throw new e.JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",n,t,i);if(i)if("add"==t.op){var s=t.path.split("/").length,c=a.split("/").length;if(s!==c+1&&s!==c)throw new e.JsonPatchError("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",n,t,i)}else if("replace"===t.op||"remove"===t.op||"_get"===t.op){if(t.path!==a)throw new e.JsonPatchError("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",n,t,i)}else if("move"===t.op||"copy"===t.op){var u=l([{op:"_get",path:t.from,value:void 0}],i);if(u&&"OPERATION_PATH_UNRESOLVABLE"===u.name)throw new e.JsonPatchError("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",n,t,i)}}function l(t,n,o){try{if(!Array.isArray(t))throw new e.JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(n)c(r._deepClone(n),r._deepClone(t),o||!0);else{o=o||u;for(var i=0;i<t.length;i++)o(t[i],i,n,void 0)}}catch(t){if(t instanceof e.JsonPatchError)return t;throw t}}function h(t,e){if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e){var n,r,o,i=Array.isArray(t),a=Array.isArray(e);if(i&&a){if((r=t.length)!=e.length)return!1;for(n=r;0!=n--;)if(!h(t[n],e[n]))return!1;return!0}if(i!=a)return!1;var s=Object.keys(t);if((r=s.length)!==Object.keys(e).length)return!1;for(n=r;0!=n--;)if(!e.hasOwnProperty(s[n]))return!1;for(n=r;0!=n--;)if(!h(t[o=s[n]],e[o]))return!1;return!0}return t!=t&&e!=e}e.getValueByPointer=a,e.applyOperation=s,e.applyPatch=c,e.applyReducer=function(t,n,r){var o=s(t,n);if(!1===o.test)throw new e.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",r,n,t);return o.newDocument},e.validator=u,e.validate=l,e._areEquals=h},function(t,e,n){var r=n(1);Object.assign(e,r);var o=n(3);Object.assign(e,o);var i=n(0);e.JsonPatchError=i.PatchError,e.deepClone=i._deepClone,e.escapePathComponent=i.escapePathComponent,e.unescapePathComponent=i.unescapePathComponent},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */
var r=n(0),o=n(1),i=new WeakMap,a=function(t){this.observers=new Map,this.obj=t},s=function(t,e){this.callback=t,this.observer=e};function c(t,e){void 0===e&&(e=!1);var n=i.get(t.object);u(n.value,t.object,t.patches,"",e),t.patches.length&&o.applyPatch(n.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function u(t,e,n,o,i){if(e!==t){"function"==typeof e.toJSON&&(e=e.toJSON());for(var a=r._objectKeys(e),s=r._objectKeys(t),c=!1,l=s.length-1;l>=0;l--){var h=t[p=s[l]];if(!r.hasOwnProperty(e,p)||void 0===e[p]&&void 0!==h&&!1===Array.isArray(e))Array.isArray(t)===Array.isArray(e)?(i&&n.push({op:"test",path:o+"/"+r.escapePathComponent(p),value:r._deepClone(h)}),n.push({op:"remove",path:o+"/"+r.escapePathComponent(p)}),c=!0):(i&&n.push({op:"test",path:o,value:t}),n.push({op:"replace",path:o,value:e}),!0);else{var d=e[p];"object"==typeof h&&null!=h&&"object"==typeof d&&null!=d?u(h,d,n,o+"/"+r.escapePathComponent(p),i):h!==d&&(!0,i&&n.push({op:"test",path:o+"/"+r.escapePathComponent(p),value:r._deepClone(h)}),n.push({op:"replace",path:o+"/"+r.escapePathComponent(p),value:r._deepClone(d)}))}}if(c||a.length!=s.length)for(l=0;l<a.length;l++){var p=a[l];r.hasOwnProperty(t,p)||void 0===e[p]||n.push({op:"add",path:o+"/"+r.escapePathComponent(p),value:r._deepClone(e[p])})}}}e.unobserve=function(t,e){e.unobserve()},e.observe=function(t,e){var n,o=function(t){return i.get(t)}(t);if(o){var u=function(t,e){return t.observers.get(e)}(o,e);n=u&&u.observer}else o=new a(t),i.set(t,o);if(n)return n;if(n={},o.value=r._deepClone(t),e){n.callback=e,n.next=null;var l=function(){c(n)},h=function(){clearTimeout(n.next),n.next=setTimeout(l)};"undefined"!=typeof window&&(window.addEventListener("mouseup",h),window.addEventListener("keyup",h),window.addEventListener("mousedown",h),window.addEventListener("keydown",h),window.addEventListener("change",h))}return n.patches=[],n.object=t,n.unobserve=function(){c(n),clearTimeout(n.next),function(t,e){t.observers.delete(e.callback)}(o,n),"undefined"!=typeof window&&(window.removeEventListener("mouseup",h),window.removeEventListener("keyup",h),window.removeEventListener("mousedown",h),window.removeEventListener("keydown",h),window.removeEventListener("change",h))},o.observers.set(e,new s(e,n)),n},e.generate=c,e.compare=function(t,e,n){void 0===n&&(n=!1);var r=[];return u(t,e,r,"",n),r}}])}]);
//# sourceMappingURL=coral-blox-min.js.map