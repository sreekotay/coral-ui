{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./public/reefer/src/reefer.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","legacy","document","currentScript","rf_script","window","reeferHTML","data","obj","constructor","apply","toString","split","slice","join","dsc","getElementsByTagName","length","cb","reefCB","undefined","outerHTML","parentNode","removeChild","ReeferFactory","opts","rf_counter","rf_listeners","rf_key","rf_registry","template","slots","this","default","datasrc","uk","_d","dc","dot","datactx","dl","gk","genkey","gen","dataslot","empty","text","datakey","Array","isArray","header","html","script","__key__","xs","privateprop","row","footer","reefWarn","console","error","arguments","reefError","Error","alwaysobj","rf","run","arg","rels","querySelectorAll","reef","rr","reeferDOM","render_","push","el","parentReef","reefName","getAttribute","attrBag","attrlist","attributes","attr","indexOf","val","spl","ev","substring","determineDataBinding","JSON","parse","err","lis","getAttributes","cloneEl","cloneNode","children","ga","sa","nodeName","type","args","match","ftext","innerHTML","trim","reefScript","Function","templateEngine","mount","k","v","prop","selector","localData","defaultData","use","setAttribute","listeners","rl","e","listenerFactory","addEventListener","reefStop","event","str","argsets","detail","reefEmitRootEl","target","evattr","handlers","evvalue","fn","idx","rval","f","isfunction","rn","arrtoobj","arr","cif","props","o1","o2","clone","Reefer","rootEl","setup","localSetup","_","__","shared","events","assign","decorators","super","sh","methods","obsf","react","observe","observers","doDataBind","__observe__","sym","loadData","datapath","url","xhr","XMLHttpRequest","onerror","log","emit","onload","status","res","response","open","method","send","loadHTML","readyState","createElement","src","appendChild","write","realizeSource","refobj","copyprop","pp","sp","fp","oc","nc","proppath","sel","selctx","_b","_bp","querySelector","dp","alias","u","getRootNode","unmount","unobs","render","Date","rel","fc","fcounter","htmlBegin","harr","htmlEnd","forEach","classList","contains","rerender","ael","activeElement","startPosition","selectionStart","endPosition","selectionEnd","aeindex","node","childNodes","ind","pop","focus","saveSelection","getAttachPoint","hash","charCodeAt","mergeNode","attemptMerge","nodeType","nodeValue","at","a","na","nal","ca","cal","removeAttribute","copyAttributes","cc","il","Math","min","ccn","ncn","isEqualNode","replaceChild","ctx","ret","last","resolveEl","dispatchEvent","CustomEvent","ready","documentElement","doScroll","unobserve","b","updates","root","path","_obs","obsrx","regexprep","replace","regx","RegExp","mp","op","action","mstatus","_ev","prev","mutate","decorate","set","evrx","watch","copyk","debounce","forceClean","hmap","hgeneration","htmlUpdate","id","htmlGen","hm","hsh","div","genid","hta","ha","fl","hc","generation","ah","htaa","cnt","haa","h","previousSibling","insertBefore","nextSibling","insertAdjacentHTML","htmlKeyToIdx","splice","styleBag","Node","stringify","__xs__style","style","autorun","templateString","register","inname","reefData","superReef","registry","find","findAll","j","reefer"],"mappings":"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","file":"reefer-core.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","var legacy = !document.currentScript\r\nvar rf_script = null\r\nwindow.reeferHTML = function (data) {\r\n  function isfunction (obj) { return !!(obj && obj.constructor && obj.call && obj.apply) }\r\n  if (isfunction(data)) data = data.toString().split('\\n').slice(1, -1).join('\\n')\r\n  var dsc = legacy ? null : document.currentScript\r\n  if (!dsc) dsc = rf_script\r\n  if (!dsc) { // IE11 support\r\n    dsc = document.getElementsByTagName('script')\r\n    dsc = dsc[dsc.length - 1]\r\n  }\r\n  rf_script = null\r\n  var cb = dsc.reefCB\r\n  if (cb === undefined) dsc.outerHTML = data\r\n  else cb(data)\r\n  if (dsc.parentNode) dsc.parentNode.removeChild(dsc)\r\n}\r\n\r\nReeferFactory = function (opts) {\r\n  opts = opts || {}\r\n  var rf_counter = 0 // used for 'symbol'\r\n  var rf_listeners = {}\r\n  var rf_key = 0\r\n  var rf_registry = {\r\n    '': {\r\n      template: function () {\r\n        var slots = this.slots || {}\r\n        if (!slots.default) return// 'done'\r\n        if (!this.data.datasrc) return 'done'\r\n        var _d = this.data\r\n        var dc = ('datactx' in _d) ? this.dot(_d.datactx).value : {}\r\n        var dl = ('datasrc' in _d) ? this.dot(_d.datasrc).value : this\r\n        var gk = this.data.genkey\r\n        var gen = (dl && slots[_d.dataslot || 'default']) || (slots.empty && slots.empty.text) || { text: '<div> </div>' }\r\n        var key = _d.datakey; var uk\r\n        if (!Array.isArray(dl)) dl = [dl]\r\n        if (slots.header) this.html(-1, slots.header.script ? slots.header(dc) : slots.header.text)\r\n        for (var i = 0; i < dl.length; i++) {\r\n          var t = typeof (dl[i])\r\n          if (dl[i]) uk = key === undefined ? dl[i].__key__ : dl[i][key]\r\n          if (gk && uk === undefined && t === 'object') uk = xs.privateprop(dl[i], '__key__', 'k' + rf_key++)\r\n          var row = gen.script ? gen.script(dl[i], i, dc) : gen.text\r\n          this.html(uk || i, row)\r\n        }\r\n        if (slots.footer) this.html(-2, slots.footer.script ? slots.footer(dc) : slots.footer.text)\r\n      }\r\n    }\r\n  }\r\n\r\n  function reefWarn () { console.error(arguments) }\r\n  function reefError () { console.error(arguments); throw Error('REEF FAULT') }\r\n  function alwaysobj (rf, n) { rf[n] = rf[n] || {}; return rf[n] }\r\n\r\n  // ===========\r\n  // dom\r\n  // ===========\r\n  function run (arg) {\r\n    var d = (arg || document)\r\n    var r = []\r\n    var rels = d.querySelectorAll(':not([reef-stage])[reef]')\r\n    for (var i = 0; i < rels.length; i++) {\r\n      if (!rels[i].reef) {\r\n        var rr = reeferDOM(rels[i], d.reef)\r\n        if (rr) rr.render_()\r\n        r.push(rr)\r\n      }\r\n    }\r\n    return r\r\n  }\r\n\r\n  // var stripper = document.createElement('textarea')\r\n  function reeferDOM (el, parentReef) {\r\n    if (!el) return null\r\n    var reefName = el.getAttribute('reef')\r\n    try {\r\n      var attrBag = getAttributes(el)\r\n      var cloneEl = el.cloneNode(true) // deep copy\r\n      if (cloneEl) {\r\n        attrBag = attrBag || {}\r\n        if (cloneEl.children) {\r\n          for (var i = 0; i < cloneEl.children.length; i++) {\r\n            var slots = alwaysobj(attrBag, 'slots')\r\n            var c = cloneEl.children[i]\r\n            var ga = c.getAttribute\r\n            var attr = (ga && ga.call(c, 'reef-slot')) || 'default'\r\n            var sa = slots[attr] = slots[attr] || []\r\n            sa.push(c)\r\n            sa.text = (sa.text || '') + (ga ? c.outerHTML : c.data) // convenience\r\n            if (c.nodeName === 'SCRIPT' && c.type.indexOf('reef-') === 0) {\r\n              try {\r\n                var type = c.getAttribute('type')\r\n                var args = type.match(/\\(([^)]*)\\)/); args = args ? args[1] : ''\r\n                var ftext = c.innerHTML.trim()\r\n                // stripper.innerHTML = ftext\r\n                // ftext = stripper.children.length === 0 ? '' : stripper.children[0].data\r\n                if (ftext) {\r\n                  switch (type.split('(')[0].trim()) {\r\n                    case 'reef-function': c.reefScript = new Function(args, ftext); break\r\n                    case 'reef-template': c.reefScript = templateEngine(args, ftext); break\r\n                    default: reefWarn('unknown reef slot type')\r\n                  }\r\n                }\r\n              } catch (err) { reefWarn('reef-slot script parsing ERROR:', ftext || c.type, c, err) }\r\n              if (!('el' in sa)) sa.el = c // convenience\r\n              if (!('script' in sa) && c.reefScript) sa.script = c.reefScript // convenience\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      return mount(el, reefName, attrBag, parentReef)\r\n    } catch (err) {\r\n      reefWarn('Reefer failed to mount: ', reefName, el, err)\r\n    }\r\n    return null\r\n  }\r\n  /*\r\n  function parseArgs (str) {\r\n    var argsets = str.match(/\\(([^)]*)\\)/)\r\n    return (argsets && argsets[1]) || ''\r\n  }\r\n*/\r\n  function getAttributes (el) {\r\n    var attrBag\r\n    var attrlist = el.attributes\r\n    for (var i = 0; i < attrlist.length; i++) {\r\n      var attr = attrlist[i]\r\n      var n = attr.name + ''\r\n      if (n.indexOf('reef-p') === 0) {\r\n        attrBag = attrBag || { }\r\n        var val = attr.value\r\n        var spl = n[6] // whatever the character is... use two of those to split - 6 is len of 'reef-p'\r\n        var ev = val.split(spl + spl); val = ev[0]; ev = ev[1]\r\n        var p = n.substring(7) // 7 is len of 'reef-pX' (note the 'X')\r\n        var d = determineDataBinding(p, val)\r\n        try { val = JSON.parse(val) } catch (err) {}\r\n        if (!d) alwaysobj(attrBag, 'props')[p] = val; else alwaysobj(attrBag, 'bind')[p] = d\r\n        if (ev) alwaysobj(attrBag, 'events')[p] = ev\r\n      } else if (n.indexOf('reef@') === 0) {\r\n        var lis = n.substring(5)\r\n        attrBag = attrBag || { }\r\n        alwaysobj(attrBag, 'listeners')[lis] = attr.value\r\n      }\r\n    }\r\n    return attrBag\r\n  }\r\n\r\n  function determineDataBinding (k, v) {\r\n    if (v[0] !== '~') return false\r\n    var s = v.split('~')\r\n    return { prop: s[1], selector: (s.length < 2) ? '^' : s[2] }\r\n  }\r\n\r\n  function templateGenerator (args, templateString) {\r\n    return new Function(args, 'return `' + templateString + '`;')\r\n  }\r\n\r\n  function templateGeneratorES5 (args, templateString) {\r\n    templateString = templateString.split('\\n').join('\\\\\\n').replace(/\"/g, '\\\\\"') // multiline and escape double quotes and slashes\r\n    return new Function(args, 'var f=function (_, exp) {return eval(exp)}; f.bind(this); return \"' + templateString + '\".replace(/\\\\${(.*?)}/g, f)')\r\n  }\r\n\r\n  function mount (el, name, localData, parentReef) {\r\n    localData = localData || {}\r\n    if (!rf_registry[name]) reefError('Reefer NOT registered: ', name)\r\n\r\n    // make Reefer\r\n    var defaultData = rf_registry[name]\r\n    var reef = el.reef = new opts.use(el, defaultData, localData)\r\n    reef.name = name\r\n    el.setAttribute('reef-stage', 'mounted')\r\n\r\n    // register listeners\r\n    if (reef.listeners) {\r\n      var rl = reef.listeners\r\n      for (var k in rl) {\r\n        var ev = k.split('@')\r\n        var e = ev[0]\r\n        if (!rf_listeners[e]) { // we only need to add it once\r\n          rf_listeners[e] = listenerFactory(e)\r\n          document.addEventListener(e, rf_listeners[e], false)\r\n        }\r\n        rl[e] = rl[k]\r\n        if (rl[ev[1]] === 'stop') rl[e].reefStop = true\r\n      }\r\n      reef.listeners = null // keep the tag so we know we had listeners - but they are source from the registry\r\n    }\r\n\r\n    return reef\r\n  }\r\n\r\n  function listenerFactory (type) {\r\n    return function (event) {\r\n      var el = (event.detail && event.detail.reefEmitRootEl) || event.target; var rr\r\n      var evattr = 'reef@' + type\r\n      var handlers = []\r\n      while (el) {\r\n        var evvalue = el.getAttribute && el.getAttribute(evattr)\r\n        if (evvalue) { evvalue = evvalue.split('@'); handlers.push(evvalue) }\r\n        var reef = el.reef\r\n        if (!event.reef) event.reef = reef\r\n        if (reef && handlers.length) { // parse the handler for the event\r\n          for (var i = 0; i < handlers.length; i++) {\r\n            var ev = handlers[i]\r\n            var fn = ev[0].trim()\r\n            /*\r\n            var func = function (event) { eval(fn) }\r\n            try { func.call(reef, event) } catch (err) { reefWarn('reef@Error') }\r\n            /* // old syntax - you do do prop(value)\r\n            */\r\n            var parseArgs = function (str) {\r\n              var argsets = str.match(/\\(([^)]*)\\)/)\r\n              return (argsets && argsets[1]) || ''\r\n            }\r\n            var args = parseArgs(fn).split(',')\r\n            if (args) {\r\n              fn = fn.split('(')[0]\r\n              var idx = args.indexOf('$event') // allow substition\r\n              if (idx >= 0) args[idx] = event\r\n            }\r\n            var f = reef.dot(fn); var rval\r\n            if (f.value !== undefined) {\r\n              if (isfunction(f.value)) rval = f.value.apply(f.obj, args || [event])\r\n              else reef.dot(fn, args[0])\r\n              if (rval === 'stop' || ev[1] === 'stop') return\r\n            }\r\n          }\r\n        }\r\n        var rn = reef && reef.name\r\n        if (rf_registry[rn]) {\r\n          rr = rf_registry[rn]\r\n          if (rr.listeners && rr.listeners[type]) {\r\n            if (rr.listeners[type].call(reef, event) === 'stop' || rr.listeners[type].reefStop) { return } // hmm - should we support bubbling?\r\n          }\r\n        }\r\n        el = el.parentNode\r\n      }\r\n    }\r\n  }\r\n\r\n  function register (inname, reefData, superReef) {\r\n    var name = (inname[0] === '*') ? inname.substring(1) : inname\r\n    superReef = superReef || ''\r\n    reefData.data = arrtoobj(reefData.data, undefined)\r\n    if (rf_registry[name]) { if (inname === name) reefError('Reefer already registered: ' + name); return }\r\n    if (!rf_registry[superReef]) reefError('Super Reef NOT registered: ' + superReef)\r\n    rf_registry[name] = xs.assign({}, rf_registry[superReef], reefData)\r\n    rf_registry[name].name = name\r\n    rf_registry[name].super = superReef\r\n    return true\r\n  }\r\n\r\n  // ===========\r\n  // Reefer - helpers\r\n  // ===========\r\n  function resolveEl (el, ctx) { if (typeof (el) !== 'string') return el; return resolveEl(ctx || document).querySelector(el) }\r\n  function isfunction (obj) { return !!(obj && obj.constructor && obj.call && obj.apply) }\r\n  function arrtoobj (arr, v) { if (!Array.isArray(arr)) return arr; var o = {}; for (var i = 0; i < arr.length; i++) o[arr[i]] = (arguments.length <= 1 ? true : v); return o }\r\n  function cif (o, props, o1, o2) {\r\n    for (var i = 0; i < props.length; i++) {\r\n      var p = props[i]\r\n      var np = (p in o2) ? o2[p] : o1[p]\r\n      if (np === undefined) continue\r\n      o[p] = xs.clone(o1[p], o2[p])\r\n    }\r\n  }\r\n\r\n  // =============\r\n  // Reefer - constructor\r\n  // =============\r\n  function Reefer (rootEl, setup, localSetup) {\r\n    setup = setup || {}\r\n    localSetup = localSetup || {}\r\n    var rf = this\r\n    var _ = this.__ = {}\r\n    cif(_, ['template', 'update', 'bind'], setup, localSetup)\r\n    cif(this, ['methods', 'observers', 'listeners', 'mutate'], setup, localSetup) // intentional shallow copies\r\n    if ('shared' in setup) this.shared = setup.shared\r\n    if (setup.events || localSetup.events) _.events = xs.assign({}, arrtoobj(setup.events), localSetup.events)\r\n    if (setup.decorators || localSetup.decorators) _.decorators = xs.assign({}, arrtoobj(setup.decorators), arrtoobj(localSetup.decorators))\r\n    if (setup.slots || localSetup.slots) xs.assign(alwaysobj(this, 'slots'), setup.slots, localSetup.slots)\r\n    if ('super' in setup) this.super = rf_registry[setup.super]\r\n\r\n    var sh = this.methods; if (sh) for (var k in sh) sh[k] = isfunction(sh[k]) ? sh[k].bind(rf) : sh[k] // bind to reef\r\n    // sh = this.observers; if (sh) for (k in sh) sh[k] = isfunction(sh[k]) ? sh[k].bind(rf) : sh[k] // bind to reef\r\n    this.rootEl = rootEl\r\n    _.obsf = function () { Reefer.prototype.react.apply(rf, arguments) }\r\n    var _d = this.data = xs.observe({}, _.obsf) // public as well -- our main \"react\" core\r\n    xs.assign(_d, _.decorators, setup.data, localSetup.props) // make our data\r\n    for (k in this.observers) if (!(k in _d)) _d[k] = undefined\r\n    for (k in _.bind) doDataBind(this, 'data.' + k, _.bind[k].selector, _.bind[k].prop)\r\n    _d.__observe__() // trigger observers\r\n    this.sym = '$' + rf_counter++\r\n    return this\r\n  }\r\n  Reefer.prototype.unmount = function () {\r\n    var _ = this.__ || {}\r\n    xs.unobserve(this.data, _.obsf)\r\n    if (_.bind) {\r\n      for (var k in _.bind) {\r\n        var b = _.bind[k]\r\n        if (b.obsf) xs.unobserve(b.sp.obj, b.obsf)\r\n      }\r\n    }\r\n  }\r\n\r\n  function regexprep (o) { var s = ''; for (var k in o) { s += ':xs:' + k + '\\n' }; return s }\r\n\r\n  // =============\r\n  // react\r\n  // =============\r\n  Reefer.prototype.react = function (updates) { // core event engine\r\n    // if (updates.value === updates.prev) return\r\n    updates.reef = this\r\n    var _ = this.__\r\n    var status\r\n    var p = updates.root = updates.path ? updates.path.split('.')[0] : updates.prop\r\n    var _obs = this.observers\r\n    if (_obs) {\r\n      _.obsrx = _.obsrx || regexprep(_obs)\r\n      if (updates.path) {\r\n        var str = '(:xs:((' + updates.path.replace(/\\./g, '\\\\.)|(\\\\*\\\\.))*((') + ')|(\\\\*)))\\n'\r\n        var regx = new RegExp(str, 'g')\r\n        var m = _.obsrx.match(regx)\r\n        if (m) {\r\n          var mp = m[0]\r\n          for (var i = 1; i < m.length; i++) if (m[i].length > mp.length) mp = m[i]\r\n          p = mp.substring(4, mp.length - 1) // skipe the ':xs:\r\n        }\r\n      }\r\n      var op = _obs[p]\r\n      if (op) {\r\n        if (isfunction(op)) status = op.call(this, updates)\r\n        else {\r\n          if (!updates.path && (updates.action === 'set' || updates.action === 'add')) {\r\n            var o = this.dot(op)\r\n            if (isfunction(o.value)) o.value.call(this)\r\n            else o.obj[o.prop] = updates.value\r\n          }\r\n        }\r\n      }\r\n    }\r\n    var _ev = _.events\r\n    if (_ev && _ev[p]) {\r\n      var e = _.name + '.' + (_ev[p] === true ? p : _ev[p])\r\n      emit(this.rootEl, e, updates)\r\n    }\r\n\r\n    var mstatus\r\n    if (updates.value === updates.prev) return\r\n    if (this.mutate) mstatus = this.mutate.call(this, updates)\r\n    var _d = _.decorators\r\n    if (!this.sym) return // we are still constructing\r\n    if (status !== 'done' && mstatus !== 'done' && (!_d || (!_d[p] && !_d[mp]))) this.rerender() // re-render\r\n  }\r\n  Reefer.prototype.observe = function (k, cb) { var _o = alwaysobj(this, 'observers'); _o[k] = cb; this.__.obsrx = null }\r\n  Reefer.prototype.decorate = function (k, set) { var _d = alwaysobj(this, 'decorators'); _d[k] = (set !== false && set !== 0) }\r\n  Reefer.prototype.events = function (k, set) { var _e = alwaysobj(this.__, 'events'); _e[k] = (set !== false && set !== 0 && set); this.__.evrx = null }\r\n  Reefer.prototype.watch = function (k, o) { this.data[k] = o; this.data.__observe__() }\r\n  Reefer.prototype.bind = function (k, sel, copyk, ctx) { doDataBind(this, k, sel, copyk, ctx) }\r\n  Reefer.prototype.emit = function (ev, detail) { emit(this.rootEl, ev, detail) }\r\n  function loadData (datapath, url, opts) { // this must be Reefer\r\n    var rf = this\r\n    opts = opts || {}\r\n    var rf = this\r\n    var xhr = opts.xhr || new XMLHttpRequest()\r\n    /* if (!opts.xhr || opts.responseType) // either it's new or it's passed in\r\n    { xhr.responseType = opts.responseType || 'json' } */\r\n    xhr.onerror = function (err) { console.log('REEF HTTP LOAD', err); emit(rf.rootEl, 'reefLoadDataFail', { url: url }) }\r\n    xhr.onload = function (ev) {\r\n      if (this.status === 200) {\r\n        var res = this.response\r\n        try { res = JSON.parse(res) } catch (err) {}\r\n        rf.dot(datapath, res)\r\n      } else if (this.status) xhr.onerror(ev)\r\n    }\r\n    xhr.open(opts.method || 'GET', url, true)\r\n    xhr.send(null)\r\n    return xhr\r\n  }\r\n  function loadHTML (datapath, url) { // this must be Reefer\r\n    var rf = this\r\n    if (document.readyState !== 'loading') {\r\n      var script = document.createElement('script')\r\n      script.src = url\r\n      document.getElementsByTagName('head')[0].appendChild(script)\r\n    } else {\r\n      document.write('<script src=\"' + url + '\"></script')\r\n      script = document.getElementsByTagName('script')\r\n      script = script[script.length - 1]\r\n    }\r\n    script.onerror = function (err) { console.log('REEF SCRIPT LOAD', err); script.parentNode.removeChild(script); emit(rf.rootEl, 'reefLoadHTMLFail', { url: url }) }\r\n    script.reefCB = function (data) { rf.dot(datapath, data) }\r\n    rf_script = script\r\n    return script\r\n  }\r\n\r\n  function realizeSource (refobj, copyprop) {\r\n    var pp = copyprop.split('.')\r\n    sp = dot(refobj, pp)\r\n    if (sp.obj) return sp\r\n    var fp = copyprop.split('.'); var oc = refobj\r\n    for (var i = 0; i < fp.length; i++) {\r\n      var nc = oc[fp[i]]; if (nc === undefined || nc === null || typeof (nc) !== 'object') oc[fp[i]] = (i == fp.length - 1 ? undefined : {}); oc = oc[fp[i]]\r\n    }\r\n    return dot(refobj, pp)\r\n  }\r\n\r\n  function doDataBind (rf, proppath, sel, copyprop, selctx) {\r\n    var refobj, sp\r\n    sel = sel || '^'\r\n    var _ = rf.__\r\n    var _b = alwaysobj(_, 'bind')\r\n    var _bp = alwaysobj(_b, proppath)\r\n    copyprop = copyprop || proppath\r\n    if (_bp.proppath === proppath && _bp.selector === sel && _bp.prop === copyprop) return\r\n    switch (sel[0]) {\r\n      case '^':\r\n        sp = realizeSource(rf, copyprop)\r\n        break\r\n      case '#':\r\n      case '.':\r\n      case '[':\r\n        var el = (selctx || document).querySelector(sel)\r\n        refobj = el && el.reef\r\n        if (!refobj) reefError('unable to locate reef for bind')\r\n        sp = realizeSource(refobj, copyprop)\r\n        break\r\n      case '$':\r\n        el = sel.substring(1, 6)\r\n        var url = sel.substring(6)\r\n        _b[proppath] = { proppath: proppath, selector: sel, prop: copyprop }\r\n        switch (el) {\r\n          case 'json:': return loadData.call(rf, proppath, url)\r\n          case 'html:': return loadHTML.call(rf, proppath, url)\r\n        }\r\n        // fall through\r\n      default:\r\n        reefError('unknown data bind: ' + proppath + ': ' + sel)\r\n    }\r\n\r\n    var dp = dot(rf, proppath)\r\n    if (!dp.obj) reefError('data bind not found: ' + proppath)\r\n    var f = function (u) {\r\n      if (!rf.rootEl || rf.rootEl.getRootNode() !== document) {\r\n        rf.unmount()\r\n        return\r\n      }\r\n      rf.react(u)\r\n    }\r\n    var obsf = xs.alias(dp.obj, dp.prop, sp.obj, sp.prop, f)\r\n    _b[proppath] = { proppath: proppath, selector: sel, prop: copyprop, sp: sp, unobs: obsf }\r\n  }\r\n\r\n  // =============\r\n  // render\r\n  // =============\r\n  Reefer.prototype.render_ = render\r\n  Reefer.prototype.render = function () {\r\n    xs.debounce(this.sym + '_rr', this, render)\r\n  }\r\n  function render () {\r\n    var t = new Date()\r\n    var rel = this.rootEl\r\n    if (!rel || rel.getRootNode() !== document) {\r\n      this.unmount()\r\n      return\r\n    }\r\n    var template = this.__.template\r\n    if (template) {\r\n      var fc = this.__.fcounter\r\n      if (fc) this.htmlBegin()\r\n      fc = this.__.fcounter //  reset it\r\n      var res = template.call(this, this.slots) || ''\r\n      if (this.__.harr) this.htmlEnd()\r\n      else if (typeof (res) === 'string') {\r\n        if (res !== 'done') rel.innerHTML = res // a way to \"out\"\r\n      } else {\r\n        rel.innerHTML = ''\r\n        if (Array.isArray(res)) res.forEach(function (e) { rel.appendChild(e) })\r\n        else rel.appendChild(res)\r\n      }\r\n      if (rel.parentNode.classList.contains('container')) { rel = rel }\r\n      run(rel) // hydrate nested components (should we only do this if we have a template?)\r\n      if (rel.parentNode.classList.contains('container')) { console.log('render', new Date() - t) }\r\n    }\r\n  }\r\n  Reefer.prototype.rerender = function () {\r\n    xs.debounce(this.sym + '_rr', this, rerender, true)\r\n  }\r\n  function rerender () {\r\n    var sel = saveSelection(this.rootEl)\r\n    render.call(this)\r\n    sel()\r\n  }\r\n  function getAttachPoint (el) {\r\n    switch (el.nodeName) {\r\n      case 'TABLE': return (el.childNodes && el.childNodes[0]) || el\r\n      default: return el\r\n    }\r\n  }\r\n  function hash (str) {\r\n    var hash = 0\r\n    var l = str.length\r\n    for (var i = 0; i < l; i++) {\r\n      var char = str.charCodeAt(i)\r\n      hash = ((hash << 5) - hash) + char\r\n      hash = hash | 0\r\n    }\r\n    return hash\r\n  }\r\n  Reefer.prototype.htmlBegin = function (forceClean) {\r\n    if (!this.__.harr || forceClean) {\r\n      this.__.hmap = {}\r\n      this.__.hgeneration = -1\r\n    }\r\n    this.__.harr = []\r\n    this.__.hgeneration++\r\n    this.__.fcounter = 0\r\n  }\r\n\r\n  function replaceNode (c, nch) {\r\n    var p = c.previousSibling\r\n    var pn = p || c.parentNode\r\n    if (!c.getAttribute) { c.nodeValue = nch } else { c.outerHTML = nch }\r\n    return p ? p.nextSibling : pn.childNodes[0]\r\n  }\r\n\r\n  function copyAttributes (c, n) {\r\n    try {\r\n      var a = {}; var at\r\n      var na = n.attributes; var nal = na.length\r\n      for (var i = 0; i < nal; i++) {\r\n        at = na[i]; a[at.name] = true\r\n        if (c.getAttribute(at.name) !== at.value) c.setAttribute(at.name, at.value)\r\n      }\r\n      var ca = c.attributes; var cal = ca.length\r\n      if (cal === nal) return true\r\n      for (i = 0; i < cal; i++) {\r\n        at = ca[i]; if (a[at.name]) continue\r\n        c.removeAttribute(at.name)\r\n      }\r\n    } catch (err) { return true }\r\n  }\r\n  function attemptMerge (c, n) {\r\n    if (c.nodeType === 3 && n.nodeType === 3) {\r\n      c.nodeValue = n.nodeValue\r\n      return true\r\n    }\r\n    if ((c.nodeName !== n.nodeName) ||\r\n        (!copyAttributes(c, n))) return false\r\n    if (c.childNodes.length || n.childNodes.length) {\r\n      var i\r\n      var cc = c.childNodes\r\n      var nc = n.childNodes\r\n      var il = i = Math.min(cc.length, nc.length)\r\n      while (--i >= 0) {\r\n        var ccn = cc[i]\r\n        var ncn = nc[i]\r\n        if (ccn.nodeType === 3 && ncn.nodeType === 3) { if (ccn.nodeValue !== ncn.nodeValue) ccn.nodeValue = ncn.nodeValue; continue }\r\n        if (ccn.isEqualNode(ncn)) continue\r\n        if (ccn.nodeName !== ncn.nodeName || !attemptMerge(ccn, ncn)) {\r\n          c.replaceChild(ncn, ccn)\r\n        }\r\n      }\r\n      while (il < cc.length) c.removeChild(cc[il++])\r\n      while (il < nc.length) c.appendChild(nc[il++])\r\n    }\r\n    return true\r\n  }\r\n\r\n  function mergeNode (c, n) {\r\n    if (c.nodeName !== n.nodeName || !attemptMerge(c, n)) {\r\n      c.parentNode.replaceChild(n, c)\r\n      return n\r\n    }\r\n    return c\r\n  }\r\n\r\n  Reefer.prototype.htmlUpdate = function (idx, id, htmlGen) {\r\n    var _ = this.__\r\n    var hm = _.hmap\r\n    if (!hm) return\r\n    var hsh = hash(htmlGen)\r\n    id = (id === undefined || id === null) ? hsh : id\r\n    if (!(id in hm)) reefError('updateing non-existent element')\r\n    if (hm[id].hsh === hsh && idx === hm[id].idx) return\r\n    var root = getAttachPoint(this.rootEl)\r\n    var c = hm[id].el\r\n    if (!c.getAttribute) { if (c.nodeValue !== htmlGen) c.nodeValue = htmlGen; return } // cheat\r\n    var div = document.createElement(root.nodeName)\r\n    div.innerHTML = htmlGen\r\n    hm[id].el = mergeNode(root.childNodes[idx], div.childNodes[0])\r\n    // hm[id].el = replaceNode(root.childNodes[idx], htmlGen)\r\n    hm[id].hsh = hsh\r\n    hm[id].idx = idx\r\n  }\r\n\r\n  Reefer.prototype.htmlEnd = function () {\r\n    var _ = this.__\r\n    var genid = _.hgeneration\r\n    var hta = ''\r\n    var ha = _.harr\r\n    var hm = _.hmap\r\n    if (!ha) return\r\n    var fl = this.__.fcounter\r\n    var prev = null\r\n    if (fl === 0) {\r\n      this.htmlBegin(true) // reset\r\n      this.rootEl.innerHTML = ''\r\n      return\r\n    }\r\n    if (genid === 0 || fl === 0) this.rootEl.innerHTML = '' // do this first\r\n    for (var k in hm) { // delete untouched\r\n      var hc = hm[k]\r\n      if (hc.generation === genid) continue\r\n      if (hc.el) hc.el.parentNode.removeChild(hc.el)\r\n      delete hm[k]\r\n    }\r\n\r\n    var root = getAttachPoint(this.rootEl)\r\n    var div = document.createElement(root.nodeName)\r\n\r\n    var ah = {}; var htaa = ''; var cnt = 0\r\n    for (var i = 0; i < fl; i++) {\r\n      var haa = ha[i]\r\n      if (!haa.h) { ah[i] = null; continue }\r\n      ah[i] = cnt++\r\n      htaa += haa.h\r\n    }\r\n    if (cnt) div.innerHTML = htaa\r\n\r\n    cnt = 0\r\n    for (var i = 0; i < fl; i++) {\r\n      var c = ha[i].el\r\n      var h = ha[i].h\r\n      if (h) {\r\n        if (i >= root.childNodes.length) {\r\n          hta += h\r\n        } else {\r\n          var n = div.childNodes[ah[i] - cnt]\r\n          if (c) n = mergeNode(c, n)\r\n          if (n !== c) {\r\n            ha[i].el = n\r\n            cnt++\r\n          }\r\n        }\r\n        ha[i].h = null\r\n      }\r\n      c = ha[i].el\r\n      if (c && (c.parentNode !== root || c.previousSibling !== prev)) { // clean up placement\r\n        if (prev) {\r\n          prev.parentNode.insertBefore(c, prev.nextSibling)\r\n        } else if (!root.childNodes || root.childNodes[0] !== c) {\r\n          root.insertBefore(c, root.childNodes && root.childNodes[0])\r\n        }\r\n      }\r\n      prev = c\r\n    }\r\n    ha.length = fl\r\n\r\n    if (hta) root.insertAdjacentHTML('beforeend', hta) // end insert\r\n    root = getAttachPoint(this.rootEl)\r\n    if (root && ha.length != root.childNodes.length) {\r\n      console.error('must be 1 html() entity for hmtl()')\r\n      debugger\r\n    }\r\n    hm = {}\r\n    for (var i = 0; i < ha.length; i++) {\r\n      hm[ha[i].id] = ha[i]\r\n      ha[i].el = root.childNodes[i]\r\n      ha[i].idx = i\r\n    }\r\n    return 'done'\r\n  }\r\n  Reefer.prototype.htmlKeyToIdx = function (id) {\r\n    var hm = this.__.hmap\r\n    if (!hm || !hm[id]) return null\r\n    return hm[id].idx | 0\r\n  }\r\n\r\n  Reefer.prototype.html = function (id, htmlGen) {\r\n    if (!this.__.harr) this.htmlBegin()\r\n    var _ = this.__\r\n    var ha = _.harr\r\n    var hm = _.hmap\r\n    var idx = _.fcounter++\r\n    var genid = _.hgeneration\r\n    var hsh = hash(htmlGen)\r\n    id = (id === undefined || id === null) ? hsh : id\r\n\r\n    if (hm[id]) {\r\n      var hc = hm[id]\r\n      if (hc.generation === genid) reefError('duplicate html() id')\r\n      hc.generation = genid\r\n      ha[idx] = hc\r\n      if (hc.hsh === hsh) return\r\n      hc.h = htmlGen\r\n      hc.hsh = hsh\r\n    } else {\r\n      var o = {\r\n        h: htmlGen,\r\n        hsh: hsh,\r\n        idx: idx,\r\n        id: id,\r\n        generation: genid\r\n      }\r\n      ha.splice(idx, 0, o)\r\n      hm[id] = o\r\n    }\r\n  }\r\n\r\n  Reefer.prototype.dot = function (path, value) {\r\n    var v = dot(this, path)\r\n    if (arguments.length > 1) {\r\n      if (!v.obj) throw ('chain path missing')\r\n      v.obj[v.prop] = value\r\n    }\r\n    return v\r\n  }\r\n  Reefer.prototype.styleBag = function (e, s) {\r\n    var rel = e instanceof Node ? e : this.rootEl\r\n    if (rel === this.rootEl) s = e\r\n    var hsh = hash(JSON.stringify(s))\r\n    if (rel.__xs__style === hsh) return\r\n    for (var k in s) rel.style[k] = s[k]\r\n    rel.__xs__style = hsh\r\n  }\r\n\r\n  // ===========\r\n  // utilities\r\n  // ===========\r\n  /*\r\n  function hoist (o, f) {\r\n    if (o[f].__hoisted__) return false\r\n    var _f = function () { f.apply(p, arguments) }\r\n    o[f] = _f\r\n    xs.privateprop(o, '__hoisted__', true)\r\n    return true\r\n  } */\r\n  /*\r\n  function dotpath (obj, path, value) {\r\n    if (typeof (obj) === 'string') { value = path; path = obj; obj = this }\r\n    var inobj = obj\r\n    var spl = path.split('.')\r\n    var l = spl.length\r\n    var ctx = obj; var key\r\n    for (var i = 0; i < l && (obj !== undefined || !i); i++) {\r\n      key = spl[i]\r\n      ctx = obj\r\n      obj = (obj && key in obj) ? obj[key] : undefined\r\n    }\r\n    if (arguments.length > (inobj === this ? 1 : 2)) {\r\n      if (i !== l) throw Error('full chain path does not exist')\r\n      ctx[key] = value\r\n    }\r\n    var ret = { value: obj, key: key, obj: ctx }\r\n    return (i === l) ? ret : { last: ret }\r\n  }\r\n  */\r\n  function dot (obj, spl) {\r\n    if (typeof (spl) === 'string') spl = spl.split('.')\r\n    var ctx = obj; var l = spl.length; var key\r\n    for (var i = 0; i < l && (obj !== undefined || !i); i++) {\r\n      key = spl[i]; ctx = obj\r\n      obj = (obj && key in obj) ? obj[key] : undefined\r\n    }\r\n    var ret = { value: obj, prop: key, obj: ctx }\r\n    return (i === l) ? ret : { last: ret }\r\n  }\r\n\r\n  function getChildIndex (node) { return [].indexOf.call(node.parentNode.childNodes, node) }\r\n  function saveSelection (rootEl) { // save the text selection (call the ret() as func to retore)\r\n    var ael = document.activeElement\r\n    if (ael) {\r\n      var startPosition = ael.selectionStart\r\n      var endPosition = ael.selectionEnd\r\n      var aeindex = []\r\n      while (ael && ael !== rootEl && ael.parentNode) {\r\n        aeindex.push(getChildIndex(ael))\r\n        ael = ael.parentNode\r\n      }\r\n    }\r\n    return function () {\r\n      if (ael) {\r\n        ael = rootEl\r\n        while (ael && aeindex.length) {\r\n          var ind = aeindex.pop()\r\n          ael = ael.childNodes[ind]\r\n        }\r\n        if (ael) {\r\n          if (ael.focus) ael.focus()\r\n          try {\r\n            ael.selectionStart = startPosition\r\n            ael.selectionEnd = endPosition\r\n          } catch (err) {}\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /*\r\n  function createCSS (name, rules) {\r\n    var style = document.createElement('style')\r\n    style.type = 'text/css'\r\n    document.getElementsByTagName('head')[0].appendChild(style)\r\n    if (!(style.sheet || {}).insertRule) { (style.styleSheet || style.sheet).addRule(name, rules) } else { style.sheet.insertRule(name + '{' + rules + '}', 0) }\r\n  }\r\n\r\n  createCSS('reef-helper', 'display:none;')\r\n*/\r\n  function emit (el, ev, detail) {\r\n    el = resolveEl(el); detail = detail || {}\r\n    if (el) { detail.reefEmitRootEl = el }\r\n    document.dispatchEvent(new CustomEvent(ev, { detail: detail }))\r\n  }\r\n\r\n  function ready (cb) {\r\n    if (document.readyState === 'complete' ||\r\n      (document.readyState !== 'loading' && !document.documentElement.doScroll)) {\r\n      cb()\r\n    } else {\r\n      document.addEventListener('DOMContentLoaded', cb)\r\n    }\r\n  }\r\n  if (opts.autorun) {\r\n    ready(function () {\r\n      run()\r\n    })\r\n  }\r\n\r\n  opts.use = opts.use || Reefer\r\n  var templateEngine = legacy ? templateGeneratorES5 : templateGenerator\r\n\r\n  // ===========\r\n  // exports\r\n  // ===========\r\n  return {\r\n    register: register,\r\n    mount: mount,\r\n    run: run,\r\n    template: templateEngine,\r\n    ready: ready,\r\n    emit: emit,\r\n    styleBag: Reefer.prototype.styleBag,\r\n    registry: function (name) { return name ? rf_registry[name] : rf_registry },\r\n    find: function (a, ctx) { a = this.findAll(a, ctx); return a ? a[0] : null },\r\n    findAll: function (a, ctx) { a = [].slice.call((ctx || document).querySelectorAll(a)); var j = 0; if (a) for (var i = 0; i < a.length; i++) { a[j] = a[i].reef; j += a[j] ? 1 : 0 } return j ? (a.length = j, a) : null }\r\n  }\r\n}\r\n\r\nwindow.reefer = ReeferFactory({ autorun: true })\r\n"],"sourceRoot":""}