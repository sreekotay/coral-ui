{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./public/reefer/src/reefer.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","coral","window","ui","clientSideInclude","data","obj","constructor","apply","toString","split","slice","join","dsc","document","currentScript","rf_script","getElementsByTagName","length","cb","reefCB","undefined","outerHTML","parentNode","removeChild","reefer","opts","xs","rf_range","createRange","rf_counter","rf_listeners","rf_key","rf_registry","template","_d","this","slots","slot","dataslot","datasrc","uk","dc","dot","datactx","dl","gk","genkey","gen","empty","text","datakey","Array","isArray","header","html","script","hm","__","hmap","__hmap__","__key__","privateprop","row","footer","reefWarn","console","error","arguments","reefError","Error","alwaysobj","rf","run","arg","rels","querySelectorAll","reef","rr","reeferDOM","publishLF","render_","push","parseScript","attrBag","type","getAttribute","args","match","ftext","innerHTML","trim","props","Function","reefScript","templateEngine","JSON","parse","err","el","parentReef","reefName","attrlist","attributes","attr","indexOf","val","spl","ev","substring","determineDataBinding","lis","getAttributes","cloneEl","cloneNode","children","ga","nodeName","sa","mount","lf","lifecycle","k","v","prop","selector","localData","defaultData","use","setAttribute","listeners","al","rl","e","listenerFactory","addEventListener","reefStop","event","argsets","detail","reefEmitRootEl","target","evattr","handlers","evvalue","stop","fn","idx","rval","f","isfunction","rn","arrtoobj","arr","cif","o1","o2","clone","Reefer","rootEl","setup","localSetup","_","shared","events","assign","decorators","super","sh","methods","obsf","react","observe","doDataBind","sym","regexprep","loadData","datapath","url","xhr","XMLHttpRequest","onerror","log","emit","onload","status","res","response","sanitize","open","method","send","loadHTML","readyState","createElement","src","appendChild","write","realizeSource","refobj","copyprop","pp","sp","fp","oc","nc","proppath","sel","selctx","_b","_bp","querySelector","els","str","fname","replace","jsonp","dp","alias","u","getRootNode","unmount","unobs","render","Date","rel","fc","fcounter","htmlBegin","harr","htmlEnd","forEach","classList","contains","rerender","renderflag","ael","activeElement","startPosition","selectionStart","endPosition","selectionEnd","aeindex","node","childNodes","ind","pop","focus","saveSelection","getAttachPoint","hash","len","charCodeAt","mergeNode","attemptMerge","nodeType","nodeValue","at","a","na","nal","ca","cal","removeAttribute","copyAttributes","cc","il","Math","min","ccn","ncn","isEqualNode","replaceChild","hydrate","h","selectNode","createContextualFragment","last","rf_s","textContent","resolveEl","ctx","dispatchEvent","CustomEvent","ready","documentElement","doScroll","unobserve","b","updates","root","_obs","observers","_ev","rx","proprx","path","regx","RegExp","mp","mstatus","op","action","prev","mutate","obsrx","decorate","set","evrx","watch","__observe__","copyk","tick","forceClean","hgeneration","htmlIdx","wmap","WeakMap","htmlUpdate","id","htmlGen","hsh","firstChild","genid","hta","ha","fl","hc","generation","div","cnt","previousSibling","insertBefore","nextSibling","rcl","insertAdjacentHTML","htmlFromIdx","htmlChild","htmlToIdx","splice","styleBag","Node","stringify","__xs__style","style","autorun","templateString","register","inname","reefData","superReef","registry","find","findAll","j","ReeferFactory"],"mappings":"aACE,IAAIA,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUC,QAGnC,IAAIC,EAASJ,EAAiBE,GAAY,CACzCG,EAAGH,EACHI,GAAG,EACHH,QAAS,IAUV,OANAI,EAAQL,GAAUM,KAAKJ,EAAOD,QAASC,EAAQA,EAAOD,QAASF,GAG/DG,EAAOE,GAAI,EAGJF,EAAOD,QAKfF,EAAoBQ,EAAIF,EAGxBN,EAAoBS,EAAIV,EAGxBC,EAAoBU,EAAI,SAASR,EAASS,EAAMC,GAC3CZ,EAAoBa,EAAEX,EAASS,IAClCG,OAAOC,eAAeb,EAASS,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEZ,EAAoBkB,EAAI,SAAShB,GACX,oBAAXiB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeb,EAASiB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeb,EAAS,aAAc,CAAEmB,OAAO,KAQvDrB,EAAoBsB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQrB,EAAoBqB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFA1B,EAAoBkB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOrB,EAAoBU,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRzB,EAAoB6B,EAAI,SAAS1B,GAChC,IAAIS,EAAST,GAAUA,EAAOqB,WAC7B,WAAwB,OAAOrB,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAH,EAAoBU,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRZ,EAAoBa,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG/B,EAAoBkC,EAAI,GAIjBlC,EAAoBA,EAAoBmC,EAAI,G,iBC/EpD,IACKC,KAAQC,OAAOD,MAAQC,OAAOD,OAAS,IAAUE,GAAKF,EAAME,IAAM,GACtEF,EAAME,GAAGC,kBAAoB,SAAUC,GACrC,IAAqBC,KACND,IAD8BC,EAAIC,aAAeD,EAAIlC,MAAQkC,EAAIE,QAC1DH,EAAOA,EAAKI,WAAWC,MAAM,MAAMC,MAAM,GAAI,GAAGC,KAAK,OAC3E,IAAIC,EAAMC,SAASC,eAAiBb,OAAOc,UACtCH,IAEHA,GADAA,EAAMC,SAASG,qBAAqB,WAC1BJ,EAAIK,OAAS,IAErBhB,OAAOc,YAAWd,OAAOc,UAAY,MACzC,IAAIG,EAAKN,EAAIO,YACFC,IAAPF,EAAkBN,EAAIS,UAAYjB,EACjCc,EAAGd,GACJQ,EAAIU,YAAYV,EAAIU,WAAWC,YAAYX,IA24BnDX,OAAOuB,OAp4BP,SAAwBC,GACtBA,EAAOA,GAAQ,GACf,IAAIC,EAAKzB,OAAOyB,GACZC,EAAWd,SAASe,cACpBC,EAAa,EACbC,EAAe,GACfC,EAAS,EACb,MAAMC,EAAc,CAClB,GAAI,CACFC,SAAU,WACR,IAAIC,EAAKC,KAAK/B,KACVgC,EAAQD,KAAKC,OAAS,GACtBC,EAAOD,EAAMF,EAAGI,UAAY,WAChC,IAAKD,EAAM,MAAO,OAClB,IAAKF,KAAK/B,KAAKmC,QAAS,MAAO,OAC/B,IAI0BC,EAJtBC,EAAM,YAAaP,EAAMC,KAAKO,IAAIR,EAAGS,SAAS1D,MAAQ,GACtD2D,EAAM,YAAaV,EAAMC,KAAKO,IAAIR,EAAGK,SAAStD,MAAQkD,KACtDU,EAAKV,KAAK/B,KAAK0C,OACfC,EAAOH,GAAMP,GAAUD,EAAMY,OAASZ,EAAMY,MAAMC,MAAS,CAAEA,KAAM,gBACnE1D,EAAM2C,EAAGgB,QACRC,MAAMC,QAAQR,KAAKA,EAAK,CAACA,IAC1BR,EAAMiB,QAAQlB,KAAKmB,MAAM,EAAGlB,EAAMiB,OAAOE,OAASnB,EAAMiB,OAAOZ,GAAML,EAAMiB,OAAOJ,MACtF,IAAIO,EAAKrB,KAAKsB,GAAGC,MAAQ,GACzBjB,EAAGkB,SAAWH,EACd,IAAK,IAAIxF,EAAI,EAAGA,EAAI4E,EAAG3B,OAAQjD,IAAK,CAClC,IAAIkB,SAAY0D,EAAG5E,GACf4E,EAAG5E,KAAIwE,OAAapB,IAAR7B,EAAoBqD,EAAG5E,GAAG4F,QAAUhB,EAAG5E,GAAGuB,IACtDsD,QAAazB,IAAPoB,GAA0B,WAANtD,IAAgBsD,EAAKd,EAAGmC,YAAYjB,EAAG5E,GAAI,UAAW,IAAM+D,MAC1F,IAAI+B,EAAMf,EAAIQ,OAASR,EAAIQ,OAAOX,EAAG5E,GAAIA,EAAGyE,GAAMM,EAAIE,KACtDd,KAAKmB,KAAKd,GAAMxE,EAAG8F,UAEdrB,EAAGkB,SACNvB,EAAM2B,QAAQ5B,KAAKmB,MAAM,EAAGlB,EAAM2B,OAAOR,OAASnB,EAAM2B,OAAOtB,GAAML,EAAM2B,OAAOd,SAK5F,SAASe,IAAcC,QAAQC,MAAMC,WACrC,SAASC,IAAyC,MAA1BH,QAAQC,MAAMC,WAAkBE,MAAM,cAC9D,SAASC,EAAWC,EAAI9E,GAA0B,OAArB8E,EAAG9E,GAAK8E,EAAG9E,IAAM,GAAW8E,EAAG9E,GAK5D,SAAS+E,EAAKC,GAIZ,IAHA,IAAInG,EAAKmG,GAAO5D,SACZ/B,EAAI,GACJ4F,EAAOpG,EAAEqG,iBAAiB,4BACrB3G,EAAI,EAAGA,EAAI0G,EAAKzD,OAAQjD,IAC/B,IAAK0G,EAAK1G,GAAG4G,KAAM,CACjB,IAAIC,EAAKC,EAAUJ,EAAK1G,GAAIM,EAAEsG,MAC9BG,EAAUF,EAAI,SACVA,GAAIA,EAAGG,UACXlG,EAAEmG,KAAKJ,GAGX,OAAO/F,EAGT,SAASoG,EAAaC,EAAS9G,GAC7B,IACE,IAAI+G,EAAO/G,EAAEgH,aAAa,QACtBC,EAAOF,EAAKG,MAAM,eAAgBD,EAAOA,EAAOA,EAAK,GAAK,GAC9D,IAAIE,EAAQnH,EAAEoH,UAAUC,OACpBC,EAAQR,EAAQQ,MAAQR,EAAQQ,OAAS,GAE7C,GAAIH,EACF,OAAQJ,EAAK3E,MAAM,KAAK,GAAGiF,QACzB,IAAK,cAAepB,EAAUa,EAAS,WAAW9G,EAAEgH,aAAa,SAAW,WAAa,IAAIO,SAASN,EAAME,GAAQ,MACpH,IAAK,gBAAiBlB,EAAUa,EAAS,aAAa9G,EAAEgH,aAAa,SAAW,WAAa,IAAIO,SAASN,EAAME,GAAQ,MACxH,IAAK,gBAAiBnH,EAAEwH,WAAa,IAAID,SAASN,EAAME,GAAQ,MAChE,IAAK,gBAAiBnH,EAAEwH,WAAaC,EAAeR,EAAME,GAAQ,MAClE,QACE,IAAI1F,EAAIsF,EAAK3E,MAAM,WAAW,GAC9B,GAAIX,EAAG,CAAE,IAAM0F,EAAQO,KAAKC,MAAMR,GAAS,MAAOS,IAAiC,OAAzBN,EAAM7F,EAAE4F,QAAUF,GAAc,EAC1FxB,EAAS,yBAA0BoB,IAIzC,MAAOa,GAAOjC,EAAS,kCAAmCwB,GAASnH,EAAE+G,KAAM/G,EAAG4H,IAGlF,SAASnB,EAAWoB,EAAIC,GACtB,IAAKD,EAAI,OAAO,KAChB,IAAIE,EAAWF,EAAGb,aAAa,QAC/B,IACE,IAAIF,EA+BR,SAAwBe,GAGtB,IAFA,IAAIf,EACAkB,EAAWH,EAAGI,WACTtI,EAAI,EAAGA,EAAIqI,EAASpF,OAAQjD,IAAK,CACxC,IAAIuI,EAAOF,EAASrI,GAChByB,EAAI8G,EAAKhI,KAAO,GACpB,GAA4B,IAAxBkB,EAAE+G,QAAQ,UAAiB,CAC7BrB,EAAUA,GAAW,GACrB,IAAIsB,EAAMF,EAAKtH,MACXyH,EAAMjH,EAAE,GACRkH,EAAKF,EAAIhG,MAAMiG,EAAMA,GAAMD,EAAME,EAAG,GAAIA,EAAKA,EAAG,GACpD,IAAI7G,EAAIL,EAAEmH,UAAU,GAChBtI,EAAIuI,EAAqB/G,EAAG2G,GAChC,IAAMA,EAAMV,KAAKC,MAAMS,GAAO,MAAOR,IAChC3H,EAA8CgG,EAAUa,EAAS,QAAQrF,GAAKxB,EAA3EgG,EAAUa,EAAS,SAASrF,GAAK2G,EACrCE,IAAIrC,EAAUa,EAAS,UAAUrF,GAAK6G,QACrC,GAA2B,IAAvBlH,EAAE+G,QAAQ,SAAgB,CACnC,IAAIM,EAAMrH,EAAEmH,UAAU,GAEtBtC,EADAa,EAAUA,GAAW,GACF,aAAa2B,GAAOP,EAAKtH,OAGhD,OAAOkG,EArDS4B,CAAcb,GACxBc,EAAUd,EAAGe,WAAU,GAC3B,GAAID,IACF7B,EAAUA,GAAW,GACjB6B,EAAQE,UACV,IAAK,IAAIlJ,EAAI,EAAGA,EAAIgJ,EAAQE,SAASjG,OAAQjD,IAAK,CAChD,IAAIoE,EAAQkC,EAAUa,EAAS,SAC3B9G,EAAI2I,EAAQE,SAASlJ,GACrBmJ,EAAK9I,EAAEgH,aACPkB,EAAQY,GAAMA,EAAGhJ,KAAKE,EAAG,cAAiB,UAC9C,GAAmB,WAAfA,EAAE+I,UAAqD,IAA5B/I,EAAE+G,KAAKoB,QAAQ,WACxCtB,EAAYC,EAAS9G,GAD3B,CAGA,IAAIgJ,EAAKjF,EAAMmE,GAAQnE,EAAMmE,IAAS,GACtCc,EAAGpC,KAAK5G,GACRgJ,EAAGpE,MAAQoE,EAAGpE,MAAQ,KAAOkE,EAAK9I,EAAEgD,UAAYhD,EAAE+B,MAC5C,OAAQiH,IAAKA,EAAGnB,GAAK7H,KACrB,WAAYgJ,IAAOhJ,EAAEwH,aAAYwB,EAAG9D,OAASlF,EAAEwH,aAK3D,OAAOyB,EAAMpB,EAAIE,EAAUjB,EAASgB,GACpC,MAAOF,GACPjC,EAAS,2BAA4BoC,EAAUF,EAAID,GAErD,OAAO,KAGT,SAASlB,EAAWH,EAAM2C,GAAM,OAAO3C,EAAK4C,WAAa5C,EAAK4C,UAAUD,IAAO3C,EAAK4C,UAAUD,GAAIpJ,KAAKyG,GA2BvG,SAASiC,EAAsBY,EAAGC,GAChC,GAAa,MAATA,EAAE,GAAY,OAAO,EACzB,IAAI3H,EAAI2H,EAAEjH,MAAM,KAChB,MAAO,CAAEkH,KAAM5H,EAAE,GAAI6H,SAAW7H,EAAEkB,OAAS,EAAK,IAAMlB,EAAE,IAY1D,SAASuH,EAAOpB,EAAI3H,EAAMsJ,EAAW1B,GACnC0B,EAAYA,GAAa,GACpB7F,EAAYzD,IAAO6F,EAAU,0BAA2B7F,GAG7D,IAAIuJ,EAAc9F,EAAYzD,GAC1BqG,EAAO,IAAInD,EAAKsG,IAAI7B,EAAI4B,EAAaD,GAKzC,GAJAjD,EAAKrG,KAAOA,EACZ2H,EAAG8B,aAAa,aAAc,WAG1BpD,EAAKqD,UAAW,CAClB,IAAIC,EAAK,GACLC,EAAKvD,EAAKqD,UACd,IAAK,IAAIR,KAAKU,EAAI,CAChBD,EAAGjD,KAAKwC,GACR,IAAId,EAAKc,EAAEhH,MAAM,KACb2H,EAAIzB,EAAG,GACN7E,EAAasG,KAChBtG,EAAasG,GAAKC,EAAgBD,GAClCvH,SAASyH,iBAAiBF,EAAGtG,EAAasG,IAAI,IAEhDD,EAAGC,GAAKD,EAAGV,GACO,SAAdU,EAAGxB,EAAG,MAAgBwB,EAAGC,GAAGG,UAAW,GAE7C3D,EAAKqD,UAAYC,EAGnB,OAAOtD,EAGT,SAASyD,EAAiBjD,GACxB,OAAO,SAAUoD,GAIf,IAHA,IAA4E3D,EAuB9D4D,EAvBVvC,EAAMsC,EAAME,QAAUF,EAAME,OAAOC,gBAAmBH,EAAMI,OAC5DC,EAAS,QAAUzD,EACnB0D,EAAW,GACR5C,GAAI,CACT,GAAIA,EAAGb,aAAc,CACnB,IAAI0D,EAAU7C,EAAGb,aAAawD,GACzBE,IACHA,EAAU7C,EAAGb,aAAawD,EAAS,YACtBE,EAAQC,MAAO,GAE1BD,GAASD,EAAS7D,KAAK8D,EAAQrD,QACnC,IAAId,EAAOsB,EAAGtB,KAEd,GADK4D,EAAM5D,OAAM4D,EAAM5D,KAAOA,GAC1BA,GAAQkE,EAAS7H,OACnB,IAAK,IAAIjD,EAAI,EAAGA,EAAI8K,EAAS7H,OAAQjD,IAAK,CACxC,IAAI2I,EAAKmC,EAAS9K,GACdiL,EAAKtC,EAULrB,GAHEmD,YAGeQ,EAHD1D,MAAM,iBACLkD,EAAQ,IAAO,IAGpC,GAAInD,EAAM,CACRA,EAAOA,EAAK7E,MAAM,KAClBwI,EAAKA,EAAGxI,MAAM,KAAK,GACnB,IAAIyI,EAAM5D,EAAKkB,QAAQ,UACnB0C,GAAO,IAAG5D,EAAK4D,GAAOV,GAE5B,IAA0BW,EAAtBC,EAAIxE,EAAKlC,IAAIuG,GACjB,QAAgB7H,IAAZgI,EAAEnK,QACAoK,EAAWD,EAAEnK,OAAQkK,EAAOC,EAAEnK,MAAMsB,MAAM6I,EAAE/I,IAAKiF,GAAQ,CAACkD,IACzD5D,EAAKlC,IAAIuG,EAAI3D,EAAK,IACV,SAAT6D,GAAmBxC,EAAGqC,MAAM,OAItC,IAAIM,EAAK1E,GAAQA,EAAKrG,KACtB,GAAIyD,EAAYsH,KACdzE,EAAK7C,EAAYsH,IACVrB,WAAapD,EAAGoD,UAAU7C,KACc,SAAzCP,EAAGoD,UAAU7C,GAAMjH,KAAKyG,EAAM4D,IAAqB3D,EAAGoD,UAAU7C,GAAMmD,UAAY,OAI5FrC,EAAKA,EAAG5E,aAqBd,SAAS+H,EAAYhJ,GAAO,SAAUA,GAAOA,EAAIC,aAAeD,EAAIlC,MAAQkC,EAAIE,OAChF,SAASgJ,EAAUC,EAAK9B,GAAK,IAAKvE,MAAMC,QAAQoG,GAAM,OAAOA,EAAiB,IAAZ,IAAI/K,EAAI,GAAaT,EAAI,EAAGA,EAAIwL,EAAIvI,OAAQjD,IAAKS,EAAE+K,EAAIxL,IAAOmG,UAAUlD,QAAU,GAAWyG,EAAI,OAAOjJ,EAC1K,SAASgL,EAAKhL,EAAGkH,EAAO+D,EAAIC,GAC1B,IAAK,IAAI3L,EAAI,EAAGA,EAAI2H,EAAM1E,OAAQjD,IAAK,CACrC,IAAI8B,EAAI6F,EAAM3H,QAEHoD,KADDtB,KAAK6J,EAAMA,EAAG7J,GAAK4J,EAAG5J,MAEhCrB,EAAEqB,GAAK4B,EAAGkI,MAAMF,EAAG5J,GAAI6J,EAAG7J,MAO9B,SAAS+J,EAAQC,EAAQC,EAAOC,GAC9BD,EAAQA,GAAS,GACjBC,EAAaA,GAAc,GAC3B,IACIC,EAAI9H,KAAKsB,GAAK,GAClBgG,EAAIQ,EAAG,CAAC,WAAY,SAAU,QAASF,EAAOC,GAC9CP,EAAItH,KAAM,CAAC,UAAW,YAAa,YAAa,SAAU,aAAc4H,EAAOC,GAC3E,WAAYD,IAAO5H,KAAK+H,OAASH,EAAMG,SACvCH,EAAMI,QAAUH,EAAWG,UAAQF,EAAEE,OAASzI,EAAG0I,OAAO,GAAIb,EAASQ,EAAMI,QAASH,EAAWG,UAC/FJ,EAAMM,YAAcL,EAAWK,cAAYJ,EAAEI,WAAa3I,EAAG0I,OAAO,GAAIb,EAASQ,EAAMM,YAAad,EAASS,EAAWK,eACxHN,EAAM3H,OAAS4H,EAAW5H,QAAOV,EAAG0I,OAAO9F,EAAUnC,KAAM,SAAU4H,EAAM3H,MAAO4H,EAAW5H,OAC7F,UAAW2H,IAAO5H,KAAKmI,MAAQtI,EAAY+H,EAAMO,QAErD,IAAIC,EAAKpI,KAAKqI,QAAS,GAAID,EAAI,IAAK,IAAI9C,KAAK8C,EAAIA,EAAG9C,GAAK4B,EAAWkB,EAAG9C,IAAM8C,EAAG9C,GAAGjI,KAV1E2C,MAUqFoI,EAAG9C,GAEjGtF,KAAK2H,OAASA,EACdA,EAAOlF,KAAOzC,KACd8H,EAAEQ,KAAOZ,EAAOjK,UAAU8K,MAAMlL,KAdvB2C,MAeT,IAAID,EAAKC,KAAK/B,KAAOsB,EAAGiJ,QAAQ,GAAIV,EAAEQ,MAGtC,IAAKhD,KAFL/F,EAAG0I,OAAOlI,EAAI+H,EAAEI,WAAYN,EAAM3J,KAAM4J,EAAWrE,OAEzCsE,EAAEzK,KAAMoL,EAAWzI,KAAM,QAAUsF,EAAGwC,EAAEzK,KAAKiI,GAAGG,SAAUqC,EAAEzK,KAAKiI,GAAGE,MAG9E,OAFAjG,EAAGiJ,QAAQzI,GACXC,KAAK0I,IAAM,IAAMhJ,IACVM,KAiBT,SAAS2I,EAAWrM,GAAK,IAAIsB,EAAI,GAAI,IAAK,IAAI0H,KAAKhJ,EAAKsB,GAAK,OAAS0H,EAAI,KAAQ,OAAO1H,EAgDzF,SAASgL,EAAUC,EAAUC,EAAKxJ,GAChC,IAAI8C,EAAKpC,KAEL+I,GADJzJ,EAAOA,GAAQ,IACAyJ,KAAO,IAAIC,eAc1B,OAXAD,EAAIE,QAAU,SAAUnF,GAAOhC,QAAQoH,IAAI,iBAAkBpF,GAAMqF,EAAK/G,EAAGuF,OAAQ,mBAAoB,CAAEmB,IAAKA,KAC9GC,EAAIK,OAAS,SAAU5E,GACrB,GAAoB,MAAhBxE,KAAKqJ,OAAgB,CACvB,IAAIC,EAAMtJ,KAAKuJ,SACf,IAAMD,EAAM1F,KAAKC,MAAMyF,GAAO,MAAOxF,IACjCxE,EAAKkK,WAAUF,EAAME,EAASF,IAClClH,EAAG7B,IAAIsI,EAAUS,QACRtJ,KAAKqJ,QAAQN,EAAIE,QAAQzE,IAEtCuE,EAAIU,KAAKnK,EAAKoK,QAAU,MAAOZ,GAAK,GACpCC,EAAIY,KAAK,MACFZ,EAET,SAASa,EAAUf,EAAUC,GAC3B,IAAI1G,EAAKpC,KACT,GAA4B,YAAxBtB,SAASmL,WAA0B,CACrC,IAAIzI,EAAS1C,SAASoL,cAAc,UACpC1I,EAAO2I,IAAMjB,EACbpK,SAASG,qBAAqB,QAAQ,GAAGmL,YAAY5I,QAErD1C,SAASuL,MAAM,gBAAkBnB,EAAM,cAEvC1H,GADAA,EAAS1C,SAASG,qBAAqB,WACvBuC,EAAOtC,OAAS,GAKlC,OAHAsC,EAAO6H,QAAU,SAAUnF,GAAOhC,QAAQoH,IAAI,mBAAoBpF,GAAM1C,EAAOjC,WAAWC,YAAYgC,GAAS+H,EAAK/G,EAAGuF,OAAQ,mBAAoB,CAAEmB,IAAKA,KAC1J1H,EAAOpC,OAAS,SAAUf,GAAQmE,EAAG7B,IAAIsI,EAAU5K,IAC9CS,SAASC,gBAAeb,OAAOc,UAAYwC,GACzCA,EAGT,SAAS8I,EAAeC,EAAQC,GAC9B,IAAIC,EAAKD,EAAS9L,MAAM,KACpBgM,EAAK/J,EAAI4J,EAAQE,GACrB,GAAIC,EAAGpM,IAAK,OAAOoM,EAEnB,IADA,IAAIC,EAAKH,EAAS9L,MAAM,KAAUkM,EAAKL,EAC9BtO,EAAI,EAAGA,EAAI0O,EAAGzL,OAAQjD,IAAK,CAClC,IAAI4O,EAAKD,EAAGD,EAAG1O,IAAS4O,SAAmD,iBAAT,IAAmBD,EAAGD,EAAG1O,IAAOA,GAAK0O,EAAGzL,OAAS,OAAIG,EAAY,IAAKuL,EAAKA,EAAGD,EAAG1O,IAErJ,OAAO0E,EAAI4J,EAAQE,GAcrB,SAAS5B,EAAYrG,EAAIsI,EAAUC,EAAKP,EAAUQ,GAChD,IAAIT,EAAQG,EACZK,EAAMA,GAAO,IACb,IACIE,EAAK1I,EADDC,EAAGd,GACW,QAClBwJ,EAAM3I,EAAU0I,EAAIH,GAExB,GADAN,EAAWA,GAAYM,EACnBI,EAAIJ,WAAaA,GAAYI,EAAIrF,WAAakF,GAAOG,EAAItF,OAAS4E,EAAtE,CACA,OAAQO,EAAI,IACV,IAAK,IACHL,EAAKJ,EAAc9H,EAAIgI,GACvB,MACF,IAAK,IACL,IAAK,IACL,IAAK,IACH,IAAIrG,GAAM6G,GAAUlM,UAAUqM,cAAcJ,IAC5CR,EAASpG,GAAMA,EAAGtB,OACLR,EAAU,kCACvBqI,EAAKJ,EAAcC,EAAQC,GAC3B,MACF,QACE,IAAIY,EAAML,EAAIrM,MAAM,KAEpB,OADAuM,EAAGH,GAAY,CAAEA,SAAUA,EAAUjF,SAAUkF,EAAKnF,KAAM4E,GAClDY,EAAI,IACV,IAAK,OACL,IAAK,OACL,IAAK,WAAYpC,EAAS5M,KAAKoG,EAAIsI,EAAUM,EAAI,IAAK,MACtD,IAAK,OAAQpC,EAAS5M,KAAKoG,EAAIsI,EAAUM,EAAI,GAAI,CAAExB,UAAU,IAAS,MACtE,IAAK,QAASwB,EAAI,GAvC1B,SAAgBC,EAAK7I,EAAIsI,GAEvB,GADUO,EAAI5G,QAAQ,WACZ,EAAG,OAAO4G,EACpB,IAAIC,EAAQ,YAAcxL,IAK1B,OAJA5B,OAAOoN,GAAS,SAAUjN,GACxBmE,EAAG7B,IAAImK,EAAUzM,UACVH,OAAOoN,IAETD,EAAIE,QAAQ,UAAWD,GA+BDE,CAAMJ,EAAI,GAAI5I,EAAIsI,GACzC,IAAK,KAAMd,EAAS5N,KAAKoG,EAAIsI,EAAUM,EAAI,IAAK,MAChD,QACE/I,EAAU,sBAAwByI,EAAW,KAAOC,GAGxD,GADAL,EAAKJ,EAAc9H,EAAIgI,GACnBA,IAAaM,EAAU,OAM/B,IAAIW,EAAKnB,EAAc9H,EAAIsI,GACtBW,EAAGnN,KAAK+D,EAAU,wBAA0ByI,GACjD,IAOIpC,EAAO/I,EAAG+L,MAAMD,EAAGnN,IAAKmN,EAAG7F,KAAM8E,EAAGpM,IAAKoM,EAAG9E,MAPxC,SAAU+F,GACXnJ,EAAGuF,QAAUvF,EAAGuF,OAAO6D,gBAAkB9M,SAI9C0D,EAAGmG,MAAMgD,GAHPnJ,EAAGqJ,aAMPZ,EAAGH,GAAY,CAAEA,SAAUA,EAAUjF,SAAUkF,EAAKnF,KAAM4E,EAAUE,GAAIA,EAAIoB,MAAOpD,IAUrF,SAASqD,IACP/I,EAAU5C,KAAM,gBAChB,IAAIjD,EAAI,IAAI6O,KACRC,EAAM7L,KAAK2H,OACf,GAAKkE,GAAOA,EAAIL,gBAAkB9M,SAAlC,CAIA,IAAIoB,EAAWE,KAAKsB,GAAGxB,SACvB,GAAIA,EAAU,CACZ,IAAIgM,EAAK9L,KAAKsB,GAAGyK,SACbD,GAAI9L,KAAKgM,YACbF,EAAK9L,KAAKsB,GAAGyK,SACb,IAAIzC,EAAMxJ,EAAS9D,KAAKgE,KAAMA,KAAKC,QAAU,GACzCD,KAAKsB,GAAG2K,KAAMjM,KAAKkM,UACG,iBAAV,EACF,SAAR5C,IAAgBuC,EAAIvI,UAAYgG,IAEpCuC,EAAIvI,UAAY,GACZtC,MAAMC,QAAQqI,GAAMA,EAAI6C,SAAQ,SAAUlG,GAAK4F,EAAI7B,YAAY/D,MAC9D4F,EAAI7B,YAAYV,IAEnBuC,EAAI1M,WAAWiN,UAAUC,SAAS,eAAgBR,EAAMA,GAC5DxJ,EAAIwJ,GACAA,EAAI1M,WAAWiN,UAAUC,SAAS,cAAgBvK,QAAQoH,IAAI,SAAU,IAAI0C,KAAS7O,GAE3F6F,EAAU5C,KAAM,oBArBdA,KAAKyL,UA2BT,SAASa,IACP,GAA2B,IAAvBtM,KAAKsB,GAAGiL,WAAZ,CACA,IAAI5B,EA4RN,SAAwBhD,GACtB,IAAI6E,EAAM9N,SAAS+N,cACnB,GAAID,EAIF,IAHA,IAAIE,EAAgBF,EAAIG,eACpBC,EAAcJ,EAAIK,aAClBC,EAAU,GACPN,GAAOA,IAAQ7E,GAAU6E,EAAIrN,YAClC2N,EAAQhK,MARUiK,EAQSP,EARM,GAAGnI,QAAQrI,KAAK+Q,EAAK5N,WAAW6N,WAAYD,KAS7EP,EAAMA,EAAIrN,WAThB,IAAwB4N,EAYtB,OAAO,WACL,GAAIP,EAAK,CAEP,IADAA,EAAM7E,EACC6E,GAAOM,EAAQhO,QAAQ,CAC5B,IAAImO,EAAMH,EAAQI,MAClBV,EAAMA,EAAIQ,WAAWC,GAEvB,GAAIT,EAAK,CACHA,EAAIW,OAAOX,EAAIW,QACnB,IACEX,EAAIG,eAAiBD,EACrBF,EAAIK,aAAeD,EACnB,MAAO9I,QAnTLsJ,CAAcpN,KAAK2H,QAC7BgE,EAAO3P,KAAKgE,MACZ2K,IACA3K,KAAKsB,GAAGiL,WAAa,GAEvB,SAASc,EAAgBtJ,GACvB,OAAQA,EAAGkB,UACT,IAAK,QAAS,OAAQlB,EAAGiJ,YAAcjJ,EAAGiJ,WAAW,IAAOjJ,EAC5D,QAAS,OAAOA,GAGpB,SAASuJ,EAAMrC,GAEb,IADA,IAAIqC,EAAO,EAAOC,EAAMtC,EAAInM,OACnBjD,EAAI,EAAGA,EAAI0R,EAAK1R,IACvByR,EAAc,GAAPA,EAAYrC,EAAIuC,WAAW3R,GAClCyR,GAAcA,EAEhB,OAAOA,EAiET,SAASG,EAAWvR,EAAGoB,GACrB,OAAIpB,EAAE+I,WAAa3H,EAAE2H,UA5BvB,SAASyI,EAAcxR,EAAGoB,GACxB,GAAmB,IAAfpB,EAAEyR,UAAiC,IAAfrQ,EAAEqQ,SAExB,OADAzR,EAAE0R,UAAYtQ,EAAEsQ,WACT,EAET,GAAK1R,EAAE+I,WAAa3H,EAAE2H,WArBxB,SAAyB/I,EAAGoB,GAC1B,IAGE,IAFA,IAAgBuQ,EAAZC,EAAI,GACJC,EAAKzQ,EAAE6G,WAAgB6J,EAAMD,EAAGjP,OAC3BjD,EAAI,EAAGA,EAAImS,EAAKnS,IACXiS,GAAZD,EAAKE,EAAGlS,IAASO,OAAQ,EACrBF,EAAEgH,aAAa2K,EAAGzR,QAAUyR,EAAG/Q,OAAOZ,EAAE2J,aAAagI,EAAGzR,KAAMyR,EAAG/Q,OAEvE,IAAImR,EAAK/R,EAAEiI,WAAgB+J,EAAMD,EAAGnP,OACpC,GAAIoP,IAAQF,EAAK,OAAO,EACxB,IAAKnS,EAAI,EAAGA,EAAIqS,EAAKrS,IACHiS,GAAhBD,EAAKI,EAAGpS,IAAaO,OACrBF,EAAEiS,gBAAgBN,EAAGzR,MAEvB,MAAO0H,GAAO,OAAO,GAQjBsK,CAAelS,EAAGoB,GAAK,OAAO,EACpC,GAAIpB,EAAE8Q,WAAWlO,QAAUxB,EAAE0P,WAAWlO,OAAQ,CAK9C,IAJA,IAAIjD,EACAwS,EAAKnS,EAAE8Q,WACPvC,EAAKnN,EAAE0P,WACPsB,EAAKzS,EAAI0S,KAAKC,IAAIH,EAAGvP,OAAQ2L,EAAG3L,QAC7BwP,EAAKD,EAAGvP,QAAQ5C,EAAEkD,YAAYiP,EAAGxS,IACxC,KAAOyS,EAAK7D,EAAG3L,QAAQ5C,EAAE8N,YAAYS,EAAG6D,MACxC,OAASzS,GAAK,GAAG,CACf,IAAI4S,EAAMJ,EAAGxS,GACT6S,EAAMjE,EAAG5O,GACQ,IAAjB4S,EAAId,UAAmC,IAAjBe,EAAIf,SAC1Bc,EAAIE,YAAYD,IAChBD,EAAIxJ,WAAayJ,EAAIzJ,UAAayI,EAAae,EAAKC,IACtDxS,EAAE0S,aAAaF,EAAKD,GAH8BA,EAAIb,YAAcc,EAAId,YAAWa,EAAIb,UAAYc,EAAId,YAO7G,OAAO,EAI2BF,CAAaxR,EAAGoB,GAI3CpB,GAHLA,EAAEiD,WAAWyP,aAAatR,EAAGpB,GACtBoB,GAyHX,SAASuR,EAAS5L,EAAM6L,GACtBtP,EAASuP,WAAW9L,GACpB,IAAIc,EAAKvE,EAASwP,yBAAyBF,GAC3C,MAAyB,UAAlB7L,EAAKgC,SAAuBlB,EAAGiJ,WAAW,GAAKjJ,EAwDxD,SAASxD,EAAKrC,EAAKqG,GACI,iBAAV,IAAoBA,EAAMA,EAAIjG,MAAM,MAE/C,IADA,IAAIxC,EAAIyI,EAAIzF,OACHjD,EAAI,EAAGA,EAAIC,EAAGD,IAAK,CAC1B,IAAIyJ,EAAIf,EAAI1I,GAAQS,EAAI4B,EACxB,MAD6BA,EAAM5B,EAAEgJ,KACP,iBAAV,KAAyBzJ,EAAI,EAAIC,KAASwJ,KAAKhJ,IAAM,MAAO,CAAE2S,KAAM,CAAE/Q,IAAK5B,EAAGkJ,KAAMF,IAE1G,MAAO,CAAExI,MAAOoB,EAAKA,IAAK5B,EAAGkJ,KAAMF,GAuDrC,IAAI4J,EACJ,SAAS1F,EAAUyB,GACjB,GAAqB,iBAAV,EAAoB,CAC7B,IAAK,IAAI3F,KAAK2F,EACZ,cAAgBA,EAAI3F,IAClB,IAAK,SACL,IAAK,SACH2F,EAAI3F,GAAK2F,EAAI3F,GAAKkE,EAASyB,EAAI3F,IAAM2F,EAAI3F,GAI/C,OAAO2F,EAIT,OAFAiE,EAAOA,GAAQxQ,SAASoL,cAAc,QACjCqF,YAAclE,EACZiE,EAAK5L,UAEd,SAAS6F,EAAMpF,EAAIS,EAAI+B,GACDA,EAASA,GAAU,IAAvCxC,EAzlBF,SAASqL,EAAWrL,EAAIsL,GAAO,MAAoB,iBAAT,EAA0BtL,EAAWqL,EAAUC,GAAO3Q,UAAUqM,cAAchH,GAylBjHqL,CAAUrL,MACLwC,EAAOC,eAAiBzC,GAClCrF,SAAS4Q,cAAc,IAAIC,YAAY/K,EAAI,CAAE+B,OAAQA,KAGvD,SAASiJ,EAAOzQ,GACc,aAAxBL,SAASmL,YACc,YAAxBnL,SAASmL,aAA6BnL,SAAS+Q,gBAAgBC,SAChE3Q,IAEAL,SAASyH,iBAAiB,mBAAoBpH,GA1jBlD2I,EAAOjK,UAAUgO,QAAU,WACzB7I,EAAU5C,KAAM,WAChB,IAAI8H,EAAI9H,KAAKsB,IAAM,GAEnB,GADA/B,EAAGoQ,UAAU3P,KAAK/B,KAAM6J,EAAEQ,MACtBR,EAAEzK,KACJ,IAAK,IAAIiI,KAAKwC,EAAEzK,KAAM,CACpB,IAAIuS,EAAI9H,EAAEzK,KAAKiI,GACXsK,EAAEtH,MAAM/I,EAAGoQ,UAAUC,EAAEtF,GAAGpM,IAAK0R,EAAEtH,QAS3CZ,EAAOjK,UAAU8K,MAAQ,SAAUsH,GACjCA,EAAQpN,KAAOzC,KACf,IACIqJ,EADAvB,EAAI9H,KAAKsB,GAET3D,EAAIkS,EAAQC,KACZC,EAAO/P,KAAKgQ,UACZC,EAAMnI,EAAEE,OACRkI,EAAKpI,EAAEqI,OAASrI,EAAEqI,SAAYJ,EAAOpH,EAAUoH,GAAQ,KAAOE,EAAMtH,EAAUsH,GAAO,IACzF,GAAIC,EAAI,CACN,IAAIjF,EAAM,UAAY4E,EAAQO,KAAkDjF,QAAQ,MAAO,qBAAuB,cAClHkF,EAAO,IAAIC,OAAOrF,EAAK,KACvBhP,EAAIiU,EAAG9M,MAAMiN,GACjB,GAAIpU,EAAG,CAEL,IADA,IAAIsU,EAAKtU,EAAE,GACFJ,EAAI,EAAGA,EAAII,EAAE6C,OAAQjD,IAASI,EAAEJ,GAAGiD,OAASyR,EAAGzR,SAAQyR,EAAKtU,EAAEJ,IACvE8B,EAAI4S,EAAG9L,UAAU,EAAG8L,EAAGzR,OAAS,IAGpC,IAgBI0R,EAhBAC,EAAKV,GAAQA,EAAKpS,GACtB,GAAI8S,EACF,GAAIvJ,EAAWuJ,GAAKpH,EAASoH,EAAGzU,KAAKgE,KAAM6P,QAEzC,IAAKA,EAAQO,OAA4B,QAAnBP,EAAQa,QAAuC,QAAnBb,EAAQa,QAAmB,CAC3E,IAAIpU,EAAI0D,KAAKO,IAAIkQ,GACbvJ,EAAW5K,EAAEQ,OAAQR,EAAEQ,MAAMd,KAAKgE,MACjC1D,EAAE4B,IAAI5B,EAAEkJ,MAAQqK,EAAQ/S,MAInC,GAAImT,GAAOA,EAAItS,GAAI,CACjB,IAAIsI,EAAI6B,EAAE1L,KAAO,MAAkB,IAAX6T,EAAItS,GAAcA,EAAIsS,EAAItS,IAClDwL,EAAKnJ,KAAK2H,OAAQ1B,EAAG4J,GAIvB,GAAIA,EAAQ/S,QAAU+S,EAAQc,KAA9B,CACI3Q,KAAK4Q,SAAQJ,EAAUxQ,KAAK4Q,OAAO5Q,KAAM6P,IAC7C,IAAI9P,EAAK+H,EAAEI,WACNlI,KAAK0I,MACK,SAAXW,GAAiC,SAAZmH,GAAwBzQ,IAAQA,EAAGpC,IAAOoC,EAAGwQ,KAAOvQ,KAAKsM,cAEpF5E,EAAOjK,UAAU+K,QAAU,SAAUlD,EAAGvG,GAAeoD,EAAUnC,KAAM,aAAiBsF,GAAKvG,EAAIiB,KAAKsB,GAAGuP,MAAQ,MACjHnJ,EAAOjK,UAAUqT,SAAW,SAAUxL,EAAGyL,GAAgB5O,EAAUnC,KAAM,cAAkBsF,IAAc,IAARyL,GAAyB,IAARA,GAClHrJ,EAAOjK,UAAUuK,OAAS,SAAU1C,EAAGyL,GAAgB5O,EAAUnC,KAAKsB,GAAI,UAAcgE,IAAc,IAARyL,GAAyB,IAARA,GAAaA,EAAM/Q,KAAKsB,GAAG0P,KAAO,MACjJtJ,EAAOjK,UAAUwT,MAAQ,SAAU3L,EAAGhJ,GAAK0D,KAAK/B,KAAKqH,GAAKhJ,EAAG0D,KAAK/B,KAAKiT,eACvExJ,EAAOjK,UAAUJ,KAAO,SAAUiI,EAAGqF,EAAKwG,EAAO9B,GAAO5G,EAAWzI,KAAMsF,EAAGqF,EAAKwG,EAAO9B,IACxF3H,EAAOjK,UAAU0L,KAAO,SAAU3E,EAAI+B,GAAU4C,EAAKnJ,KAAK2H,OAAQnD,EAAI+B,IAmHtEmB,EAAOjK,UAAUoF,QAAU8I,EAC3BjE,EAAOjK,UAAUkO,OAAS,WACxBpM,EAAG6R,KAAKpR,KAAK0I,IAAM,MAAO1I,KAAM2L,IA8BlCjE,EAAOjK,UAAU6O,SAAW,WAC1BtM,KAAKsB,GAAGiL,YAAcvM,KAAKsB,GAAGiL,YAAc,GAAK,EACjDhN,EAAG6R,KAAKpR,KAAK0I,IAAM,MAAO1I,KAAMsM,GAAU,IAuB5C5E,EAAOjK,UAAUuO,UAAY,SAAUqF,GAChCrR,KAAKsB,GAAG2K,OAAQoF,IACnBrR,KAAKsB,GAAGC,KAAO,GACfvB,KAAKsB,GAAGgQ,aAAe,GAEzBtR,KAAKsB,GAAG2K,KAAO,GACfjM,KAAKsB,GAAG2K,KAAK9K,KAAO,GACpBnB,KAAKsB,GAAG2K,KAAKsF,QAAU,EACvBvR,KAAKsB,GAAG2K,KAAKuF,KAAO,IAAIC,QACxBzR,KAAKsB,GAAGgQ,cACRtR,KAAKsB,GAAGyK,SAAW,GA6DrBrE,EAAOjK,UAAUiU,WAAa,SAAU3K,EAAK4K,EAAIC,GAC/C,IACIvQ,EADIrB,KAAKsB,GACFC,KACX,GAAKF,EAAL,CACA,IAAIwQ,EAAMvE,EAAKsE,GAGf,IAFAD,EAAK,MAACA,EAAmCE,EAAMF,KACnCtQ,GAAKY,EAAU,iCACvBZ,EAAGsQ,GAAIE,MAAQA,GAAO9K,IAAQ1F,EAAGsQ,GAAI5K,IAAzC,CACA,IAAI+I,EAAOzC,EAAerN,KAAK2H,QAC3BzL,EAAImF,EAAGsQ,GAAI5N,GACV7H,EAAEgH,cACP7B,EAAGsQ,GAAI5N,GAAK0J,EAAUqC,EAAK9C,WAAWjG,GAAM8H,EAAQiB,EAAM8B,GAASE,YACnEzQ,EAAGsQ,GAAIE,IAAMA,EACbxQ,EAAGsQ,GAAI5K,IAAMA,GAHc7K,EAAE0R,YAAcgE,IAAS1V,EAAE0R,UAAYgE,MAMpElK,EAAOjK,UAAUyO,QAAU,WACzB,IAAIpE,EAAI9H,KAAKsB,GACTyQ,EAAQjK,EAAEwJ,YACVU,EAAM,GACNC,EAAKnK,EAAEmE,KACP5K,EAAKyG,EAAEvG,KACX,GAAK0Q,EAAL,CACA,IAAIC,EAAKlS,KAAKsB,GAAGyK,SACb4E,EAAO,KACX,GAAW,IAAPuB,EAGF,OAFAlS,KAAKgM,WAAU,QACfhM,KAAK2H,OAAOrE,UAAY,IAI1B,IAAK,IAAIgC,KADK,IAAVyM,IAAa/R,KAAK2H,OAAOrE,UAAY,IAC3BjC,EAAI,CAChB,IAAI8Q,EAAK9Q,EAAGiE,GACR6M,EAAGC,aAAeL,IAClBI,EAAGpO,IAAIoO,EAAGpO,GAAG5E,WAAWC,YAAY+S,EAAGpO,WACpC1C,EAAGiE,IAGZ,IAAIwK,EAAOzC,EAAerN,KAAK2H,QAC3B0K,EAAM3T,SAASoL,cAAcgG,EAAK7K,UAElCgN,EAAG9Q,OAELkR,EAAMxD,EAAQiB,EAAMmC,EAAG9Q,MACvB8Q,EAAG9Q,KAAO,IAIZ,IADA,IAAImR,EAAM,EACDzW,EAAI,EAAGA,EAAIqW,EAAIrW,IAAK,CAE3B,IAAIK,GADJiW,EAAKF,EAAGpW,IACGkI,GACP+K,EAAIqD,EAAGrD,EACX,GAAmB,iBAAR,EAAkB,CAC3B,IAAIxR,EAAI+U,EAAIrF,WAAWmF,EAAGrD,EAAIwD,IAC9BhV,EAAImQ,EAAUvR,EAAGoB,MACPpB,IACRiW,EAAGpO,GAAK7H,EAAIoB,EACZgV,UAEOxD,IACLjT,GAAKiU,EAAK9C,WAAWlO,OAAQkT,GAAOlD,EACnCqD,EAAGpO,GAAK7H,EAAI2S,EAAQiB,EAAMhB,GAAGgD,YAEpCK,EAAGpL,IAAMlL,EACTsW,EAAGrD,EAAI,GACH5S,IACFiW,EAAGpO,GAAK7H,EACR+V,EAAGT,KAAKT,IAAI7U,EAAGL,GACXK,EAAEiD,aAAe2Q,GAAQ5T,EAAEqW,kBAAoB5B,IAC7CA,EACFb,EAAK0C,aAAatW,EAAGyU,EAAK8B,aAChB3C,EAAK9C,YAAc8C,EAAK9C,WAAW,KAAO9Q,GACpD4T,EAAK0C,aAAatW,EAAG4T,EAAK9C,YAAc8C,EAAK9C,WAAW,KAG5D2D,EAAOzU,GAGX+V,EAAGnT,OAASoT,EAEZ,IAAIQ,EAAM5C,EAAK9C,WAAWlO,OAM1B,IALIkT,GAAKlC,EAAK6C,mBAAmB,YAAaX,IAC9ClC,EAAOzC,EAAerN,KAAK2H,UACfsK,EAAGnT,SAAWgR,EAAK9C,WAAWlO,QACxCgD,QAAQC,MAAM,2DAEXlG,EAAI6W,EAAK7W,EAAIoW,EAAGnT,OAAQjD,IAAOoW,EAAGpW,GAAGkI,GAAK+L,EAAK9C,WAAWnR,GAAIoW,EAAGT,KAAKT,IAAIkB,EAAGpW,GAAGkI,GAAIlI,GACzF,MAAO,SAGT6L,EAAOjK,UAAUmV,YAAc,SAAU7L,GAEvC,OADWsG,EAAerN,KAAK2H,QACnBqF,WAAWjG,IAEzBW,EAAOjK,UAAUoV,UAAY,SAAU9O,GACrC,KAAOA,EAAG5E,aAAea,KAAK2H,QAAQ5D,EAAKA,EAAG5E,WAC9C,OAAO4E,GAET2D,EAAOjK,UAAUqV,UAAY,SAAU/O,GACrC,KAAOA,EAAG5E,aAAea,KAAK2H,QAAQ5D,EAAKA,EAAG5E,WAC9C,IAAIoG,EAAIvF,KAAKsB,GAAG2K,KAAKuF,KAAK9U,IAAIqH,GAC9B,YAAa9E,IAANsG,GAAmB,EAAIA,GA4BhCmC,EAAOjK,UAAU0D,KAAO,SAAUwQ,EAAIC,GAC/B5R,KAAKsB,GAAG2K,MAAMjM,KAAKgM,YACxB,IAK6BmG,EALzBrK,EAAI9H,KAAKsB,GACT2Q,EAAKnK,EAAEmE,KACP5K,EAAKyG,EAAEvG,KACPwF,EAAMe,EAAEiE,WACRgG,EAAQjK,EAAEwJ,YACVO,EAAMvE,EAAKsE,GAEf,GAAIvQ,EADJsQ,EAAK,MAACA,EAAmCE,EAAMF,GACnC,CAKV,IAJAQ,EAAK9Q,EAAGsQ,IACDS,aAAeL,GAAO9P,EAAU,uBACvCkQ,EAAGC,WAAaL,EAChBE,EAAGlL,GAAOoL,EACNA,EAAGN,MAAQA,EAAK,OACpBM,EAAGrD,EAAImD,EAAGV,UACVU,EAAG9Q,MAAQyQ,EACXO,EAAGN,IAAMA,OAGTM,EAAK,CAAErD,EAAG8C,EAASC,IAAKA,EAAK9K,IAAKA,EAAK4K,GAAIA,EAAIS,WAAYL,EAAOhO,GAAI,MACtEkO,EAAGc,OAAOhM,EAAK,EAAGoL,GAClB9Q,EAAGsQ,GAAMQ,GAIbzK,EAAOjK,UAAU8C,IAAM,SAAU6P,EAAMtT,GACrC,IAAIyI,EAAIhF,EAAIP,KAAMoQ,GAClB,GAAIpO,UAAUlD,OAAS,EAAG,CACxB,IAAKyG,EAAErH,IAAK,MAAMgE,MAAM,sBACxBqD,EAAErH,IAAIqH,EAAEC,MAAQ1I,EAElB,OAAOyI,GAETmC,EAAOjK,UAAUuV,SAAW,SAAU/M,EAAGrI,GACvC,IAAIiO,EAAM5F,aAAagN,KAAOhN,EAAIjG,KAAK2H,OACnCkE,IAAQ7L,KAAK2H,SAAQ/J,EAAIqI,GAC7B,IAAI4L,EAAMvE,EAAK1J,KAAKsP,UAAUtV,IAC9B,GAAIiO,EAAIsH,cAAgBtB,EAAxB,CACA,IAAK,IAAIvM,KAAK1H,EAAGiO,EAAIuH,MAAM9N,GAAK1H,EAAE0H,GAClCuG,EAAIsH,YAActB,IAmGhBvS,EAAK+T,SACP7D,GAAM,WACJnN,OAIJ/C,EAAKsG,IAAMtG,EAAKsG,KAAO8B,EACvB,IAAI/D,EAAiBjF,SAASC,cA5tB9B,SAA4BwE,EAAMmQ,GAChC,OAAO,IAAI7P,SAASN,EAAM,WAAamQ,EAAiB,OAG1D,SAA+BnQ,EAAMmQ,GAEnC,OADAA,EAAiBA,EAAehV,MAAM,MAAME,KAAK,QAAQ2M,QAAQ,KAAM,OAChE,IAAI1H,SAASN,EAAM,qEAAuEmQ,EAAiB,gCA2tBpH,MAAO,CACLC,SAloBF,SAAmBC,EAAQC,EAAUC,GACnC,IAAItX,EAAsB,MAAdoX,EAAO,GAAcA,EAAO/O,UAAU,GAAK+O,EAGvD,GAFAE,EAAYA,GAAa,GACzBD,EAASxV,KAAOmJ,EAASqM,EAASxV,UAAMgB,IACpCY,EAAYzD,GAKhB,OAJKyD,EAAY6T,IAAYzR,EAAU,8BAAgCyR,GACvE7T,EAAYzD,GAAQmD,EAAG0I,OAAO,GAAIpI,EAAY6T,GAAYD,GAC1D5T,EAAYzD,GAAMA,KAAOA,EACzByD,EAAYzD,GAAM+L,MAAQuL,GACnB,EALsBF,IAAWpX,GAAM6F,EAAU,8BAAgC7F,IA+nBxF+I,MAAOA,EACP9C,IAAKA,EACLvC,SAAU6D,EACV6L,MAAOA,EACPrG,KAAMA,EACNK,SAAUA,EACVwJ,SAAUtL,EAAOjK,UAAUuV,SAC3BW,SAAU,SAAUvX,GAAQ,OAAOA,EAAOyD,EAAYzD,GAAQyD,GAC9D+T,KAAM,SAAU9F,EAAGuB,GAAiC,OAA1BvB,EAAI9N,KAAK6T,QAAQ/F,EAAGuB,IAAiBvB,EAAE,GAAK,MACtE+F,QAAS,SAAU/F,EAAGuB,GAAiE,IAAIyE,EAAI,EAAG,GAArEhG,EAAI,GAAGvP,MAAMvC,MAAMqT,GAAO3Q,UAAU8D,iBAAiBsL,IAAuB,IAAK,IAAIjS,EAAI,EAAGA,EAAIiS,EAAEhP,OAAQjD,IAAOiS,EAAEgG,GAAKhG,EAAEjS,GAAG4G,KAAMqR,GAAKhG,EAAEgG,GAAK,EAAI,EAAI,OAAOA,GAAKhG,EAAEhP,OAASgV,EAAGhG,GAAK,OAIvMiG,CAAc,CAAEV,SAAS","file":"reefer-core.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","// ============================================\r\n// reeferHTML ()\r\n// ============================================\r\n;(function () {\r\n  var coral = window.coral = window.coral || {}; coral.ui = coral.ui || {}\r\n  coral.ui.clientSideInclude = function (data) {\r\n    function isfunction (obj) { return !!(obj && obj.constructor && obj.call && obj.apply) }\r\n    if (isfunction(data)) data = data.toString().split('\\n').slice(1, -1).join('\\n')\r\n    var dsc = document.currentScript || window.rf_script\r\n    if (!dsc) { // IE11 support\r\n      dsc = document.getElementsByTagName('script')\r\n      dsc = dsc[dsc.length - 1]\r\n    }\r\n    if (window.rf_script) window.rf_script = null\r\n    var cb = dsc.reefCB\r\n    if (cb === undefined) dsc.outerHTML = data\r\n    else cb(data)\r\n    if (dsc.parentNode) dsc.parentNode.removeChild(dsc)\r\n  }\r\n})()\r\n\r\n// ============================================\r\n// ReeferFactory\r\n// ============================================\r\nfunction ReeferFactory (opts) {\r\n  opts = opts || {}\r\n  var xs = window.xs\r\n  var rf_range = document.createRange()\r\n  var rf_counter = 0 // used for 'symbol'\r\n  var rf_listeners = {}\r\n  var rf_key = 0\r\n  const rf_registry = {\r\n    '': {\r\n      template: function () {\r\n        var _d = this.data\r\n        var slots = this.slots || {}\r\n        var slot = slots[_d.dataslot || 'default']\r\n        if (!slot) return 'done'\r\n        if (!this.data.datasrc) return 'done'\r\n        var dc = ('datactx' in _d) ? this.dot(_d.datactx).value : {}\r\n        var dl = ('datasrc' in _d) ? this.dot(_d.datasrc).value : this\r\n        var gk = this.data.genkey\r\n        var gen = (dl && slot) || (slots.empty && slots.empty.text) || { text: '<div> </div>' }\r\n        var key = _d.datakey; var uk\r\n        if (!Array.isArray(dl)) dl = [dl]\r\n        if (slots.header) this.html(-1, slots.header.script ? slots.header(dc) : slots.header.text)\r\n        var hm = this.__.hmap || {}\r\n        dc.__hmap__ = hm\r\n        for (var i = 0; i < dl.length; i++) {\r\n          var t = typeof (dl[i])\r\n          if (dl[i]) uk = key === undefined ? dl[i].__key__ : dl[i][key]\r\n          if (gk && uk === undefined && t === 'object') uk = xs.privateprop(dl[i], '__key__', 'k' + rf_key++)\r\n          var row = gen.script ? gen.script(dl[i], i, dc) : gen.text\r\n          this.html(uk || i, row)\r\n        }\r\n        delete dc.__hmap__\r\n        if (slots.footer) this.html(-2, slots.footer.script ? slots.footer(dc) : slots.footer.text)\r\n      }\r\n    }\r\n  }\r\n\r\n  function reefWarn () { console.error(arguments) }\r\n  function reefError () { console.error(arguments); throw Error('REEF FAULT') }\r\n  function alwaysobj (rf, n) { rf[n] = rf[n] || {}; return rf[n] }\r\n\r\n  // ============================================\r\n  // dom\r\n  // ============================================\r\n  function run (arg) {\r\n    var d = (arg || document)\r\n    var r = []\r\n    var rels = d.querySelectorAll(':not([reef-stage])[reef]')\r\n    for (var i = 0; i < rels.length; i++) {\r\n      if (!rels[i].reef) {\r\n        var rr = reeferDOM(rels[i], d.reef)\r\n        publishLF(rr, 'mount')\r\n        if (rr) rr.render_()\r\n        r.push(rr)\r\n      }\r\n    }\r\n    return r\r\n  }\r\n\r\n  function parseScript (attrBag, c) {\r\n    try {\r\n      var type = c.getAttribute('type')\r\n      var args = type.match(/\\(([^)]*)\\)/); args = args ? args[1] : ''\r\n      var ftext = c.innerHTML.trim()\r\n      var props = attrBag.props = attrBag.props || {}\r\n\r\n      if (ftext) {\r\n        switch (type.split('(')[0].trim()) {\r\n          case 'reef-method': alwaysobj(attrBag, 'methods')[c.getAttribute('name') || 'default'] = new Function(args, ftext); break\r\n          case 'reef-observer': alwaysobj(attrBag, 'observers')[c.getAttribute('name') || 'default'] = new Function(args, ftext); break\r\n          case 'reef-function': c.reefScript = new Function(args, ftext); break\r\n          case 'reef-template': c.reefScript = templateEngine(args, ftext); break\r\n          default:\r\n            var p = type.split('reef-p-')[1]\r\n            if (p) { try { ftext = JSON.parse(ftext) } catch (err) {} props[p.trim()] = ftext; return true }\r\n            reefWarn('unknown reef slot type', type)\r\n            break\r\n        }\r\n      }\r\n    } catch (err) { reefWarn('reef-slot script parsing ERROR:', ftext || c.type, c, err) }\r\n  }\r\n\r\n  function reeferDOM (el, parentReef) {\r\n    if (!el) return null\r\n    var reefName = el.getAttribute('reef')\r\n    try {\r\n      var attrBag = getAttributes(el)\r\n      var cloneEl = el.cloneNode(true) // deep copy\r\n      if (cloneEl) {\r\n        attrBag = attrBag || {}\r\n        if (cloneEl.children) {\r\n          for (var i = 0; i < cloneEl.children.length; i++) {\r\n            var slots = alwaysobj(attrBag, 'slots')\r\n            var c = cloneEl.children[i]\r\n            var ga = c.getAttribute\r\n            var attr = (ga && ga.call(c, 'reef-slot')) || 'default'\r\n            if (c.nodeName === 'SCRIPT' && c.type.indexOf('reef-') === 0) {\r\n              if (parseScript(attrBag, c)) continue\r\n            }\r\n            var sa = slots[attr] = slots[attr] || []\r\n            sa.push(c)\r\n            sa.text = (sa.text || '') + (ga ? c.outerHTML : c.data) // convenience\r\n            if (!('el' in sa)) sa.el = c // convenience\r\n            if (!('script' in sa) && c.reefScript) sa.script = c.reefScript // convenience\r\n          }\r\n        }\r\n      }\r\n\r\n      return mount(el, reefName, attrBag, parentReef)\r\n    } catch (err) {\r\n      reefWarn('Reefer failed to mount: ', reefName, el, err)\r\n    }\r\n    return null\r\n  }\r\n\r\n  function publishLF (reef, lf) { return reef.lifecycle && reef.lifecycle[lf] && reef.lifecycle[lf].call(reef) }\r\n\r\n  function getAttributes (el) {\r\n    var attrBag\r\n    var attrlist = el.attributes\r\n    for (var i = 0; i < attrlist.length; i++) {\r\n      var attr = attrlist[i]\r\n      var n = attr.name + ''\r\n      if (n.indexOf('reef-p') === 0) {\r\n        attrBag = attrBag || { }\r\n        var val = attr.value\r\n        var spl = n[6] // whatever the character is... use two of those to split - 6 is len of 'reef-p'\r\n        var ev = val.split(spl + spl); val = ev[0]; ev = ev[1]\r\n        var p = n.substring(7) // 7 is len of 'reef-pX' (note the 'X')\r\n        var d = determineDataBinding(p, val)\r\n        try { val = JSON.parse(val) } catch (err) {}\r\n        if (!d) alwaysobj(attrBag, 'props')[p] = val; else alwaysobj(attrBag, 'bind')[p] = d\r\n        if (ev) alwaysobj(attrBag, 'events')[p] = ev\r\n      } else if (n.indexOf('reef.') === 0) {\r\n        var lis = n.substring(5)\r\n        attrBag = attrBag || { }\r\n        alwaysobj(attrBag, 'listeners')[lis] = attr.value\r\n      }\r\n    }\r\n    return attrBag\r\n  }\r\n\r\n  function determineDataBinding (k, v) {\r\n    if (v[0] !== '~') return false\r\n    var s = v.split('~')\r\n    return { prop: s[1], selector: (s.length < 2) ? '^' : s[2] }\r\n  }\r\n\r\n  function templateGenerator (args, templateString) {\r\n    return new Function(args, 'return `' + templateString + '`;')\r\n  }\r\n\r\n  function templateGeneratorES5 (args, templateString) {\r\n    templateString = templateString.split('\\n').join('\\\\\\n').replace(/\"/g, '\\\\\"') // multiline and escape double quotes and slashes\r\n    return new Function(args, 'var f=function (_, exp) {return eval(exp)}; f.bind(this); return \"' + templateString + '\".replace(/\\\\${(.*?)}/g, f)')\r\n  }\r\n\r\n  function mount (el, name, localData, parentReef) {\r\n    localData = localData || {}\r\n    if (!rf_registry[name]) reefError('Reefer NOT registered: ', name)\r\n\r\n    // make Reefer\r\n    var defaultData = rf_registry[name]\r\n    var reef = new opts.use(el, defaultData, localData)\r\n    reef.name = name\r\n    el.setAttribute('reef-stage', 'mounted')\r\n\r\n    // register listeners\r\n    if (reef.listeners) {\r\n      var al = []\r\n      var rl = reef.listeners\r\n      for (var k in rl) {\r\n        al.push(k)\r\n        var ev = k.split('.')\r\n        var e = ev[0]\r\n        if (!rf_listeners[e]) { // we only need to add it once\r\n          rf_listeners[e] = listenerFactory(e)\r\n          document.addEventListener(e, rf_listeners[e], false)\r\n        }\r\n        rl[e] = rl[k]\r\n        if (rl[ev[1]] === 'stop') rl[e].reefStop = true\r\n      }\r\n      reef.listeners = al // keep the tag so we know we had listeners - but they are source from the registry\r\n    }\r\n\r\n    return reef\r\n  }\r\n\r\n  function listenerFactory (type) {\r\n    return function (event) {\r\n      var el = (event.detail && event.detail.reefEmitRootEl) || event.target; var rr\r\n      var evattr = 'reef.' + type\r\n      var handlers = []\r\n      while (el) {\r\n        if (el.getAttribute) {\r\n          var evvalue = el.getAttribute(evattr)\r\n          if (!evvalue) {\r\n            evvalue = el.getAttribute(evattr + '.stop')\r\n            if (evvalue) evvalue.stop = true\r\n          }\r\n          if (evvalue) handlers.push(evvalue.trim())\r\n          var reef = el.reef\r\n          if (!event.reef) event.reef = reef\r\n          if (reef && handlers.length) { // parse the handler for the event\r\n            for (var i = 0; i < handlers.length; i++) {\r\n              var ev = handlers[i]\r\n              var fn = ev\r\n              /*\r\n              var func = function (event) { eval(fn) }\r\n              try { func.call(reef, event) } catch (err) { reefWarn('reef-event-Error') }\r\n              /* // old syntax - you do do prop(value)\r\n              */\r\n              var parseArgs = function (str) {\r\n                var argsets = str.match(/\\(([^)]*)\\)/)\r\n                return (argsets && argsets[1]) || ''\r\n              }\r\n              var args = parseArgs(fn)\r\n              if (args) {\r\n                args = args.split(',')\r\n                fn = fn.split('(')[0]\r\n                var idx = args.indexOf('$event') // allow substition\r\n                if (idx >= 0) args[idx] = event\r\n              }\r\n              var f = reef.dot(fn); var rval\r\n              if (f.value !== undefined) {\r\n                if (isfunction(f.value)) rval = f.value.apply(f.obj, args || [event])\r\n                else reef.dot(fn, args[0])\r\n                if (rval === 'stop' || ev.stop) return\r\n              }\r\n            }\r\n          }\r\n          var rn = reef && reef.name\r\n          if (rf_registry[rn]) {\r\n            rr = rf_registry[rn]\r\n            if (rr.listeners && rr.listeners[type]) {\r\n              if (rr.listeners[type].call(reef, event) === 'stop' || rr.listeners[type].reefStop) { return } // hmm - should we support bubbling?\r\n            }\r\n          }\r\n        }\r\n        el = el.parentNode\r\n      }\r\n    }\r\n  }\r\n\r\n  function register (inname, reefData, superReef) {\r\n    var name = (inname[0] === '*') ? inname.substring(1) : inname\r\n    superReef = superReef || ''\r\n    reefData.data = arrtoobj(reefData.data, undefined)\r\n    if (rf_registry[name]) { if (inname === name) reefError('Reefer already registered: ' + name); return }\r\n    if (!rf_registry[superReef]) reefError('Super Reef NOT registered: ' + superReef)\r\n    rf_registry[name] = xs.assign({}, rf_registry[superReef], reefData)\r\n    rf_registry[name].name = name\r\n    rf_registry[name].super = superReef\r\n    return true\r\n  }\r\n\r\n  // ============================================\r\n  // Reefer - helpers\r\n  // ============================================\r\n  function resolveEl (el, ctx) { if (typeof (el) !== 'string') return el; return resolveEl(ctx || document).querySelector(el) }\r\n  function isfunction (obj) { return !!(obj && obj.constructor && obj.call && obj.apply) }\r\n  function arrtoobj (arr, v) { if (!Array.isArray(arr)) return arr; var o = {}; for (var i = 0; i < arr.length; i++) o[arr[i]] = (arguments.length <= 1 ? true : v); return o }\r\n  function cif (o, props, o1, o2) {\r\n    for (var i = 0; i < props.length; i++) {\r\n      var p = props[i]\r\n      var np = (p in o2) ? o2[p] : o1[p]\r\n      if (np === undefined) continue\r\n      o[p] = xs.clone(o1[p], o2[p])\r\n    }\r\n  }\r\n\r\n  // ============================================\r\n  // Reefer - constructor\r\n  // ============================================\r\n  function Reefer (rootEl, setup, localSetup) {\r\n    setup = setup || {}\r\n    localSetup = localSetup || {}\r\n    var rf = this\r\n    var _ = this.__ = {}\r\n    cif(_, ['template', 'update', 'bind'], setup, localSetup)\r\n    cif(this, ['methods', 'observers', 'listeners', 'mutate', 'lifecycle'], setup, localSetup) // intentional shallow copies\r\n    if ('shared' in setup) this.shared = setup.shared\r\n    if (setup.events || localSetup.events) _.events = xs.assign({}, arrtoobj(setup.events), localSetup.events)\r\n    if (setup.decorators || localSetup.decorators) _.decorators = xs.assign({}, arrtoobj(setup.decorators), arrtoobj(localSetup.decorators))\r\n    if (setup.slots || localSetup.slots) xs.assign(alwaysobj(this, 'slots'), setup.slots, localSetup.slots)\r\n    if ('super' in setup) this.super = rf_registry[setup.super]\r\n\r\n    var sh = this.methods; if (sh) for (var k in sh) sh[k] = isfunction(sh[k]) ? sh[k].bind(rf) : sh[k] // bind to reef\r\n\r\n    this.rootEl = rootEl\r\n    rootEl.reef = this\r\n    _.obsf = Reefer.prototype.react.bind(rf)\r\n    var _d = this.data = xs.observe({}, _.obsf) // public as well -- our main \"react\" core\r\n    xs.assign(_d, _.decorators, setup.data, localSetup.props) // make our data\r\n    // for (k in this.observers) if (!(k in _d)) _d[k] = undefined\r\n    for (k in _.bind) doDataBind(this, 'data.' + k, _.bind[k].selector, _.bind[k].prop)\r\n    xs.observe(_d) // trigger observers\r\n    this.sym = '$' + rf_counter++\r\n    return this\r\n  }\r\n  Reefer.prototype.unmount = function () {\r\n    publishLF(this, 'umnount')\r\n    var _ = this.__ || {}\r\n    xs.unobserve(this.data, _.obsf)\r\n    if (_.bind) {\r\n      for (var k in _.bind) {\r\n        var b = _.bind[k]\r\n        if (b.obsf) xs.unobserve(b.sp.obj, b.obsf)\r\n      }\r\n    }\r\n  }\r\n\r\n  // ============================================\r\n  // react\r\n  // ============================================\r\n  function regexprep (o) { var s = ''; for (var k in o) { s += ':xs:' + k + '\\n' }; return s }\r\n  Reefer.prototype.react = function (updates) { // core event engine\r\n    updates.reef = this\r\n    var _ = this.__\r\n    var status\r\n    var p = updates.root// = updates.path.split('.')[0]//updates.path ? updates.path.split('.')[0] : updates.prop\r\n    var _obs = this.observers\r\n    var _ev = _.events\r\n    var rx = _.proprx = _.proprx || ((_obs ? regexprep(_obs) : '') + (_ev ? regexprep(_ev) : ''))\r\n    if (rx) {\r\n      var str = '(:xs:((' + updates.path/* .replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&') */.replace(/\\./g, '\\\\.)|(\\\\*\\\\.))*((') + ')|(\\\\*)))\\n'\r\n      var regx = new RegExp(str, 'g')\r\n      var m = rx.match(regx)\r\n      if (m) {\r\n        var mp = m[0]\r\n        for (var i = 1; i < m.length; i++) if (m[i].length > mp.length) mp = m[i]\r\n        p = mp.substring(4, mp.length - 1) // skipe the ':xs:\r\n      }\r\n    }\r\n    var op = _obs && _obs[p]\r\n    if (op) { // observers\r\n      if (isfunction(op)) status = op.call(this, updates)\r\n      else {\r\n        if (!updates.path && (updates.action === 'set' || updates.action === 'add')) {\r\n          var o = this.dot(op)\r\n          if (isfunction(o.value)) o.value.call(this)\r\n          else o.obj[o.prop] = updates.value\r\n        }\r\n      }\r\n    }\r\n    if (_ev && _ev[p]) { // events\r\n      var e = _.name + '.' + (_ev[p] === true ? p : _ev[p])\r\n      emit(this.rootEl, e, updates)\r\n    }\r\n\r\n    var mstatus\r\n    if (updates.value === updates.prev) return\r\n    if (this.mutate) mstatus = this.mutate(this, updates)\r\n    var _d = _.decorators\r\n    if (!this.sym) return // we are still constructing\r\n    if (status !== 'done' && mstatus !== 'done' && (!_d || (!_d[p] && !_d[mp]))) this.rerender() // re-render\r\n  }\r\n  Reefer.prototype.observe = function (k, cb) { var _o = alwaysobj(this, 'observers'); _o[k] = cb; this.__.obsrx = null }\r\n  Reefer.prototype.decorate = function (k, set) { var _d = alwaysobj(this, 'decorators'); _d[k] = (set !== false && set !== 0) }\r\n  Reefer.prototype.events = function (k, set) { var _e = alwaysobj(this.__, 'events'); _e[k] = (set !== false && set !== 0 && set); this.__.evrx = null }\r\n  Reefer.prototype.watch = function (k, o) { this.data[k] = o; this.data.__observe__() }\r\n  Reefer.prototype.bind = function (k, sel, copyk, ctx) { doDataBind(this, k, sel, copyk, ctx) }\r\n  Reefer.prototype.emit = function (ev, detail) { emit(this.rootEl, ev, detail) }\r\n  function loadData (datapath, url, opts) { // this must be Reefer\r\n    var rf = this\r\n    opts = opts || {}\r\n    var xhr = opts.xhr || new XMLHttpRequest()\r\n    /* if (!opts.xhr || opts.responseType) // either it's new or it's passed in\r\n    { xhr.responseType = opts.responseType || 'json' } */\r\n    xhr.onerror = function (err) { console.log('REEF HTTP LOAD', err); emit(rf.rootEl, 'reefLoadDataFail', { url: url }) }\r\n    xhr.onload = function (ev) {\r\n      if (this.status === 200) {\r\n        var res = this.response\r\n        try { res = JSON.parse(res) } catch (err) {}\r\n        if (opts.sanitize) res = sanitize(res)\r\n        rf.dot(datapath, res)\r\n      } else if (this.status) xhr.onerror(ev)\r\n    }\r\n    xhr.open(opts.method || 'GET', url, true)\r\n    xhr.send(null)\r\n    return xhr\r\n  }\r\n  function loadHTML (datapath, url) { // this must be Reefer\r\n    var rf = this\r\n    if (document.readyState !== 'loading') {\r\n      var script = document.createElement('script')\r\n      script.src = url\r\n      document.getElementsByTagName('head')[0].appendChild(script)\r\n    } else {\r\n      document.write('<script src=\"' + url + '\"></script')\r\n      script = document.getElementsByTagName('script')\r\n      script = script[script.length - 1]\r\n    }\r\n    script.onerror = function (err) { console.log('REEF SCRIPT LOAD', err); script.parentNode.removeChild(script); emit(rf.rootEl, 'reefLoadHTMLFail', { url: url }) }\r\n    script.reefCB = function (data) { rf.dot(datapath, data) }\r\n    if (!document.currentScript) window.rf_script = script\r\n    return script\r\n  }\r\n\r\n  function realizeSource (refobj, copyprop) {\r\n    var pp = copyprop.split('.')\r\n    var sp = dot(refobj, pp)\r\n    if (sp.obj) return sp\r\n    var fp = copyprop.split('.'); var oc = refobj\r\n    for (var i = 0; i < fp.length; i++) {\r\n      var nc = oc[fp[i]]; if (nc === undefined || nc === null || typeof (nc) !== 'object') oc[fp[i]] = (i == fp.length - 1 ? undefined : {}); oc = oc[fp[i]]\r\n    }\r\n    return dot(refobj, pp)\r\n  }\r\n\r\n  function jsonp (str, rf, proppath) {\r\n    var ind = str.indexOf('{JSONP}')\r\n    if (ind < 0) return str\r\n    var fname = 'jsonp_rf_' + rf_counter++\r\n    window[fname] = function (data) {\r\n      rf.dot(proppath, data)\r\n      delete window[fname]\r\n    }\r\n    return str.replace('{JSONP}', fname)\r\n  }\r\n\r\n  function doDataBind (rf, proppath, sel, copyprop, selctx) {\r\n    var refobj, sp\r\n    sel = sel || '^'\r\n    var _ = rf.__\r\n    var _b = alwaysobj(_, 'bind')\r\n    var _bp = alwaysobj(_b, proppath)\r\n    copyprop = copyprop || proppath\r\n    if (_bp.proppath === proppath && _bp.selector === sel && _bp.prop === copyprop) return\r\n    switch (sel[0]) {\r\n      case '^':\r\n        sp = realizeSource(rf, copyprop)\r\n        break\r\n      case '#':\r\n      case '.':\r\n      case '[':\r\n        var el = (selctx || document).querySelector(sel)\r\n        refobj = el && el.reef\r\n        if (!refobj) reefError('unable to locate reef for bind')\r\n        sp = realizeSource(refobj, copyprop)\r\n        break\r\n      default:\r\n        var els = sel.split('$')\r\n        _b[proppath] = { proppath: proppath, selector: sel, prop: copyprop }\r\n        switch (els[1]) {\r\n          case 'data':\r\n          case 'html':\r\n          case 'json-raw': loadData.call(rf, proppath, els[2]); break\r\n          case 'json': loadData.call(rf, proppath, els[2], { sanitize: true }); break\r\n          case 'jsonp': els[2] = jsonp(els[2], rf, proppath) // fall through\r\n          case 'js': loadHTML.call(rf, proppath, els[2]); break\r\n          default:\r\n            reefError('unknown data bind: ' + proppath + ': ' + sel)\r\n        }\r\n        sp = realizeSource(rf, copyprop)\r\n        if (copyprop === proppath) return\r\n        break\r\n        // fall through\r\n    }\r\n\r\n    // /var dp = dot(rf, proppath)\r\n    var dp = realizeSource(rf, proppath)\r\n    if (!dp.obj) reefError('data bind not found: ' + proppath)\r\n    var f = function (u) {\r\n      if (!rf.rootEl || rf.rootEl.getRootNode() !== document) {\r\n        rf.unmount()\r\n        return\r\n      }\r\n      rf.react(u)\r\n    }\r\n    var obsf = xs.alias(dp.obj, dp.prop, sp.obj, sp.prop, f)\r\n    _b[proppath] = { proppath: proppath, selector: sel, prop: copyprop, sp: sp, unobs: obsf }\r\n  }\r\n\r\n  // ============================================\r\n  // render\r\n  // ============================================\r\n  Reefer.prototype.render_ = render\r\n  Reefer.prototype.render = function () {\r\n    xs.tick(this.sym + '_rr', this, render)\r\n  }\r\n  function render () {\r\n    publishLF(this, 'beforeRender')\r\n    var t = new Date()\r\n    var rel = this.rootEl\r\n    if (!rel || rel.getRootNode() !== document) {\r\n      this.unmount()\r\n      return\r\n    }\r\n    var template = this.__.template\r\n    if (template) {\r\n      var fc = this.__.fcounter\r\n      if (fc) this.htmlBegin()\r\n      fc = this.__.fcounter //  reset it\r\n      var res = template.call(this, this.slots) || ''\r\n      if (this.__.harr) this.htmlEnd()\r\n      else if (typeof (res) === 'string') {\r\n        if (res !== 'done') rel.innerHTML = res // a way to \"out\"\r\n      } else {\r\n        rel.innerHTML = ''\r\n        if (Array.isArray(res)) res.forEach(function (e) { rel.appendChild(e) })\r\n        else rel.appendChild(res)\r\n      }\r\n      if (rel.parentNode.classList.contains('container')) { rel = rel }\r\n      run(rel) // hydrate nested components (should we only do this if we have a template?)\r\n      if (rel.parentNode.classList.contains('container')) { console.log('render', new Date() - t) }\r\n    }\r\n    publishLF(this, 'afterRender')\r\n  }\r\n  Reefer.prototype.rerender = function () {\r\n    this.__.renderflag = (this.__.renderflag || 0) + 1\r\n    xs.tick(this.sym + '_rr', this, rerender, true)\r\n  }\r\n  function rerender () {\r\n    if (this.__.renderflag === 0) return\r\n    var sel = saveSelection(this.rootEl)\r\n    render.call(this)\r\n    sel()\r\n    this.__.renderflag = 0\r\n  }\r\n  function getAttachPoint (el) {\r\n    switch (el.nodeName) {\r\n      case 'TABLE': return (el.childNodes && el.childNodes[0]) || el\r\n      default: return el\r\n    }\r\n  }\r\n  function hash (str) {\r\n    var hash = 0; var len = str.length\r\n    for (var i = 0; i < len; i++) {\r\n      hash = hash * 31 + str.charCodeAt(i)\r\n      hash = hash & hash\r\n    }\r\n    return hash\r\n  }\r\n  Reefer.prototype.htmlBegin = function (forceClean) {\r\n    if (!this.__.harr || forceClean) {\r\n      this.__.hmap = {}\r\n      this.__.hgeneration = -1\r\n    }\r\n    this.__.harr = []\r\n    this.__.harr.html = ''\r\n    this.__.harr.htmlIdx = 0\r\n    this.__.harr.wmap = new WeakMap()\r\n    this.__.hgeneration++\r\n    this.__.fcounter = 0\r\n  }\r\n  /*\r\n  function replaceNode (c, nch) {\r\n    var p = c.previousSibling\r\n    var pn = p || c.parentNode\r\n    if (!c.getAttribute && 0) { c.nodeValue = nch } else { c.outerHTML = nch }\r\n    return p ? p.nextSibling : pn.childNodes[0]\r\n  }\r\n*/\r\n  function copyAttributes (c, n) {\r\n    try {\r\n      var a = {}; var at\r\n      var na = n.attributes; var nal = na.length\r\n      for (var i = 0; i < nal; i++) {\r\n        at = na[i]; a[at.name] = true\r\n        if (c.getAttribute(at.name) !== at.value) c.setAttribute(at.name, at.value)\r\n      }\r\n      var ca = c.attributes; var cal = ca.length\r\n      if (cal === nal) return true\r\n      for (i = 0; i < cal; i++) {\r\n        at = ca[i]; if (a[at.name]) continue\r\n        c.removeAttribute(at.name)\r\n      }\r\n    } catch (err) { return true }\r\n  }\r\n  function attemptMerge (c, n) {\r\n    if (c.nodeType === 3 && n.nodeType === 3) {\r\n      c.nodeValue = n.nodeValue\r\n      return true\r\n    }\r\n    if ((c.nodeName !== n.nodeName) ||\r\n        (!copyAttributes(c, n))) return false\r\n    if (c.childNodes.length || n.childNodes.length) {\r\n      var i\r\n      var cc = c.childNodes\r\n      var nc = n.childNodes\r\n      var il = i = Math.min(cc.length, nc.length)\r\n      while (il < cc.length) c.removeChild(cc[i])\r\n      while (il < nc.length) c.appendChild(nc[il++])\r\n      while (--i >= 0) {\r\n        var ccn = cc[i]\r\n        var ncn = nc[i]\r\n        if (ccn.nodeType === 3 && ncn.nodeType === 3) { if (ccn.nodeValue !== ncn.nodeValue) ccn.nodeValue = ncn.nodeValue; continue }\r\n        if (ccn.isEqualNode(ncn)) continue\r\n        if (ccn.nodeName !== ncn.nodeName || !attemptMerge(ccn, ncn)) {\r\n          c.replaceChild(ncn, ccn)\r\n        }\r\n      }\r\n    }\r\n    return true\r\n  }\r\n\r\n  function mergeNode (c, n) {\r\n    if (c.nodeName !== n.nodeName || !attemptMerge(c, n)) {\r\n      c.parentNode.replaceChild(n, c)\r\n      return n\r\n    }\r\n    return c\r\n  }\r\n\r\n  Reefer.prototype.htmlUpdate = function (idx, id, htmlGen) {\r\n    var _ = this.__\r\n    var hm = _.hmap\r\n    if (!hm) return\r\n    var hsh = hash(htmlGen)\r\n    id = (id === undefined || id === null) ? hsh : id\r\n    if (!(id in hm)) reefError('updating non-existent element')\r\n    if (hm[id].hsh === hsh && idx === hm[id].idx) return\r\n    var root = getAttachPoint(this.rootEl)\r\n    var c = hm[id].el\r\n    if (!c.getAttribute) { if (c.nodeValue !== htmlGen) c.nodeValue = htmlGen; return } // cheat\r\n    hm[id].el = mergeNode(root.childNodes[idx], hydrate(root, htmlGen).firstChild)\r\n    hm[id].hsh = hsh\r\n    hm[id].idx = idx\r\n  }\r\n\r\n  Reefer.prototype.htmlEnd = function () {\r\n    var _ = this.__\r\n    var genid = _.hgeneration\r\n    var hta = ''\r\n    var ha = _.harr\r\n    var hm = _.hmap\r\n    if (!ha) return\r\n    var fl = this.__.fcounter\r\n    var prev = null\r\n    if (fl === 0) {\r\n      this.htmlBegin(true) // reset\r\n      this.rootEl.innerHTML = ''\r\n      return\r\n    }\r\n    if (genid === 0) this.rootEl.innerHTML = '' // do this first\r\n    for (var k in hm) { // delete untouched\r\n      var hc = hm[k]\r\n      if (hc.generation === genid) continue\r\n      if (hc.el) hc.el.parentNode.removeChild(hc.el)\r\n      delete hm[k]\r\n    }\r\n\r\n    var root = getAttachPoint(this.rootEl)\r\n    var div = document.createElement(root.nodeName)\r\n\r\n    if (ha.html) {\r\n      // div.innerHTML = ha.html\r\n      div = hydrate(root, ha.html)\r\n      ha.html = ''\r\n    }\r\n\r\n    var cnt = 0\r\n    for (var i = 0; i < fl; i++) {\r\n      hc = ha[i]\r\n      var c = hc.el\r\n      var h = hc.h\r\n      if (typeof (h) === 'number') {\r\n        var n = div.childNodes[hc.h - cnt]\r\n        n = mergeNode(c, n)\r\n        if (n !== c) {\r\n          hc.el = c = n\r\n          cnt++\r\n        }\r\n      } else if (h) {\r\n        if (i >= root.childNodes.length) hta += h\r\n        else hc.el = c = hydrate(root, h).firstChild\r\n      }\r\n      hc.idx = i\r\n      hc.h = ''\r\n      if (c) {\r\n        hc.el = c\r\n        ha.wmap.set(c, i)\r\n        if (c.parentNode !== root || c.previousSibling !== prev) { // clean up placement\r\n          if (prev) {\r\n            root.insertBefore(c, prev.nextSibling)\r\n          } else if (!root.childNodes || root.childNodes[0] !== c) {\r\n            root.insertBefore(c, root.childNodes && root.childNodes[0])\r\n          }\r\n        }\r\n        prev = c\r\n      }\r\n    }\r\n    ha.length = fl\r\n\r\n    var rcl = root.childNodes.length\r\n    if (hta) root.insertAdjacentHTML('beforeend', hta) // end insert\r\n    root = getAttachPoint(this.rootEl)\r\n    if (root && ha.length !== root.childNodes.length) {\r\n      console.error('inconsistent count - must be 1 html() entity for hmtl()')\r\n    }\r\n    for (i = rcl; i < ha.length; i++) { ha[i].el = root.childNodes[i]; ha.wmap.set(ha[i].el, i) }\r\n    return 'done'\r\n  }\r\n\r\n  Reefer.prototype.htmlFromIdx = function (idx) {\r\n    var root = getAttachPoint(this.rootEl)\r\n    return root.childNodes[idx]\r\n  }\r\n  Reefer.prototype.htmlChild = function (el) {\r\n    while (el.parentNode !== this.rootEl) el = el.parentNode\r\n    return el\r\n  }\r\n  Reefer.prototype.htmlToIdx = function (el) {\r\n    while (el.parentNode !== this.rootEl) el = el.parentNode\r\n    var v = this.__.harr.wmap.get(el)\r\n    return v === undefined ? -1 : v\r\n  }\r\n  /*\r\n  Reefer.prototype.htmlKeyToIdx = function (id) {\r\n    var hm = this.__.hmap\r\n    if (!hm || !hm[id]) return null\r\n    return hm[id].idx | 0\r\n  }\r\n  Reefer.prototype.htmlFromKey = function (id) {\r\n    var hm = this.__.hmap\r\n    if (!hm || !hm[id]) return null\r\n    return hm[id].el\r\n  }\r\n*/\r\n  // const typecache = {}\r\n  function hydrate (type, h) {\r\n    rf_range.selectNode(type)\r\n    var el = rf_range.createContextualFragment(h)\r\n    return type.nodeName === 'TBODY' ? el.childNodes[0] : el\r\n    /*\r\n    type = type.nodeName\r\n    var t = typecache[type]\r\n    if (!t) t = typecache[type] = document.createElement(type.nodeName)\r\n    if (!h) return t\r\n    t.innerHTML = h\r\n    return t.childNodes[0]\r\n    */\r\n  }\r\n  Reefer.prototype.html = function (id, htmlGen) {\r\n    if (!this.__.harr) this.htmlBegin()\r\n    var _ = this.__\r\n    var ha = _.harr\r\n    var hm = _.hmap\r\n    var idx = _.fcounter++\r\n    var genid = _.hgeneration\r\n    var hsh = hash(htmlGen); var hc\r\n    id = (id === undefined || id === null) ? hsh : id\r\n    if (hm[id]) {\r\n      hc = hm[id]\r\n      if (hc.generation === genid) reefError('duplicate html() id')\r\n      hc.generation = genid\r\n      ha[idx] = hc // set the position\r\n      if (hc.hsh === hsh) return\r\n      hc.h = ha.htmlIdx++\r\n      ha.html += htmlGen\r\n      hc.hsh = hsh\r\n      // hc.split = splitter(htmlGen)\r\n    } else {\r\n      hc = { h: htmlGen, hsh: hsh, idx: idx, id: id, generation: genid, el: null }\r\n      ha.splice(idx, 0, hc)\r\n      hm[id] = hc\r\n    }\r\n  }\r\n\r\n  Reefer.prototype.dot = function (path, value) {\r\n    var v = dot(this, path)\r\n    if (arguments.length > 1) {\r\n      if (!v.obj) throw Error('chain path missing')\r\n      v.obj[v.prop] = value\r\n    }\r\n    return v\r\n  }\r\n  Reefer.prototype.styleBag = function (e, s) {\r\n    var rel = e instanceof Node ? e : this.rootEl\r\n    if (rel === this.rootEl) s = e\r\n    var hsh = hash(JSON.stringify(s))\r\n    if (rel.__xs__style === hsh) return\r\n    for (var k in s) rel.style[k] = s[k]\r\n    rel.__xs__style = hsh\r\n  }\r\n\r\n  // ============================================\r\n  // utilities\r\n  // ============================================\r\n  function dot (obj, spl) {\r\n    if (typeof (spl) === 'string') spl = spl.split('.')\r\n    var l = spl.length\r\n    for (var i = 0; i < l; i++) {\r\n      var k = spl[i]; var o = obj; obj = o[k]\r\n      if ((!obj || typeof (obj) !== 'object') && ((i + 1 < l) || (!(k in o)))) return { last: { obj: o, prop: k } }\r\n    }\r\n    return { value: obj, obj: o, prop: k }\r\n    /*\r\n    for (var i = 0; i < l && (obj !== undefined || !i); i++) {\r\n      key = spl[i]; ctx = obj\r\n      obj = (obj && key in obj) ? obj[key] : undefined\r\n    }\r\n    var ret = { value: obj, prop: key, obj: ctx }\r\n    return (i === l) ? ret : { last: ret }\r\n    */\r\n  }\r\n\r\n  function getChildIndex (node) { return [].indexOf.call(node.parentNode.childNodes, node) }\r\n  function saveSelection (rootEl) { // save the text selection (call the ret() as func to retore)\r\n    var ael = document.activeElement\r\n    if (ael) {\r\n      var startPosition = ael.selectionStart\r\n      var endPosition = ael.selectionEnd\r\n      var aeindex = []\r\n      while (ael && ael !== rootEl && ael.parentNode) {\r\n        aeindex.push(getChildIndex(ael))\r\n        ael = ael.parentNode\r\n      }\r\n    }\r\n    return function () {\r\n      if (ael) {\r\n        ael = rootEl\r\n        while (ael && aeindex.length) {\r\n          var ind = aeindex.pop()\r\n          ael = ael.childNodes[ind]\r\n        }\r\n        if (ael) {\r\n          if (ael.focus) ael.focus()\r\n          try {\r\n            ael.selectionStart = startPosition\r\n            ael.selectionEnd = endPosition\r\n          } catch (err) {}\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /*\r\n  function createCSS (name, rules) {\r\n    var style = document.getElementById ('__dynamic_styles__')\r\n    if (!style) {\r\n      style = document.createElement('style');\r\n      style.id = '__dynamic_styles__'; style.type = 'text/css'\r\n      document.getElementsByTagName('head')[0].appendChild(style)\r\n    }\r\n    var sheet = style.sheet\r\n    sheet.insertRule(name + '{' + rules + '}', 0)\r\n  }\r\n\r\n  createCSS('reef-helper', 'display:none;')\r\n*/\r\n  var rf_s\r\n  function sanitize (str) {\r\n    if (typeof (str) === 'object') {\r\n      for (var k in str) {\r\n        switch (typeof (str[k])) {\r\n          case 'string':\r\n          case 'object':\r\n            str[k] = str[k] ? sanitize(str[k]) : str[k] // to handle null etc\r\n          default: break\r\n        }\r\n      }\r\n      return str\r\n    }\r\n    rf_s = rf_s || document.createElement('div')\r\n    rf_s.textContent = str\r\n    return rf_s.innerHTML\r\n  }\r\n  function emit (el, ev, detail) {\r\n    el = resolveEl(el); detail = detail || {}\r\n    if (el) { detail.reefEmitRootEl = el }\r\n    document.dispatchEvent(new CustomEvent(ev, { detail: detail }))\r\n  }\r\n\r\n  function ready (cb) {\r\n    if (document.readyState === 'complete' ||\r\n      (document.readyState !== 'loading' && !document.documentElement.doScroll)) {\r\n      cb()\r\n    } else {\r\n      document.addEventListener('DOMContentLoaded', cb)\r\n    }\r\n  }\r\n  if (opts.autorun) {\r\n    ready(function () {\r\n      run()\r\n    })\r\n  }\r\n\r\n  opts.use = opts.use || Reefer\r\n  var templateEngine = document.currentScript ? templateGenerator : templateGeneratorES5 // proxy for literal support\r\n\r\n  // ============================================\r\n  // exports\r\n  // ============================================\r\n  return {\r\n    register: register,\r\n    mount: mount,\r\n    run: run,\r\n    template: templateEngine,\r\n    ready: ready,\r\n    emit: emit,\r\n    sanitize: sanitize,\r\n    styleBag: Reefer.prototype.styleBag,\r\n    registry: function (name) { return name ? rf_registry[name] : rf_registry },\r\n    find: function (a, ctx) { a = this.findAll(a, ctx); return a ? a[0] : null },\r\n    findAll: function (a, ctx) { a = [].slice.call((ctx || document).querySelectorAll(a)); var j = 0; if (a) for (var i = 0; i < a.length; i++) { a[j] = a[i].reef; j += a[j] ? 1 : 0 } return j ? (a.length = j, a) : null }\r\n  }\r\n}\r\n\r\nwindow.reefer = ReeferFactory({ autorun: true })\r\n"],"sourceRoot":""}