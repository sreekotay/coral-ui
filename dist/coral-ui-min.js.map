{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./public/coral/src/coral-observe.js","webpack:///./public/coral/src/coral-ui.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","objectObserver","obj","handler","ctxobj","path","Node","this","__xs__","sendAdd","concat","push","attach","_obj","values","skip","v","trigger","propertyObserver","Array","isArray","arr","arrhelpers","mbind","method","privateprop","_o","pause","apply","arguments","tick","length","arrayObserver","__observe__","undefined","pv","set","configurable","__gidcounter","h","__gobt","__ghsymbol","rootobj","f","a","b","dotpath","bs","reduce","root","handlerMerge","chainfind","prop","uc","chain","action","ha","upd","prev","find","dotapply","constructor","doterror","console","error","ppath","split","dot","k","last","deepcopy","bt","toString","writable","array","arrayApply","arrayKeysApply","keys","keysApply","keysFromArray","arrOfKeys","aok","__gob","resolveTick","gob","g","_s","setTimeout","xs","window","coral","observe","unobserve","objectUnobserver","splice","alias","obsobj","obsp","refobj","refp","listener","reflect","updates","__observer__","objpd","getOwnPropertyDescriptor","refpd","gf","sf","assign","al","ui","opts","rf_range","document","createRange","rf_counter","rf_listeners","rf_key","rf_registry","update","state","slots","slot","dataslot","datasrc","dc","datactx","dl","gk","genkey","uk","gen","empty","text","datakey","dataobj","header","html","script","__key__","row","footer","coralWarn","coralError","Error","alwaysobj","rf","run","arg","rels","querySelectorAll","render_","rr","UIDOM","publishLF","parseScript","attrBag","type","getAttribute","args","match","ftext","innerHTML","trim","props","Function","coralScript","templateEngine","JSON","parse","err","el","parentCoral","coralName","attrlist","attributes","attr","indexOf","val","spl","ev","substring","determineDataBinding","lis","getAttributes","cloneEl","cloneNode","children","ga","nodeName","sa","outerHTML","mount","lf","lifecycle","selector","localData","defaultData","use","setAttribute","listeners","rl","e","eli","listenerFactory","addEventListener","coralStop","event","argsets","detail","coralEmitRootEl","target","evattr","handlers","evvalue","stop","fn","idx","rval","isfunction","rn","eh","parentNode","arrtoobj","cif","o1","o2","UI","rootEl","setup","localSetup","_","__","shared","events","decorators","super","sh","methods","obsf","react","doDataBind","sym","regexprep","loadData","datapath","url","xhrc","abort","xhr","XMLHttpRequest","onerror","log","emit","onload","readyState","status","res","response","sanitize","open","body","headers","setRequestHeader","send","stringify","loadHTML","htmc","createElement","src","getElementsByTagName","appendChild","write","curc","removeChild","coralCB","data","currentScript","rf_script","realizeSource","copyprop","pp","sp","fp","oc","nc","looseNode","getRootNode","proppath","sel","selctx","force","_b","_bp","copy","which","refObj","parentElement","querySelector","els","str","fname","replace","jsonp","dp","u","unmount","unobs","render","rel","fc","fcounter","htmlBegin","harr","htmlEnd","forEach","renderflag","rerender","ael","activeElement","startPosition","selectionStart","endPosition","selectionEnd","aeindex","node","childNodes","ind","pop","focus","saveSelection","getAttachPoint","hash","len","charCodeAt","_obs","observers","_ev","rx","proprx","regx","RegExp","mp","mstatus","op","mutate","_d","cb","obsrx","decorate","evrx","watch","copyk","ctx","forceClean","hroot","hmap","hgeneration","htmlIdx","wmap","WeakMap","rf_tagvalue","mergeNode","nodeType","nodeValue","at","na","nal","ca","cal","removeAttribute","copyAttributes","replaceChild","cc","il","Math","min","ccn","ncn","isEqualNode","hydrate","selectNode","createContextualFragment","rf_s","textContent","resolveEl","dispatchEvent","CustomEvent","ready","documentElement","doScroll","htmlUpdate","id","htmlGen","hm","hsh","firstChild","genid","fl","hta","hc","generation","div","cnt","previousSibling","insertBefore","nextSibling","rcl","insertAdjacentHTML","htmlFromIdx","htmlChild","htmlToIdx","__coral_dirty__","styleBag","__xs__style","style","autorun","templateString","join","register","inname","coralData","superCoral","template","cssRule","rules","getElementById","sheet","insertRule","registry","findAll","j","slice","UIFactory","loadScript","asCSS","clientSideInclude","dsc"],"mappings":"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","file":"coral-ui-min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n",";(function () {\r\n  // ===================================\r\n  // observer\r\n  // ===================================\r\n  function objectObserver (obj, handler, ctxobj, path) {\r\n    if (obj instanceof Node) return\r\n    if (!obj && this.__xs__) obj = this // called via obj.__observe__()\r\n    if (!obj) return\r\n    var sendAdd = !!obj.__xs__\r\n\r\n    // only one watcher\r\n    if (ctxobj) {\r\n      path = (path && path.concat()) || []\r\n      path.push(ctxobj)\r\n    }\r\n    handler = attach(handler, obj, path)\r\n\r\n    // do the work\r\n    var _obj = values(obj)\r\n    if (_obj.skip) return\r\n    var v = _obj.v\r\n    for (var p in v) {\r\n      if (p in obj) continue\r\n      delete v[p]\r\n      trigger('delete', obj, p, null, null)\r\n    }\r\n    for (p in obj) {\r\n      if (sendAdd && !(p in v)) trigger('add', obj, p, obj[p], null)\r\n      propertyObserver(obj, p, handler, path)\r\n    }\r\n\r\n    if (Array.isArray(obj)) arrayObserver(obj, handler)\r\n    if (!obj.__observe__ && path === undefined && ctxobj === undefined) privateprop(obj, '__observe__', objectObserver)\r\n    return obj\r\n  }\r\n\r\n  function arrayObserver (arr, handler) {\r\n    if (arr.__xs__.arrhelpers) return\r\n    arr.__xs__.arrhelpers = true\r\n    var mbind = function (method) {\r\n      var mf = function () {\r\n        var o = this; var _o = o.__xs__\r\n        _o.pause = true; var n = Array.prototype[method].apply(o, arguments); _o.pause = false\r\n        tick(_o.s, o, function () { objectObserver(o) })\r\n        trigger(method, o, arguments, o, null)\r\n        return n\r\n      }\r\n      privateprop(arr, method, mf)\r\n    }\r\n    var m = ['pop', 'push', 'shift', 'unshift', 'splice', 'reverse', 'sort']\r\n    for (var i = 0; i < m.length; i++) mbind(m[i])\r\n  }\r\n\r\n  function propertyObserver (obj, p, handler, path) {\r\n    var _obj = values(obj)\r\n    var v = _obj.v\r\n    if (handler !== obj) handler = attach(handler, obj)\r\n    var pv = obj[p]\r\n    if (!(p in v)) { // already done\r\n      v[p] = pv\r\n      var gf = function () { return v[p] }\r\n      var sf = function (n) {\r\n        var o = v[p]; v[p] = n\r\n        if (typeof (n) === 'object' && n !== null && !n.__xs__) { tick(_obj.s, obj, function () { objectObserver(n, handler, { o: obj, p: p }, path) }, true) }\r\n        trigger('set', obj, p, n, o)\r\n        return n\r\n      }\r\n      Object.defineProperty(obj, p, { get: gf, set: sf, enumerable: true, configurable: true })\r\n    }\r\n    if (typeof (pv) === 'object') objectObserver(pv, handler, { o: obj, p: p }, path)\r\n  }\r\n\r\n  function objectUnobserver (obj, handler) {\r\n    if (!obj.__xs__) return\r\n    var h = obj.__xs__.h\r\n    for (var i = h.length - 1; i >= 0; i--) {\r\n      var ha = h[i]\r\n      if (ha.f === handler) {\r\n        h.splice(i, 1)\r\n      }\r\n    }\r\n    for (var p in obj) if (typeof (p) === 'object' && p !== null) objectUnobserver(p[obj], handler)\r\n  }\r\n\r\n  // ===================================\r\n  // internals\r\n  // ===================================\r\n  var __gidcounter = 0\r\n  function values (obj) {\r\n    if (!obj.__xs__) {\r\n      var _w = {\r\n        s: '@' + __gidcounter++,\r\n        v: {}, // values for the object\r\n        h: [] // handlers // but don't allocate them if not needed\r\n        /* p: {}, // array of property symbols */\r\n      }\r\n      privateprop(obj, '__xs__', _w)\r\n    }\r\n    return obj.__xs__\r\n  }\r\n\r\n  var __ghsymbol = 0\r\n  function attach (handler, obj, path) {\r\n    if (handler === obj || !handler) return obj\r\n    if (typeof (handler) === 'object') handler = values(handler).h\r\n    else handler = [{ rootobj: obj, f: handler, path: path, s: '#' + __ghsymbol++ }]\r\n\r\n    handlerMerge(values(obj).h, handler, path)\r\n    return obj\r\n  }\r\n\r\n  function handlerMerge (a, b, path) { // modifies original array\r\n    if (a === b) return\r\n    var dotpath = path ? undefined : ''\r\n    for (var i = 0; i < b.length; i++) {\r\n      var bs = b[i].s\r\n      if (!a[bs]) {\r\n        if (dotpath === undefined) dotpath = path.reduce(function (p, n) { return p + (p && '.') + n.p }, '')\r\n        a[bs] = true\r\n        a.push({ f: b[i].f, s: b[i].s, path: path, dotpath: dotpath, root: path ? path[0].p : undefined })\r\n      }\r\n    }\r\n  }\r\n\r\n  // ===================================\r\n  // notification\r\n  // ===================================\r\n  function chainfind (obj) { // for events\r\n    if (obj === this.obj) return this.prop\r\n    var uc = this.chain\r\n    for (var i = 0; i < uc.length; i++) if (uc[i].o === obj) return uc[i].p\r\n    return null\r\n  }\r\n\r\n  function trigger (action, obj, p, n, o) {\r\n    var _obj = obj.__xs__\r\n    if (!_obj || !_obj.h || _obj.pause) return\r\n    var h = _obj.h\r\n    for (var i = 0; i < h.length; i++) {\r\n      var ha = h[i]\r\n      var upd = {\r\n        rootobj: ha.rootobj,\r\n        obj: obj,\r\n        action: action,\r\n        prop: p,\r\n        value: n,\r\n        prev: o,\r\n        chain: ha.path,\r\n        root: ha.root || p,\r\n        dotpath: ha.dotpath || '',\r\n        path: ha.dotpath ? ha.dotpath + '.' + p : p,\r\n        find: chainfind\r\n      }\r\n      ha.f.call(obj, upd)\r\n    }\r\n  }\r\n\r\n  // ===================================\r\n  // alias\r\n  // ===================================\r\n  function alias (obsobj, obsp, refobj, refp, listener) {\r\n    if (obsobj === refobj && obsp === refp) return null\r\n    var reflect = function (updates) {\r\n      if (updates.chain && updates.chain.length && updates.chain[0].p === refp) {\r\n        if (updates.chain.length === 1 && obsobj[obsp] !== updates.obj) obsobj[obsp] = updates.obj\r\n        updates.chain[0].p = obsp // alias it\r\n        listener(updates)\r\n        updates.chain[0].p = refp // set it back\r\n      } else if (!updates.chain && updates.prop === refp) {\r\n        if (updates.value !== obsobj[obsp]) { obsobj[obsp] = updates.value }\r\n        updates.prop = updates.path = updates.root = obsp // alias it\r\n        listener(updates)\r\n        updates.prop = updates.path = updates.root = refp\r\n      }\r\n    }\r\n    if (refobj instanceof Node) {\r\n      // if (!(obsp in obsobj))\r\n      obsobj[obsp] = refobj[refp] // \"realize\" it\r\n      if (!obsobj.__observer__) xs.observe(obsobj)\r\n      var objpd = Object.getOwnPropertyDescriptor(obsobj, obsp)\r\n      /*\r\n      switch (refp) {\r\n        case 'value': {\r\n          refobj.addEventListener ('input', function() {\r\n            console.log(refobj[refp])\r\n            obsobj[obsp] = refobj[refp]\r\n          })\r\n        }\r\n      }\r\n*/\r\n      Object.defineProperty(obsobj, obsp, {\r\n        get: function () { return refobj[refp] },\r\n        set: function (v) { refobj[refp] = v; return objpd.set(v) },\r\n        enumerable: true,\r\n        configurable: true })\r\n      return null\r\n    }\r\n    if (!(refp in refobj)) refobj[refp] = refobj[refp] // \"realize\" it\r\n    xs.observe(refobj, reflect)\r\n    obsobj[obsp] = refobj[refp] // copy the initial\r\n    xs.observe(obsobj)\r\n\r\n    // below makes it two way\r\n    var refpd = Object.getOwnPropertyDescriptor(refobj, refp)\r\n    var gf = refpd.get\r\n    var sf = refpd.set\r\n    Object.defineProperty(obsobj, obsp, { get: gf, set: sf, enumerable: true, configurable: true })\r\n\r\n    return reflect\r\n  }\r\n\r\n  // ==============\r\n  // helper stuff\r\n  // ==============\r\n  function isfunction (obj) { return !!(obj && obj.constructor && obj.call && obj.apply) }\r\n  function dotapply (value) { var v = this.obj[this.prop]; isfunction(v) ? v.apply(this.obj, Array.isArray(value) ? value : [value]) : this.obj[this.prop] = value }\r\n  function doterror (value) { console.error('property not found', this, value) }\r\n  function ppath (p) { if (typeof (p) === 'string') p = p.split('.'); return p }\r\n  function dot (obj, path) {\r\n    path = ppath(path)\r\n    var l = path.length\r\n    for (var i = 0; i < l; i++) {\r\n      var k = path[i]; var o = obj; obj = o[k]\r\n      if ((!obj || typeof (obj) !== 'object') && ((i + 1 < l) || (false/*!(k in o)*/))) return { last: { obj: o, prop: k }, apply: doterror }\r\n    }\r\n    return { value: obj, obj: o, prop: k, apply: dotapply }\r\n  }\r\n  dot.array = function (arr, path) { path = ppath(path); var v = []; for (var i = 0; i < arr.length; i++) v.push(dot(arr[i], path)); return v }\r\n  dot.arrayApply = function (arr, path, value) { path = ppath(path); for (var i = 0; i < arr.length; i++) dot(arr[i], path).apply(value) }\r\n  dot.arrayKeysApply = function (arr, keys) { for (var i = 0; i < arr.length; i++) dot.keysApply(arr[i], keys) }\r\n  dot.keysApply = function (obj, keys) { for (var k in keys) dot(obj, k).apply(keys[k]) }\r\n  dot.keysFromArray = function (obj, arrOfKeys) { var o = {}; var aok = arrOfKeys; for (var k in aok) o[aok[k]] = dot(obj, aok[k]); return o }\r\n\r\n  function deepcopy (a, b) {\r\n    if (b === undefined) return a\r\n    if (typeof (b) !== 'object' || b === null) return b\r\n    var bt = Object.prototype.toString.call(b)\r\n    if (bt === '[object RegExp]' || bt === '[object Date]' || b instanceof Node) return b\r\n    if (bt === '[object Array]') {\r\n      if (Object.prototype.toString.call(a) !== '[object Array]') a = [] // should we FORCE to array?\r\n      var c = []\r\n      for (var i in b) { if (!(i in a)) c[i] = b[i] }\r\n      for (i in c) a[i] = c[i]\r\n      return a\r\n    }\r\n    if (typeof (a) !== 'object') a = {}\r\n    for (var k in b) a[k] = deepcopy(a[k], b[k])\r\n    return a\r\n  }\r\n  // function objclone () { var a = arguments; var al = -1; var o = {}; while (++al < a.length) o = objmerge(o, a[al]); return o }\r\n  function objassign () { var a = arguments; var al = 0; var o = a[0]; while (++al < a.length) o = deepcopy(o, a[al]); return o }\r\n  function privateprop (o, k, v, writable) { Object.defineProperty(o, k, { value: v, enumerable: false, configurable: true, writable: !!writable }); return v }\r\n\r\n  var __gobt; var __gob = { '@': {} }\r\n  function resolveTick () {\r\n    __gobt = null; var gob = __gob; __gob = { '@': {} }\r\n    var g = gob['@']; gob['@'] = null\r\n    for (var k in g) { if (g[k]) g[k].f.call(g[k].o, g[k].o) }\r\n    for (k in gob) { if (gob[k]) gob[k].f.call(gob[k].o, gob[k].o) }\r\n  }\r\n  function tick (_s, o, f) {\r\n    var g = (_s[0] === '@') ? __gob['@'] : __gob\r\n    g[_s] = { f: f, o: o }\r\n    if (!__gobt) __gobt = setTimeout(resolveTick, 0)\r\n  }\r\n  /*\r\n  function tick (_s, o, f, delay) {\r\n    // delay = true\r\n    // f.call(o, o); return true;\r\n    var g\r\n    if (_s[0] === '@') g = __gob['@']; else g = __gob\r\n    if (__gobt) {\r\n      if (!(_s in g) && !delay) {\r\n        f.call(o, o)\r\n        g[_s] = null\r\n      } else g[_s] = { f: f, o: o }\r\n      return false\r\n    }\r\n    if (!delay) f.call(o, o)\r\n    else g[_s] = { f: f, o: o }\r\n    __gobt = setTimeout(resolveTick, 0)\r\n    return true\r\n  }\r\n  */\r\n\r\n  // export\r\n  var xs = window.coral = window.coral || {}\r\n  xs.observe = objectObserver\r\n  xs.unobserve = objectUnobserver\r\n  xs.alias = alias\r\n  xs.assign = objassign\r\n  xs.tick = tick\r\n  xs.dot = dot\r\n  xs.privateprop = privateprop\r\n}).call(this)\r\n","// ============================================\r\n// UIFactory\r\n// ============================================\r\nfunction UIFactory (opts) {\r\n  opts = opts || {}\r\n  var xs = window.coral\r\n  var rf_range = document.createRange()\r\n  var rf_counter = 0 // used for 'symbol'\r\n  var rf_listeners = {}\r\n  var rf_key = 0\r\n  const rf_registry = {\r\n    '': {\r\n      update: function () {\r\n        var _s = this.state\r\n        var slots = this.slots || {}\r\n        var slot = slots[_s.dataslot || 'default']\r\n        if (!slot) return 'done'\r\n        if (!_s.datasrc) return 'done'\r\n        var dc = ('datactx' in _s) ? this.dot(_s.datactx).value : this\r\n        var dl = ('datasrc' in _s) ? this.dot(_s.datasrc).value : this\r\n        var gk = _s.genkey\r\n        if (Array.isArray(dl) && dl.length === 0 && dl.keys().length === 0) dl = null\r\n        var gen = (dl && slot) || slots.empty || { text: '<div> </div>' }\r\n        var key = _s.datakey; var uk\r\n        if (!Array.isArray(dl) && !_s.dataobj) dl = [dl]\r\n        if (slots.header) this.html(-1, slots.header.script ? slots.header.script(dc) : slots.header.text)\r\n        // var hm = this.__.hmap || {}; dc.__hmap__ = hm\r\n        /*\r\n        if (this.name=='article-comments')\r\n          this.name=this.name\r\n        if (this.name=='article')\r\n          this.name=this.name\r\n        if (this.rootEl.classList.contains('tag-list'))\r\n          this.name=this.name\r\n        */\r\n        //for (var i = 0; i < dl.length; i++) {\r\n        for (var i in dl) {\r\n          var t = typeof (dl[i])\r\n          if (dl[i]) uk = key === undefined ? dl[i].__key__ : dl[i][key]\r\n          if (gk && uk === undefined && t === 'object') uk = xs.privateprop(dl[i], '__key__', 'k' + rf_key++)\r\n          var row = gen.script ? gen.script(dl[i], i, dc) : gen.text\r\n          this.html(uk || i, row)\r\n        }\r\n        // delete dc.__hmap__\r\n        if (slots.footer) this.html(-2, slots.footer.script ? slots.footer.script(dc) : slots.footer.text)\r\n      }\r\n    }\r\n  }\r\n\r\n  function coralWarn () { console.error(arguments) }\r\n  function coralError () { console.error(arguments); throw Error('CORAL FAULT') }\r\n  function alwaysobj (rf, n) { rf[n] = rf[n] || {}; return rf[n] }\r\n\r\n  // ============================================\r\n  // dom\r\n  // ============================================\r\n  function run (arg) {\r\n    var d = (arg || document)\r\n    var r = []\r\n    var rels = d.querySelectorAll('[coral]')\r\n    for (var i = 0; i < rels.length; i++) {\r\n      if (!rels[i].coral) {\r\n        var rr = UIDOM(rels[i], d.coral)\r\n        publishLF(rr, 'mount')\r\n        if (rr) rr.render_()\r\n        r.push(rr)\r\n      } else rels[i].coral.render_()\r\n    }\r\n    return r\r\n  }\r\n\r\n  function parseScript (attrBag, c) {\r\n    try {\r\n      var type = c.getAttribute('type')\r\n      var args = type.match(/\\(([^)]*)\\)/); args = args ? args[1] : ''\r\n      var ftext = c.innerHTML.trim()\r\n      var props = attrBag.props = attrBag.props || {}\r\n\r\n      if (ftext) {\r\n        switch (type.split('(')[0].trim()) {\r\n          case 'coral-method': alwaysobj(attrBag, 'methods')[c.getAttribute('name') || 'default'] = new Function(args, ftext); break\r\n          // case 'coral-listener': alwaysobj(attrBag, 'listeners')[c.getAttribute('name') || 'default'] = new Function(args, ftext); break\r\n          case 'coral-observer': alwaysobj(attrBag, 'observers')[c.getAttribute('name') || 'default'] = new Function(args, ftext); break\r\n          case 'coral-function': c.coralScript = new Function(args, ftext); break\r\n          case 'coral-template': c.coralScript = templateEngine(args, ftext); break\r\n          default:\r\n            var p = type.split('coral-s-')[1]\r\n            if (p) { try { ftext = JSON.parse(ftext) } catch (err) {} props[p.trim()] = ftext; return true }\r\n            coralWarn('unknown coral slot type', type)\r\n            break\r\n        }\r\n      }\r\n    } catch (err) { coralWarn('coral-slot script parsing ERROR:', ftext || c.type, c, err) }\r\n  }\r\n\r\n  function UIDOM (el, parentCoral) {\r\n    if (!el) return null\r\n    var coralName = el.getAttribute('coral')\r\n    try {\r\n      var attrBag = getAttributes(el)\r\n      var cloneEl = el.cloneNode(true) // deep copy\r\n      if (cloneEl) {\r\n        attrBag = attrBag || {}\r\n        if (cloneEl.children) {\r\n          for (var i = 0; i < cloneEl.children.length; i++) {\r\n            var slots = alwaysobj(attrBag, 'slots')\r\n            var c = cloneEl.children[i]\r\n            var ga = c.getAttribute\r\n            var attr = (ga && ga.call(c, 'coral-slot')) || 'default'\r\n            if (c.nodeName === 'SCRIPT' && c.type.indexOf('coral-') === 0) {\r\n              if (parseScript(attrBag, c)) continue\r\n            }\r\n            var sa = slots[attr] = slots[attr] || []\r\n            sa.push(c)\r\n            sa.text = (sa.text || '') + (ga ? c.outerHTML : c.state) // convenience\r\n            if (!('el' in sa)) sa.el = c // convenience\r\n            if (!('script' in sa) && c.coralScript) sa.script = c.coralScript // convenience\r\n          }\r\n        }\r\n      }\r\n\r\n      return mount(el, coralName, attrBag, parentCoral)\r\n    } catch (err) {\r\n      coralWarn('UI failed to mount: ', coralName, el, err)\r\n    }\r\n    return null\r\n  }\r\n\r\n  function publishLF (coral, lf) { return coral.lifecycle && coral.lifecycle[lf] && coral.lifecycle[lf].call(coral) }\r\n\r\n  function getAttributes (el) {\r\n    var attrBag\r\n    var attrlist = el.attributes\r\n    for (var i = 0; i < attrlist.length; i++) {\r\n      var attr = attrlist[i]\r\n      var n = attr.name + ''\r\n      if (n.indexOf('coral-s') === 0) {\r\n        attrBag = attrBag || { }\r\n        var val = attr.value\r\n        var spl = n[7] // whatever the character is... use two of those to split - 6 is len of 'coral-s'\r\n        var ev = val.split(spl + spl); val = ev[0]; ev = ev[1]\r\n        var p = n.substring(8) // 8 is len of 'coral-sX' (note the 'X')\r\n        var d = determineDataBinding(p, val)\r\n        try { val = JSON.parse(val) } catch (err) {}\r\n        if (!d) alwaysobj(attrBag, 'props')[p] = val; else alwaysobj(attrBag, 'bind')[p] = d\r\n        if (ev) alwaysobj(attrBag, 'events')[p] = ev\r\n      } else if (n.indexOf('coral-on-') === 0) {\r\n        var lis = n.substring(9)\r\n        attrBag = attrBag || { }\r\n        alwaysobj(attrBag, 'listeners')[lis] = attr.value\r\n      }\r\n    }\r\n    return attrBag\r\n  }\r\n\r\n  function determineDataBinding (k, v) {\r\n    if (v[0] !== '~') return false\r\n    var s = v.split('~')\r\n    return { prop: s[1], selector: (s.length < 2) ? '^' : s[2] }\r\n  }\r\n\r\n  function templateGenerator (args, templateString) {\r\n    return new Function(args, 'return `' + templateString + '`;')\r\n  }\r\n\r\n  function templateGeneratorES5 (args, templateString) {\r\n    templateString = templateString.split('\\n').join('\\\\\\n').replace(/\"/g, '\\\\\"') // multiline and escape double quotes and slashes\r\n    return new Function(args, 'var f=function (_, exp) {return eval(exp)}; f.bind(this); return \"' + templateString + '\".replace(/\\\\${(.*?)}/g, f)')\r\n  }\r\n\r\n  function mount (el, name, localData, parentCoral) {\r\n    localData = localData || {}\r\n    if (!rf_registry[name]) coralError('UI NOT registered: ', name)\r\n\r\n    // make UI\r\n    var defaultData = rf_registry[name]\r\n    var coral = new opts.use(name, el, defaultData, localData)\r\n    el.setAttribute('coral-stage', 'mounted')\r\n\r\n    // register listeners\r\n    if (coral.listeners) {\r\n      var al = []\r\n      var rl = coral.listeners\r\n      for (var k in rl) {\r\n        al.push(k)\r\n        var ev = k.split('.')\r\n        var e = ev[0]\r\n        if (!rf_listeners[e]) { // we only need to add it once\r\n          var eli = listenerFactory(e)\r\n          if (ev[1] === 'local') {\r\n            al[e] = rl[e + '.local']\r\n            el.addEventListener(e, eli, false)\r\n          } else {\r\n            rf_listeners[e] = eli\r\n            document.addEventListener(e, eli, false)\r\n          }\r\n        }\r\n        rl[e] = rl[k]\r\n        if (rl[ev[1]] === 'stop') rl[e].coralStop = true\r\n      }\r\n      coral.listeners = al // keep the tag so we know we had listeners - but they are source from the registry\r\n    }\r\n\r\n    return coral\r\n  }\r\n\r\n  function listenerFactory (type) {\r\n    return function (event) {\r\n      var el = (event.detail && event.detail.coralEmitRootEl) || event.target; var rr\r\n      var evattr = 'coral-on-' + type\r\n      var handlers = []\r\n      while (el) {\r\n        if (el.getAttribute) {\r\n          var evvalue = el.getAttribute(evattr)\r\n          if (!evvalue) {\r\n            evvalue = el.getAttribute(evattr + '.stop')\r\n            if (evvalue) evvalue.stop = true\r\n          }\r\n          if (evvalue) handlers.push(evvalue.trim())\r\n          var coral = el.coral\r\n          if (!event.coral) event.coral = coral\r\n          if (coral && handlers.length) { // parse the handler for the event\r\n            for (var i = 0; i < handlers.length; i++) {\r\n              var ev = handlers[i]\r\n              var fn = ev\r\n              /*\r\n              var func = function (event) { eval(fn) }\r\n              try { func.call(coral, event) } catch (err) { coralWarn('coral-event-Error') }\r\n              /* // old syntax - you do do prop(value)\r\n              */\r\n              var parseArgs = function (str) {\r\n                var argsets = str.match(/\\(([^)]*)\\)/)\r\n                return (argsets && argsets[1]) || ''\r\n              }\r\n              var args = parseArgs(fn)\r\n              if (args) {\r\n                args = args.split(',')\r\n                fn = fn.split('(')[0]\r\n                var idx = args.indexOf('$event') // allow substition\r\n                if (idx >= 0) args[idx] = event\r\n              }\r\n              var f = coral.dot(fn); var rval\r\n              if (f.obj !== undefined) {\r\n                if (isfunction(f.value)) rval = f.value.apply(f.obj, args || [event])\r\n                else coral.dot(fn, args[0])\r\n                if (rval === 'stop' || ev.stop) return\r\n              }\r\n            }\r\n          }\r\n          var rn = coral && coral.name\r\n          var eh = ((coral || {}).listeners || {})[type] || ((rf_registry[rn] || {}).listeners || {})[type]\r\n          if (eh) {\r\n            if (eh.call(coral, event) === 'stop' || eh.coralStop) { return } // hmm - should we support bubbling?\r\n          }\r\n        }\r\n        el = el.parentNode\r\n      }\r\n    }\r\n  }\r\n\r\n  function register (inname, coralData, superCoral) {\r\n    var name = (inname[0] === '*') ? inname.substring(1) : inname\r\n    superCoral = superCoral || ''\r\n    coralData.state = arrtoobj(coralData.state, undefined)\r\n    if (rf_registry[name]) { if (inname === name) coralError('UI already registered: ' + name); return }\r\n    if (!rf_registry[superCoral]) coralError('Super Coral NOT registered: ' + superCoral)\r\n    rf_registry[name] = xs.assign({}, rf_registry[superCoral], coralData)\r\n    rf_registry[name].name = name\r\n    rf_registry[name].super = superCoral\r\n    return true\r\n  }\r\n\r\n  // ============================================\r\n  // UI - helpers\r\n  // ============================================\r\n  function resolveEl (el, ctx) { if (typeof (el) !== 'string') return el; return resolveEl(ctx || document).querySelector(el) }\r\n  function isfunction (obj) { return !!(obj && obj.constructor && obj.call && obj.apply) }\r\n  function arrtoobj (arr, v) { if (!Array.isArray(arr)) return arr; var o = {}; for (var i = 0; i < arr.length; i++) o[arr[i]] = (arguments.length <= 1 ? true : v); return o }\r\n  function cif (o, props, o1, o2) {\r\n    for (var i = 0; i < props.length; i++) {\r\n      var p = props[i]\r\n      var np = (p in o2) ? o2[p] : o1[p]\r\n      if (np === undefined) continue\r\n      o[p] = xs.assign({}, o1[p], o2[p])\r\n    }\r\n  }\r\n\r\n  // ============================================\r\n  // UI - constructor\r\n  // ============================================\r\n  function UI (name, rootEl, setup, localSetup) {\r\n    setup = setup || {}\r\n    localSetup = localSetup || {}\r\n    var rf = this\r\n    var _ = this.__ = {}\r\n    cif(_, ['update', 'bind'], setup, localSetup)\r\n    cif(this, ['methods', 'observers', 'listeners', 'data', 'mutate', 'lifecycle'], setup, localSetup) // intentional shallow copies\r\n    if ('shared' in setup) this.shared = setup.shared\r\n    if (setup.events || localSetup.events) _.events = xs.assign({}, arrtoobj(setup.events), localSetup.events)\r\n    if (setup.decorators || localSetup.decorators) _.decorators = xs.assign({}, arrtoobj(setup.decorators), arrtoobj(localSetup.decorators))\r\n    if (setup.slots || localSetup.slots) xs.assign(alwaysobj(this, 'slots'), setup.slots, localSetup.slots)\r\n    if ('super' in setup) this.super = rf_registry[setup.super]\r\n\r\n    var sh = this.methods; if (sh) for (var k in sh) sh[k] = isfunction(sh[k]) ? sh[k].bind(rf) : sh[k] // bind to coral\r\n\r\n    this.name = name\r\n    this.rootEl = rootEl\r\n    rootEl.coral = this\r\n    _.obsf = UI.prototype.react.bind(rf)\r\n    var _s = this.state = xs.observe({}, _.obsf) // public as well -- our main \"react\" core\r\n    xs.assign(_s, _.decorators, setup.state, localSetup.props) // make our state\r\n    // for (k in this.observers) if (!(k in _s)) _s[k] = undefined\r\n    for (k in _.bind) doDataBind(this, 'state.' + k, _.bind[k].selector, _.bind[k].prop)\r\n    xs.observe(_s) // trigger observers\r\n    this.sym = '$' + rf_counter++\r\n    return this\r\n  }\r\n  UI.prototype.unmount = function () {\r\n    publishLF(this, 'umnount')\r\n    var _ = this.__ || {}\r\n    xs.unobserve(this.state, _.obsf)\r\n    if (_.bind) {\r\n      for (var k in _.bind) {\r\n        var b = _.bind[k]\r\n        if (b.obsf) xs.unobserve(b.sp.obj, b.obsf)\r\n      }\r\n    }\r\n  }\r\n\r\n  // ============================================\r\n  // react\r\n  // ============================================\r\n  function regexprep (o) { var s = ''; for (var k in o) { s += ':xs:' + k + '\\n' }; return s }\r\n  UI.prototype.react = function (updates) { // core event engine\r\n    updates.coral = this\r\n    var _ = this.__\r\n    var status\r\n    var p = updates.root// = updates.path.split('.')[0]//updates.path ? updates.path.split('.')[0] : updates.prop\r\n    var _obs = this.observers\r\n    var _ev = _.events\r\n    var rx = _.proprx = _.proprx || ((_obs ? regexprep(_obs) : '') + (_ev ? regexprep(_ev) : ''))\r\n    if (rx) {\r\n      var str = '(:xs:((' + updates.path/* .replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&') */.replace(/\\./g, '\\\\.)|(\\\\*\\\\.))*((') + ')|(\\\\*)))\\n'\r\n      var regx = new RegExp(str, 'g')\r\n      var m = rx.match(regx)\r\n      if (m) {\r\n        var mp = m[0]\r\n        for (var i = 1; i < m.length; i++) if (m[i].length > mp.length) mp = m[i]\r\n        p = mp.substring(4, mp.length - 1) // skipe the ':xs:\r\n      }\r\n    }\r\n    var op = _obs && _obs[p]\r\n    if (op) { // observers\r\n      if (isfunction(op)) status = op.call(this, updates)\r\n      else {\r\n        if (!updates.path && (updates.action === 'set' || updates.action === 'add')) {\r\n          var o = this.dot(op)\r\n          if (isfunction(o.value)) o.value.call(this)\r\n          else o.obj[o.prop] = updates.value\r\n        }\r\n      }\r\n    }\r\n    if (_ev && _ev[p]) { // events\r\n      var e = _.name + '.' + (_ev[p] === true ? p : _ev[p])\r\n      emit(this.rootEl, e, updates)\r\n    }\r\n\r\n    var mstatus\r\n    if (updates.value === updates.prev) return\r\n    if (this.mutate) mstatus = this.mutate.call(this, updates)\r\n    var _d = _.decorators\r\n    if (!this.sym) return // we are still constructing\r\n    if (status !== 'done' && mstatus !== 'done' && (!_d || (!_d[p] && !_d[mp]))) this.rerender() // re-render\r\n  }\r\n  UI.prototype.observe = function (k, cb) { var _o = alwaysobj(this, 'observers'); _o[k] = cb; this.__.obsrx = null }\r\n  UI.prototype.decorate = function (k, set) { var _d = alwaysobj(this, 'decorators'); _d[k] = (set !== false && set !== 0) }\r\n  UI.prototype.events = function (k, set) { var _e = alwaysobj(this.__, 'events'); _e[k] = (set !== false && set !== 0 && set); this.__.evrx = null }\r\n  UI.prototype.watch = function (k, o) { this.state[k] = o; this.state.__observe__() }\r\n  UI.prototype.bind = function (k, sel, copyk, ctx) { doDataBind(this, k, sel, copyk, ctx, true) }\r\n  // UI.prototype.bindForce = function (k, sel, copyk, ctx) { doDataBind(this, k, sel, copyk, ctx, true) }\r\n  UI.prototype.emit = function (ev, detail) { emit(this.rootEl, ev, detail) }\r\n  function loadData (datapath, url, opts) { // this must be UI\r\n    var rf = this\r\n    var xhrc = alwaysobj(this.__, 'xhrc')\r\n    if (xhrc[datapath]) xhrc[datapath].abort()\r\n    opts = opts || {}\r\n    var xhr = opts.xhr || new XMLHttpRequest()\r\n    /* if (!opts.xhr || opts.responseType) // either it's new or it's passed in\r\n    { xhr.responseType = opts.responseType || 'json' } */\r\n    xhr.onerror = function (err) { console.log('CORAL HTTP LOAD FAIL', err, url); emit(rf.rootEl, 'coralLoadDataFail', { url: url, xhr: xhr, err: err }) }\r\n    xhr.onload = function (ev) {\r\n      if (xhr.readyState !== 4) return\r\n      delete xhrc[datapath]\r\n      if (this.status >= 200 && this.status < 300) {\r\n        var res = this.response\r\n        try { res = JSON.parse(res) } catch (err) {}\r\n        if (opts.sanitize) res = sanitize(res)\r\n        rf.dot(datapath, res)\r\n      } else if (this.status) { xhr.onerror(ev) }\r\n    }\r\n    xhrc[datapath] = xhr\r\n    xhr.open(opts.method || 'GET', url, true)\r\n    var b = opts.body\r\n    for (var h in (opts.headers || {})) xhr.setRequestHeader(h, opts.headers[h])\r\n    xhr.send(b ? (typeof (b) === 'string' ? '' : JSON.stringify(b)) : null)\r\n    return xhr\r\n  }\r\n  function loadHTML (datapath, url) { // this must be UI\r\n    var rf = this\r\n    var htmc = alwaysobj(this.__, 'htmc')\r\n    if (document.readyState !== 'loading') {\r\n      var script = document.createElement('script')\r\n      script.src = url\r\n      document.getElementsByTagName('head')[0].appendChild(script)\r\n    } else {\r\n      document.write('<script src=\"' + url + '\"></script')\r\n      script = document.getElementsByTagName('script')\r\n      script = script[script.length - 1]\r\n    }\r\n    var curc = htmc[datapath] = (htmc[datapath] || 0) + 1\r\n    script.onerror = function (err) { console.log('CORAL SCRIPT LOAD', err); script.parentNode.removeChild(script); emit(rf.rootEl, 'coralLoadHTMLFail', { url: url, script: script, err: err }) }\r\n    script.coralCB = function (data) { if (htmc[datapath] === curc) rf.dot(datapath, data) }\r\n    if (!document.currentScript) window.rf_script = script\r\n    return script\r\n  }\r\n\r\n  function realizeSource (refobj, copyprop) {\r\n    var pp = copyprop.split('.')\r\n    var sp = xs.dot(refobj, pp)\r\n    if (sp.obj) return sp\r\n    var fp = pp; var oc = refobj\r\n    for (var i = 0; i < fp.length; i++) {\r\n      var nc = oc[fp[i]]; if (nc === undefined || nc === null || typeof (nc) !== 'object') oc[fp[i]] = (i == fp.length - 1 ? undefined : {}); oc = oc[fp[i]]\r\n    }\r\n    return xs.dot(refobj, pp)\r\n  }\r\n\r\n  function jsonp (str, rf, proppath) {\r\n    var ind = str.indexOf('{JSONP}')\r\n    if (ind < 0) return str\r\n    var fname = 'jsonp_rf_' + rf_counter++\r\n    window[fname] = function (data) {\r\n      rf.dot(proppath, data)\r\n      delete window[fname]\r\n    }\r\n    return str.replace('{JSONP}', fname)\r\n  }\r\n  function looseNode (el) { var r = el && el.getRootNode(); return r && r !== document && r.nodeName !== '#document-fragment' }\r\n  /* function findParentCoral (rf, count) {\r\n    var el = rf && rf.rootEl\r\n    while (rf && el) {\r\n      if (count-- == 0) return rf\r\n      do el = el.parentNode; while (el && !el.coral)\r\n      rf = el.coral\r\n    }\r\n    return null\r\n  } */\r\n  function doDataBind (rf, proppath, sel, copyprop, selctx, force) {\r\n    var refobj, sp\r\n    sel = sel || '^'\r\n    var _ = rf.__\r\n    var _b = alwaysobj(_, 'bind')\r\n    var _bp = alwaysobj(_b, proppath)\r\n    copyprop = copyprop || proppath\r\n    if (!force && _bp.proppath === proppath && _bp.selector === sel && _bp.prop === copyprop && !_bp.copy) return\r\n    switch (sel[0]) {\r\n      case '^':\r\n        refobj = rf.rootEl\r\n        var which = sel.substring(1) | 0; while (which--) refObj = refObj.parentElement\r\n        refobj = refobj && refobj.coral\r\n        if (!refobj) coralError('unable to find parent to state bind', rf, proppath)\r\n        sp = realizeSource(refobj, copyprop)\r\n        break\r\n      case '#':\r\n      case '.':\r\n      case '[':\r\n        var el = (selctx || document).querySelector(sel)\r\n        refobj = el && el.coral\r\n        if (!refobj) coralError('unable to locate coral for bind', selctx, copyprop)\r\n        sp = realizeSource(refobj, copyprop)\r\n        break\r\n      default:\r\n        var els = sel.split('$')\r\n        _b[proppath] = { proppath: proppath, selector: sel, prop: copyprop }\r\n        switch (els[1]) {\r\n          case 'data':\r\n          case 'html':\r\n          case 'json-raw': loadData.call(rf, proppath, els[2], selctx); break\r\n          case 'json': loadData.call(rf, proppath, els[2], xs.assign({ sanitize: true }, selctx || {})); break\r\n          case 'jsonp': els[2] = jsonp(els[2], rf, proppath) // fall through\r\n          case 'js': loadHTML.call(rf, proppath, els[2]); break\r\n          default:\r\n            coralError('unknown data bind: ' + proppath + ': ' + sel)\r\n        }\r\n        sp = realizeSource(rf, copyprop)\r\n        if (copyprop === proppath) return\r\n        break\r\n        // fall through\r\n    }\r\n\r\n    // /var dp = dot(rf, proppath)\r\n    var dp = realizeSource(rf, proppath)\r\n    if (!dp.obj) coralError('state bind not found: ' + proppath)\r\n    if (_bp.copy) { dp.obj[dp.prop] = sp.obj[sp.prop]; return }\r\n\r\n    var f = function (u) { if (looseNode(rf.rootEl)) { rf.unmount(); return } rf.react(u) }\r\n    if (sp.obj !== refobj.state) {\r\n      xs.observe(refobj.state, function (updates) {\r\n        // to handldle the nested case\r\n        if (_b[proppath].copy || looseNode(rf.rootEl)) return\r\n        if (updates.action == 'set' && copyprop.indexOf(updates.path) === 6) { // 6 = \"state.\"\r\n          _b[proppath].copy = true\r\n          doDataBind(rf, proppath, sel, copyprop, selctx)\r\n          _b[proppath].copy = false\r\n        }\r\n      })\r\n    }\r\n    var obsf = xs.alias(dp.obj, dp.prop, sp.obj, sp.prop, f)\r\n    _b[proppath] = { proppath: proppath, selector: sel, prop: copyprop, sp: sp, unobs: obsf }\r\n  }\r\n\r\n  // ============================================\r\n  // render\r\n  // ============================================\r\n  UI.prototype.render_ = render\r\n  UI.prototype.render = function () { xs.tick(this.sym + '_rr', this, render) }\r\n  function render () {\r\n    if (this !== this.rootEl.coral) return // shit.\r\n    publishLF(this, 'beforeRender')\r\n    // var t = new Date()\r\n    var rel = this.rootEl\r\n    if (looseNode(rel)) { this.unmount(); return }\r\n    var update = this.__.update\r\n    if (update) {\r\n      var fc = this.__.fcounter\r\n      if (fc) this.htmlBegin()\r\n      fc = this.__.fcounter //  reset it\r\n      var res = update.call(this, this.slots) || ''\r\n      if (this.__.harr && res !== 'done') this.htmlEnd()\r\n      else {\r\n        if (typeof (res) === 'string') {\r\n          if (res !== 'done') rel.innerHTML = res // a way to \"out\"\r\n        } else {\r\n          rel.innerHTML = ''\r\n          if (Array.isArray(res)) res.forEach(function (e) { rel.appendChild(e) })\r\n          else rel.appendChild(res)\r\n        }\r\n        run(rel) // hydrate nested components\r\n      }\r\n      // if (rel.parentNode.classList.contains('container')) { console.log('render', new Date() - t) }\r\n    }\r\n    this.__.renderflag = 0\r\n    publishLF(this, 'afterRender')\r\n  }\r\n  UI.prototype.rerender = function () {\r\n    this.__.renderflag = (this.__.renderflag || 0) + 1\r\n    xs.tick(this.sym + '_rr', this, rerender, true)\r\n  }\r\n  function rerender () {\r\n    if (this.__.renderflag === 0) return\r\n    var sel = saveSelection(this.rootEl)\r\n    render.call(this)\r\n    sel()\r\n    this.__.renderflag = 0\r\n  }\r\n  function getAttachPoint (el) {\r\n    switch (el.nodeName) {\r\n      case 'TABLE': return (el.childNodes && el.childNodes[0]) || el\r\n      default: return el\r\n    }\r\n  }\r\n  function hash (str) {\r\n    // if (typeof (str) === 'object') str = JSON.stringify(str)\r\n    if (!str) { return 0 }\r\n    var hash = 0; var len = str.length\r\n    for (var i = 0; i < len; i++) {\r\n      hash = hash * 31 + str.charCodeAt(i)\r\n      hash = hash & hash\r\n    }\r\n    return hash\r\n  }\r\n  UI.prototype.htmlBegin = function (forceClean) {\r\n  if (!this.__.harr || forceClean || this.__.hroot !== this.rootEl) {\r\n      this.__.hmap = {}\r\n      this.__.hgeneration = -1\r\n    }\r\n    this.__.hroot = this.rootEl\r\n    this.__.harr = []\r\n    this.__.harr.html = ''\r\n    this.__.harr.htmlIdx = 0\r\n    this.__.harr.wmap = new WeakMap()\r\n    this.__.hgeneration++\r\n    this.__.fcounter = 0\r\n  }\r\n  /*\r\n  function replaceNode (c, nch) {\r\n    var p = c.previousSibling\r\n    var pn = p || c.parentNode\r\n    if (!c.getAttribute && 0) { c.nodeValue = nch } else { c.outerHTML = nch }\r\n    return p ? p.nextSibling : pn.childNodes[0]\r\n  }\r\n*/\r\n  const rf_tagvalue = {\r\n    'INPUT': true,\r\n    'TEXTAREA': true\r\n  }\r\n  function copyAttributes (c, n) {\r\n    // try {\r\n    var a = {}; var at\r\n    var na = n.attributes; var nal = na.length\r\n    if (rf_tagvalue[c.nodeName] && c.value !== n.value) { \r\n      c.value = n.value \r\n    } // for textarea and input\r\n    for (var i = 0; i < nal; i++) {\r\n      at = na[i]; a[at.name] = true\r\n      if (c.getAttribute(at.name) !== at.value) {\r\n        c.setAttribute(at.name, at.value)\r\n      }\r\n    }\r\n    var ca = c.attributes; var cal = ca.length\r\n    if (cal === nal) return true\r\n    for (i = cal - 1; i >= 0; i--) {\r\n      at = ca[i]; if (a[at.name]) continue\r\n      c.removeAttribute(at.name)\r\n    }\r\n    return true\r\n    // } catch (err) { return false }\r\n  }\r\n  function mergeNode (c, n) {\r\n    if (!c) return n\r\n    if (!n) { return n }\r\n    if (n.coral) {\r\n      var oc = c.coral\r\n      c.coral = n.coral\r\n      c.coral.rootEl = c\r\n      /* if (oc) {\r\n        xs.assign (c.coral.state, oc.state)\r\n        c.coral.data = oc.data\r\n      } */\r\n    } else c.coral = null\r\n    if (c.nodeType === 3 && n.nodeType === 3 && c.nodeValue !== n.nodeValue) {\r\n      c.nodeValue = n.nodeValue\r\n      return c\r\n    }\r\n    if ((c.nodeName !== n.nodeName) || (!copyAttributes(c, n))) {\r\n      c.parentNode.replaceChild(n, c)\r\n      return n\r\n    }\r\n    var cc = c.childNodes\r\n    var nc = n.childNodes\r\n    if (cc.length || nc.length) {\r\n      var i\r\n      var il = i = Math.min(cc.length, nc.length)\r\n      while (il < cc.length) c.removeChild(cc[i])\r\n      while (il < nc.length) c.appendChild(nc[i])\r\n      while (--i >= 0) {\r\n        var ccn = cc[i]\r\n        var ncn = nc[i]\r\n        if (ccn.nodeType === 3 && ncn.nodeType === 3) {\r\n          if (ccn.nodeValue !== ncn.nodeValue) { \r\n            ccn.nodeValue = ncn.nodeValue \r\n          }\r\n          continue\r\n        }\r\n        if (ccn.isEqualNode(ncn)) continue\r\n        if (ccn.nodeName !== ncn.nodeName || !mergeNode(ccn, ncn)) {\r\n          c.replaceChild(ncn, ccn)\r\n        }\r\n      }\r\n    }\r\n    return c\r\n  }\r\n\r\n  UI.prototype.htmlUpdate = function (idx, id, htmlGen) {\r\n    var _ = this.__\r\n    var hm = _.hmap\r\n    if (!hm) return\r\n    var hsh = hash(htmlGen)\r\n    id = (id === undefined || id === null) ? hsh : id\r\n    if (!(id in hm)) coralError('updating non-existent element')\r\n    if (hm[id].hsh === hsh && idx === hm[id].idx) return\r\n    var root = getAttachPoint(this.rootEl)\r\n    var c = hm[id].el\r\n    if (!c.getAttribute) { if (c.nodeValue !== htmlGen) c.nodeValue = htmlGen; return } // cheat\r\n    hm[id].el = mergeNode(root.childNodes[idx], hydrate(root, htmlGen).firstChild)\r\n    hm[id].hsh = hsh\r\n    hm[id].idx = idx\r\n  }\r\n\r\n  UI.prototype.htmlEnd = function () {\r\n    var _ = this.__\r\n    var genid = _.hgeneration\r\n    var fl = this.__.fcounter\r\n    var prev = null\r\n    if (fl === 0) {\r\n      this.htmlBegin(true) // reset\r\n      this.rootEl.innerHTML = ''\r\n      return\r\n    }\r\n    if (genid === 0) this.rootEl.innerHTML = '' // do this first\r\n    var ha = _.harr\r\n    var hm = _.hmap\r\n    var hta = ''\r\n    if (!ha) return\r\n    for (var k in hm) { // delete untouched\r\n      var hc = hm[k]\r\n      if (hc.generation === genid) continue\r\n      if (hc.el && hc.el.parentNode) hc.el.parentNode.removeChild(hc.el)\r\n      delete hm[k]\r\n    }\r\n\r\n    var root = getAttachPoint(this.rootEl)\r\n    var div = document.createElement(root.nodeName)\r\n\r\n    if (ha.html) {\r\n      // root.innerHTML = ha.html; run(root); return\r\n      div = hydrate(root, ha.html)\r\n      run(div) // hydrate nested components\r\n      ha.html = ''\r\n    }\r\n\r\n    var cnt = 0\r\n    for (var i = 0; i < fl; i++) {\r\n      hc = ha[i]\r\n      var c = hc.el\r\n      var h = hc.h\r\n      // if (typeof (h) === 'object') h = h.html()\r\n      if (typeof (h) === 'number') {\r\n        var n = div.childNodes[hc.h - cnt]\r\n        n = mergeNode(c, n)\r\n        if (n !== c) {\r\n          hc.el = c = n\r\n          cnt++\r\n        }\r\n      } else if (h) {\r\n        if (/* 0 && */i >= root.childNodes.length) hta += h\r\n        else hc.el = c = hydrate(root, h).firstChild\r\n      }\r\n      hc.idx = i\r\n      hc.h = ''\r\n      if (c) {\r\n        hc.el = c\r\n        ha.wmap.set(c, i)\r\n        if (c.parentNode !== root || c.previousSibling !== prev) { // clean up placement\r\n          if (prev) {\r\n            root.insertBefore(c, prev.nextSibling)\r\n          } else if (!root.childNodes || root.childNodes[0] !== c) {\r\n            root.insertBefore(c, root.childNodes && root.childNodes[0])\r\n          }\r\n        }\r\n        prev = c\r\n      }\r\n    }\r\n    ha.length = fl\r\n\r\n    var rcl = root.childNodes.length\r\n    if (hta) {\r\n      root.insertAdjacentHTML('beforeend', hta) // end insert\r\n      run(root) // hydrate nested components\r\n    }\r\n    root = getAttachPoint(this.rootEl)\r\n    if (root && ha.length !== root.childNodes.length) {\r\n      console.error('inconsistent count - must be 1 html() entity for hmtl()')\r\n    }\r\n    for (i = rcl; i < ha.length; i++) { ha[i].el = root.childNodes[i]; ha.wmap.set(ha[i].el, i) }\r\n    return 'done'\r\n  }\r\n\r\n  UI.prototype.htmlFromIdx = function (idx) {\r\n    var root = getAttachPoint(this.rootEl)\r\n    return root.childNodes[idx]\r\n  }\r\n  UI.prototype.htmlChild = function (el) {\r\n    while (el.parentNode !== this.rootEl) el = el.parentNode\r\n    return el\r\n  }\r\n  UI.prototype.htmlToIdx = function (el) {\r\n    while (el.parentNode !== this.rootEl) el = el.parentNode\r\n    var v = this.__.harr.wmap.get(el)\r\n    return v === undefined ? -1 : v\r\n  }\r\n  function hydrate (type, h) {\r\n    rf_range.selectNode(type)\r\n    var el = rf_range.createContextualFragment(h)\r\n    return type.nodeName === 'TBODY' ? el.childNodes[0] : el\r\n  }\r\n  UI.prototype.html = function (id, htmlGen, force) {\r\n    if (!this.__.harr) this.htmlBegin()\r\n    var _ = this.__\r\n    var ha = _.harr\r\n    var hm = _.hmap\r\n    var idx = _.fcounter++\r\n    var genid = _.hgeneration\r\n    var hsh = hash(htmlGen); var hc\r\n    id = (id === undefined || id === null) ? hsh : id\r\n    if (hm[id] && hm[id].generation === genid) {\r\n      id = '__' + idx + '__'\r\n    }\r\n    if (hm[id]) {\r\n      hc = hm[id]\r\n      if (hc.generation === genid) { coralError('duplicate html() id') }\r\n      hc.generation = genid\r\n      ha[idx] = hc // set the position\r\n      if (hc.el && !hc.el.parentNode) hc.el = null\r\n      if (hc.el && hc.hsh === hsh && !force && !hc.el.__coral_dirty__) return\r\n      if (hc.el && hc.el.__coral_dirty__) delete hc.el.__coral_dirty__\r\n      hc.h = ha.htmlIdx++\r\n      ha.html += htmlGen\r\n      hc.hsh = hsh\r\n    } else {\r\n      hc = { h: htmlGen, hsh: hsh, idx: idx, id: id, generation: genid, el: null }\r\n      ha.splice(idx, 0, hc)\r\n      hm[id] = hc\r\n    }\r\n  }\r\n\r\n  UI.prototype.dot = function (path, value) {\r\n    var v = xs.dot(this, path)\r\n    if (arguments.length > 1) {\r\n      if (!v.obj) throw Error('chain path missing')\r\n      v.obj[v.prop] = value\r\n    }\r\n    return v\r\n  }\r\n  UI.prototype.styleBag = function (e, s) {\r\n    var rel = e instanceof Node ? e : this.rootEl\r\n    if (rel === this.rootEl) s = e\r\n    var hsh = hash(JSON.stringify(s))\r\n    if (rel.__xs__style === hsh) return\r\n    for (var k in s) rel.style[k] = s[k]\r\n    rel.__xs__style = hsh\r\n  }\r\n\r\n  // ============================================\r\n  // utilities\r\n  // ============================================\r\n  function getChildIndex (node) { return [].indexOf.call(node.parentNode.childNodes, node) }\r\n  function saveSelection (rootEl) { // save the text selection (call the ret() as func to retore)\r\n    var ael = document.activeElement\r\n    if (ael) {\r\n      var startPosition = ael.selectionStart\r\n      var endPosition = ael.selectionEnd\r\n      var aeindex = []\r\n      while (ael && ael !== rootEl && ael.parentNode) {\r\n        aeindex.push(getChildIndex(ael))\r\n        ael = ael.parentNode\r\n      }\r\n      if (!ael || !ael.parentNode) ael = null\r\n    }\r\n    return function () {\r\n      if (ael) {\r\n        ael = rootEl\r\n        while (ael && aeindex.length) {\r\n          var ind = aeindex.pop()\r\n          ael = ael.childNodes[ind]\r\n        }\r\n        if (ael) {\r\n          if (ael.focus) ael.focus()\r\n          try {\r\n            ael.selectionStart = startPosition\r\n            ael.selectionEnd = endPosition\r\n          } catch (err) {}\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function createCSS (name, rules) {\r\n    var style = document.getElementById('__coral_styles__')\r\n    if (!style) {\r\n      style = document.createElement('style')\r\n      style.id = '__coral_styles__'; style.type = 'text/css'\r\n      document.getElementsByTagName('head')[0].appendChild(style)\r\n    }\r\n    var sheet = style.sheet\r\n    sheet.insertRule(name + '{' + rules + '}', 0)\r\n  }\r\n\r\n  // createCSS('coral-helper', 'display:none;')\r\n\r\n  var rf_s\r\n  function sanitize (str) {\r\n    if (typeof (str) === 'object') {\r\n      for (var k in str) {\r\n        switch (typeof (str[k])) {\r\n          case 'string':\r\n          case 'object':\r\n            str[k] = str[k] ? sanitize(str[k]) : str[k] // to handle null etc\r\n          default: break\r\n        }\r\n      }\r\n      return str\r\n    }\r\n    rf_s = rf_s || document.createElement('div')\r\n    rf_s.textContent = str\r\n    return rf_s.innerHTML\r\n  }\r\n  function emit (el, ev, detail) {\r\n    el = resolveEl(el); detail = detail || {}\r\n    if (el) { detail.coralEmitRootEl = el }\r\n    document.dispatchEvent(new CustomEvent(ev, { detail: detail }))\r\n  }\r\n\r\n  function ready (cb) {\r\n    if (document.readyState === 'complete' ||\r\n      (document.readyState !== 'loading' && !document.documentElement.doScroll)) {\r\n      cb()\r\n    } else {\r\n      document.addEventListener('DOMContentLoaded', cb)\r\n    }\r\n  }\r\n  if (opts.autorun) {\r\n    ready(function () {\r\n      run()\r\n    })\r\n  }\r\n\r\n  opts.use = opts.use || UI\r\n  var templateEngine = document.currentScript ? templateGenerator : templateGeneratorES5 // proxy for literal support\r\n\r\n  // ============================================\r\n  // exports\r\n  // ============================================\r\n  return {\r\n    register: register,\r\n    mount: mount,\r\n    run: run,\r\n    template: templateEngine,\r\n    hydrate: hydrate,\r\n    ready: ready,\r\n    emit: emit,\r\n    sanitize: sanitize,\r\n    cssRule: createCSS,\r\n    styleBag: UI.prototype.styleBag,\r\n    registry: function (name) { return name ? rf_registry[name] : rf_registry },\r\n    find: function (a, ctx) { a = this.findAll(a, ctx); return a ? a[0] : null },\r\n    findAll: function (a, ctx) { a = [].slice.call((ctx || document).querySelectorAll(a)); var j = 0; if (a) for (var i = 0; i < a.length; i++) { a[j] = a[i].coral; j += a[j] ? 1 : 0 } return j ? (a.length = j, a) : null }\r\n  }\r\n}\r\n\r\nwindow.coral.ui = UIFactory({ autorun: true })\r\n\r\n// ============================================\r\n// clientSideInclude ()\r\n// ============================================\r\n;(function () {\r\n  var coral = window.coral = window.coral || {}; coral.ui = coral.ui || {}\r\n  coral.ui.loadScript = function (url, cb, asCSS) {\r\n    if (document.querySelector('script[url=\"' + (url) + '\"]')) { if (cb) cb(true); return }\r\n    if (asCSS) {\r\n      var s = document.createElement('link')\r\n      s.setAttribute('rel', 'stylesheet')\r\n      s.setAttribute('type', 'text/css')\r\n      s.setAttribute('href', url)\r\n    } else {\r\n      var s = document.createElement('script')\r\n      s.src = url\r\n      s.setAttribute('url', url)\r\n    }\r\n    s.onload = function () { cb(false) }\r\n    document.getElementsByTagName('head')[0].appendChild(s)\r\n    // setTimeout (()=>document.getElementsByTagName('head')[0].appendChild(s), 200000)\r\n  }\r\n  coral.ui.clientSideInclude = function (data) {\r\n    function isfunction (obj) { return !!(obj && obj.constructor && obj.call && obj.apply) }\r\n    if (isfunction(data)) data = data.toString().split('\\n').slice(1, -1).join('\\n')\r\n    var dsc = document.currentScript || window.rf_script\r\n    if (!dsc) { // IE11 support\r\n      dsc = document.getElementsByTagName('script')\r\n      dsc = dsc[dsc.length - 1]\r\n    }\r\n    if (window.rf_script) window.rf_script = null\r\n    var cb = dsc.coralCB\r\n    if (cb === undefined) dsc.outerHTML = data\r\n    else cb(data)\r\n    if (dsc.parentNode) dsc.parentNode.removeChild(dsc)\r\n  }\r\n})()\r\n"],"sourceRoot":""}